---
TOCTitle: 973882
Title: Comunicado de Segurança da Microsoft 973882
ms:assetid: 973882
ms:contentKeyID: 61233498
ms:mtpsurl: 'https://technet.microsoft.com/pt-BR/library/973882(v=Security.10)'
---

Security Advisory

Comunicado de Segurança da Microsoft 973882
===========================================

Vulnerabilidades na Microsoft Active Template Library (ATL) podem permitir a execução remota de código
------------------------------------------------------------------------------------------------------

Publicado: terça-feira, 28 de julho de 2009 | Atualizado: terça-feira, 13 de outubro de 2009

**Versão:** 4.0

A Microsoft está lançando este comunicado de segurança para fornecer informações sobre nossa investigação continuada de vulnerabilidades nas versões pública e privada da Microsoft Active Template Library (ATL). Este comunicado também fornece orientações sobre o que os desenvolvedores podem fazer para ajudar a assegurar que os controles e componentes por eles criados não estejam vulneráveis aos problemas da ATL; o que os Profissionais de TI e consumidores podem fazer para atenuar ataques potenciais que usam as vulnerabilidades; e o que Microsoft está fazendo como parte de sua investigação continuada do problema descrito neste comunicado. Este comunicado de segurança também fornecerá uma lista abrangente de todos os Boletins de Segurança da Microsoft e atualizações de segurança relacionados às vulnerabilidades na ATL. A investigação da Microsoft das versões privada e pública da ATL é contínua, e lançaremos atualizações de segurança e orientações conforme apropriado, como parte do processo de investigação.

A Microsoft está ciente de vulnerabilidades de segurança nas versões pública e privada da ATL. A Microsoft ATL é usada por desenvolvedores de software para criar controles ou componentes para a plataforma Windows. As vulnerabilidades descritas neste Comunicado de Segurança e no Boletim de Segurança da Microsoft [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035) podem resultar em ataques de divulgação não autorizada de informações ou de execução remota de código a controles e componentes construídos com versões vulneráveis da ATL. Os componentes e controles criados com a versão vulnerável da ATL podem ficar expostos a uma condição vulnerável devido a como a ATL é usada ou a problemas no código da ATL propriamente dito.

**Orientações para desenvolvedores:** A Microsoft corrigiu os problemas nos cabeçalhos públicos da ATL e lançou atualizações para as bibliotecas no boletim [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035) "Vulnerabilidades na Active Template Library do Visual Studio podem permitir a execução remota de código". A Microsoft recomenda enfaticamente aos desenvolvedores que criam controles ou componentes com a ATL que se prontifiquem imediatamente a avaliar seus controles quanto à exposição a uma condição vulnerável e a seguir as orientações fornecidas para criar controles e componentes que não sejam vulneráveis. Para obter mais informações sobre as vulnerabilidades e orientações para lidar com os problemas na ATL, consulte o boletim [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035), "Vulnerabilidades na Active Template Library do Visual Studio podem permitir a execução remota de código".

**Orientações para Profissionais de TI e consumidores:** Para ajudar a protege melhor os clientes enquanto os desenvolvedores atualizam seus componentes e controles, a Microsoft desenvolveu uma nova tecnologia de defesa profunda. Essa nova tecnologia de defesa profunda incorporada ao Internet Explorer ajuda a proteger os clientes de ataques futuros que se valham das vulnerabilidades na Microsoft Active Template Library descritas neste Comunicado e no Boletim de Segurança da Microsoft MS09-035. Para beneficiar-se dessa nova tecnologia de defesa profunda, Profissionais de TI e consumidores devem implantar imediatamente a Atualização de Segurança do Internet Explorer oferecida no Boletim de Segurança da Microsoft [MS09-034](http://technet.microsoft.com/security/bulletin/ms09-034), "Atualização de segurança cumulativa para Internet Explorer".

Esta atualização de segurança inclui uma atenuação que evita que componentes e controles criados com a ATL vulnerável sejam explorados no Internet Explorer, além de abordar várias vulnerabilidades não relacionadas. As novas proteções de defesa profunda oferecidas no boletim MS09-034 incluem atualizações para o Internet Explorer 5.01, Internet Explorer 6 e Internet Explorer 6 Service Pack 1, Internet Explorer 7 e Internet Explorer 8. Estas proteções de defesa profunda monitoram e ajudam a evitar a exploração bem-sucedida de todas as vulnerabilidades conhecidas da ATL pública e privada, inclusive vulnerabilidades que podem fazer com que o recurso de segurança de kill bit do ActiveX seja ignorado. Essas proteções são criadas para ajudar a proteger os clientes de ataques baseados na Web.

**Orientações para usuários domésticos:** Para ajudar a protege melhor os clientes enquanto os desenvolvedores atualizam seus componentes e controles, a Microsoft desenvolveu uma nova tecnologia de defesa profunda. Esta nova tecnologia de defesa profunda incorporada ao Internet Explorer juntamente com a nova atualização ajuda a proteger os clientes contra ataques futuros que se valham das vulnerabilidades da Microsoft Active Template Library descritas neste Comunicado e no Boletim de Segurança da Microsoft MS09-035. Os usuários domésticos inscritos nas Atualizações Automáticas receberão a nova atualização do Internet Explorer automaticamente e não precisam tomar nenhuma providência. Os Usuários domésticos ficarão mais bem protegidos automaticamente contra ataques futuros que se valham das vulnerabilidades abordadas neste Comunicado de Segurança e no Boletim de Segurança da Microsoft MS09-035.

**Fatores atenuantes para Controles e Componentes criados com a versão vulnerável da Microsoft Active Template Library (ATL):**

-   Por padrão, a maioria dos controles ActiveX não é incluída na lista de permissões padrão para controles ActiveX no Internet Explorer 7 ou no Internet Explorer 8 executados no Windows Vista ou em sistemas operacionais posteriores. Somente os clientes que tenham aprovado explicitamente controles vulneráveis usando o recurso de opção de ativação do ActiveX estão suscetíveis a tentativas de exploração dessa vulnerabilidade. No entanto, se um cliente tiver usado esses controles ActiveX em uma versão anterior do Internet Explorer e, mais tarde, atualizado para o Internet Explorer 7 ou para o Internet Explorer 8, esses controles ActiveX estarão habilitados para funcionar no Internet Explorer 7 e no Internet Explorer 8, ainda que o cliente não o tenha aprovado explicitamente usando o recurso de opção de ativação de ActiveX.
-   Por padrão, o Internet Explorer 8 oferece proteções reforçadas, ativando proteções de memória DEP/NX para usuários no Windows XP Service Pack 3, Windows Vista Service Pack 1, Windows Vista Service Pack 2 e Windows 7.
-   Por padrão, o Internet Explorer no Windows Server 2003 e no Windows Server 2008 é executado em um modo restrito, conhecido como [Configuração de Segurança Reforçada](http://go.microsoft.com/fwlink/?linkid=92039). A Configuração de Segurança Reforçada é um grupo de configurações predefinidas do Internet Explorer que reduz a probabilidade de um usuário ou administrador baixar e executar um conteúdo da Web especialmente criado em um servidor. Este é um fator atenuante para sites que não tenham sido adicionados à zona Sites confiáveis do Internet Explorer. Consulte também [Gerenciamento de Configurações de Segurança Avançadas do Internet Explorer](http://go.microsoft.com/fwlink/?linkid=92055).
-   Por padrão, todas as versões compatíveis do Microsoft Outlook e do Microsoft Outlook Express abrem mensagens de email em HTML na zona de sites restritos. A zona Sites restritos ajuda a reduzir os ataques que podem tentar explorar essa vulnerabilidade, ao evitar que controles ActiveX e Script Ativos sejam usados durante a leitura de email em HTML. No entanto, se um usuário clicar em um link em uma mensagem de email, ele ainda pode estar vulnerável à exploração desta vulnerabilidade, de acordo com o cenário de ataque baseado na Web.
-   No cenário de ataque na Web, o invasor terá que hospedar um site contendo uma página da Web usada para explorar essa vulnerabilidade. Além disso, sites comprometidos e sites que aceitem ou hospedem conteúdo fornecido pelo usuário ou anúncios pode conter conteúdo especialmente desenvolvido que pode explorar esta vulnerabilidade. Em todos os casos, entretanto, um invasor não teria como forçar os usuários a visitarem os sites. Em vez disso, um invasor teria que persuadir os usuários a visitar o site, geralmente fazendo com que eles cliquem em um link em um email ou por um pedido pelo Instant Messenger que leva os usuários ao site do invasor.
-   O invasor que explorar com êxito a vulnerabilidade poderá obter os mesmos direitos que o usuário local. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

**Atualizações relacionadas à ATL:**

Atualização liberada em 13 de outubro de 2009

-   O Boletim de Segurança da Microsoft [MS09-060](http://technet.microsoft.com/security/bulletin/ms09-060), "Vulnerabilidades nos Controles ActiveX da Microsoft Active Template Library (ATL) para Microsoft Office podem permitir a execução remota de código", fornece suporte para os componentes do Microsoft Office afetados pelas vulnerabilidades do ATL descritas neste comunicado.

Atualizações lançadas em 25 de agosto de 2009

-   O Windows Live Messenger 14.0.8089 está sendo lançado para abordar vulnerabilidades no cliente do MSN Messenger que estejam relacionadas às vulnerabilidades da Active Template Library (ATL) descritas neste comunicado.
-   Uma seção de **Perguntas frequentes sobre componentes do Windows Live** foi adicionada a este comunicado para informar a remoção do recurso "Anexar Foto", do Windows Live Hotmail, e fornecer detalhes sobre o Windows Live Messenger 14.0.8089.

Atualizações lançadas em 11 de agosto de 2009

-   O Boletim de Segurança da Microsoft [MS09-037](http://technet.microsoft.com/security/bulletin/ms09-037), "Vulnerabilidades na Microsoft Active Template Library (ATL) podem permitir a execução remota de código", fornece suporte para componentes do Windows afetados pelas vulnerabilidades da ATL descritas neste comunicado.
-   O Boletim de Segurança da Microsoft [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035), "Vulnerabilidades na Active Template Library do Visual Studio podem permitir a execução remota de código", está sendo relançado para oferecer novas atualizações para desenvolvedores que usam o Visual Studio para criar componentes e controles para aplicativos móveis usando a ATL para Dispositivos Inteligentes.

Atualizações lançadas em 28 de julho de 2009

-   O Boletim de Segurança da Microsoft [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035), "Vulnerabilidades na Active Template Library do Visual Studio podem permitir a execução remota de código", detalha as vulnerabilidades específicas na ATL e fornece os cabeçalhos atualizados da ATL pública para que os fornecedores desenvolvam componentes e controles atualizados. Nossa investigação mostrou que há componentes e controles da Microsoft e de terceiros que são afetados por este problema e que tais componentes e controles existem em todas as edições com suporte do Windows 2000 Service Pack 4, Windows XP, Windows Server 2003, Windows Vista e Windows Server 2008. Os desenvolvedores que usaram versões vulneráveis da ATL ao criar controles ou componentes devem examinar este boletim e tomar precauções imediatamente caso seus controles estejam vulneráveis.
-   O Boletim de Segurança da Microsoft [MS09-034](http://technet.microsoft.com/security/bulletin/ms09-034), "Atualização de segurança cumulativa para Internet Explorer", inclui uma atenuação que impede que componentes e controles criados com a ATL vulnerável sejam explorados no Internet Explorer, além de abordar várias vulnerabilidades não relacionadas. As novas proteções de defesa profunda oferecidas no boletim MS09-034 incluem atualizações para o Internet Explorer 5.01, Internet Explorer 6 e Internet Explorer 6 Service Pack 1, Internet Explorer 7 e Internet Explorer 8. Estas proteções de defesa profunda monitoram e ajudam a evitar a exploração bem-sucedida de todas as vulnerabilidades conhecidas da ATL pública e privada, inclusive vulnerabilidades que podem fazer com que o recurso de segurança de kill bit do ActiveX seja ignorado. Essas proteções são criadas para ajudar a proteger os clientes de ataques baseados na Web.
-   Não estamos cientes de nenhum método ou controle incluído no Windows 7 que permita ataques bem-sucedidos por meio do Internet Explorer.

Atualização lançada em 14 de julho de 2009

-   O Boletim de Segurança da Microsoft [MS09-032](http://technet.microsoft.com/security/bulletin/ms09-032), "Atualização de segurança cumulativa de Kill Bits do ActiveX", forneceu medidas de segurança de ActiveX (um kill bit), o que impediu que o controle msvidctl fosse executado no Internet Explorer. A exploração no msvidcntl aproveitou a vulnerabilidade na versão privada da ATL. Nesta instância específica, a vulnerabilidade permite ao invasor corromper a memória, o que pode levar à execução remota de código. Os kill bits lançados na versão de junho do msvidctl (MS09-032) bloquearão as explorações públicas, como descrito aqui.

### Informações Gerais

Visão geral
-----------

<span></span>
**Finalidade do comunicado:** Este comunicado foi lançado para fornecer aos clientes uma notificação inicial sobre a vulnerabilidade divulgada publicamente. Para obter mais informações, consulte as seções **Soluções alternativas**, **Fatores atenuantes** e **Ações sugeridas** deste comunicado de segurança.

**Status do comunicado:** Comunicado publicado

**Recomendação:** Avalie as medidas sugeridas e configure da forma apropriada.

 
<p> </p>
<table style="border:1px solid black;">
<thead>
<tr class="header">
<th style="border:1px solid black;" >Referências</th>
<th style="border:1px solid black;" >Identificação</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>Referência CVE</strong></td>
<td style="border:1px solid black;"><a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-0901">CVE-2009-0901</a><br />
<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-2493">CVE-2009-2493</a><br />
<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2009-2495">CVE-2009-2495</a><br />
<a href="http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2008-0015">CVE-2008-0015</a></td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Boletim de Segurança</strong></td>
<td style="border:1px solid black;"><a href="http://technet.microsoft.com/security/bulletin/ms09-035">MS09-035</a>, &quot;Vulnerabilidades na Active Template Library do Visual Studio podem permitir a execução remota de código&quot;<br />
<br />
<a href="http://technet.microsoft.com/security/bulletin/ms09-034">MS09-034</a>, &quot;Atualização de segurança cumulativa para Internet Explorer&quot;<br />
<br />
<a href="http://technet.microsoft.com/security/bulletin/ms09-032">MS09-032</a>, &quot;Atualização de segurança cumulativa de Kill Bits do ActiveX&quot;</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Artigo da Microsoft Knowledge Base</strong></td>
<td style="border:1px solid black;"><a href="http://technet.microsoft.com/security/bulletin/ms09-035">MS09-035</a>:<br />
<a href="http://support.microsoft.com/kb/969706">Artigo 969706 (em inglês) da Microsoft Knowledge Base</a><br />
<br />
<a href="http://technet.microsoft.com/security/bulletin/ms09-034">MS09-034</a>:<br />
<a href="http://support.microsoft.com/kb/972260">Artigo 972260 (em inglês) da Microsoft Knowledge Base</a><br />
<br />
<a href="http://technet.microsoft.com/security/bulletin/ms09-032">MS09-032</a>:<br />
<a href="http://technet.microsoft.com/security/bulletin/ms09-032">Artigo 973346 (em inglês) da Microsoft Knowledge Base</a></td>
</tr>
</tbody>
</table>
 

Este comunicado descreve o seguinte software:

| Softwares afetados                                                       |
|--------------------------------------------------------------------------|
| Microsoft Windows                                                        |
| Controles e componentes criados com a Active Template Library vulnerável |
| Microsoft Live Services                                                  |
| Windows Live Messenger (versões anteriores à 14.0.8089)                  |
| Recurso "Anexar Foto" do Windows Live Hotmail                            |

Perguntas frequentes
--------------------

<span></span>
**Qual é o escopo do comunicado?**  
A Microsoft está ciente de vulnerabilidades que afetam componentes e controles criados com as versões pública e privada da Active Template Library (ATL). O objetivo do comunicado é conscientizar os usuários quanto às atualizações que ajudam a atenua o risco de controles e componentes vulneráveis, fornecer orientações a desenvolvedores que criaram controles e componentes usando a ATL vulnerável, bem como a profissionais de TI, sobre como proteger e instalar atenuações em seu ambiente.

**A Microsoft lançará atualizações de segurança adicionais relacionadas a este Comunicado de Segurança no futuro?**  
A investigação da Microsoft dos cabeçalhos privado e público da ATL é contínua, e lançaremos atualizações de segurança e orientações conforme apropriado, como parte do processo de investigação.

**A vulnerabilidade de msvidctl (MS09-032) estava relacionada a esta atualização para a ATL?**  
Sim, a exploração no msvidcntl aproveitou a vulnerabilidade na versão privada da ATL. Nesta instância específica, a vulnerabilidade permite ao invasor corromper a memória, o que pode levar à execução remota de código. O boletim [MS09-032](http://technet.microsoft.com/security/bulletin/ms09-032), publicado anteriormente em 14 de julho, bloqueia ataques conhecidos para msvidctl. Para obter mais informações sobre a exploração no msvidctl, consulte <http://blogs.technet.com/srd/archive/2009/07/06/new-vulnerability-in-mpeg2tunerequest-activex-control-object-in-msvidctl-dll.aspx>.

**A atualização do Internet Explorer (ms09-034) também protegerá contra ataques de msvidctl?**  
Sim, as atenuações do Internet Explorer protegerão contra a exploração das vulnerabilidades conhecidas nas versões pública e privada da ATL, inclusive dos ataques de msvidctl.

**O que é ATL?**  
A Active Template Library (ATL) é um conjunto de classes C++ baseado em modelo que permite criar objetos Component Object Model (COM) pequenos e rápidos. A ATL conta com suporte especial para os principais recursos do COM, inclusive implementações de estoque, interfaces duais, interfaces normais de enumerador de COM, pontos de conexão, interfaces destacáveis e controles ActiveX. Para obter mais informações, consulte o artigo do MSDN, [ATL](http://msdn.microsoft.com/en-us/library/3ax346b7(vs.71).aspx).

**O que causa esta ameaça na ATL?**  
O problema é causado, em alguns casos, pela maneira como a ATL é usada e, em outros casos, pelo código da ATL propriamente dito. Nestes casos, fluxos de dados podem ser manipulados incorretamente, o que pode levar à corrupção da memória, à divulgação não autorizada de informações e à instanciação de objetos sem levar em conta a diretiva de segurança. Para obter mais informações sobre as vulnerabilidades abordadas na ATL, consulte o boletim [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035), "Vulnerabilidades na Active Template Library do Visual Studio podem permitir a execução remota de código".

**Quais são as diferenças entre as versões pública e privada da Active Template Library?**  
A versão privada da Active Template Library é usada por desenvolvedores da Microsoft na criação de controles e componentes. A Microsoft atualizou todas as versões da Active Template Library usada por nossos desenvolvedores.

A versão pública da Active Template Library é distribuída a clientes por meio de ferramentas de desenvolvimento, como o Microsoft Visual Studio. A Microsoft está fornecendo uma versão atualizada de nossa ATL pública por meio do Boletim de Segurança da Microsoft MS09-035.

**As vulnerabilidades de segurança na ATL requererão que os desenvolvedores da Microsoft e de terceiros publiquem atualizações de segurança?**  
Sim. Além das atualizações de boletim descritas neste comunicado, a Microsoft está executando uma investigação abrangente de seus controles e componentes. Ao concluir a investigação, a Microsoft tomará as medidas apropriadas para ajudar a proteger seus clientes. Isso pode incluir o fornecimento de uma atualização de segurança através do nosso processo de lançamento mensal ou em regime excepcional, dependendo das necessidades dos clientes.

A Microsoft também está fornecendo orientações e contatando ativamente os principais desenvolvedores de terceiros a fim de ajudá-los a identificar controles e componentes vulneráveis. Isto pode resultar em atualizações de segurança para controles e componentes de terceiros.

Perguntas frequentes sobre Windows Live Services
------------------------------------------------

<span></span>
**Como a atualização para o Windows Live Messenger será distribuída?**  
Ao fazer logon no serviço Windows Live Messenger, os usuários do Windows Live Messenger 8.1, Windows Live Messenger 8.5 e Windows Live Messenger 14.0 em edições com suporte do Windows serão solicitados pelo mecanismo de implantação de cliente no serviço Windows Live Messenger a aceitar a atualização para Windows Live Messenger 14.0.8089. Também os usuários que desejarem baixar a atualização para o Windows Live Messenger 14.0.8089 poderão fazê-lo imediatamente usando o [Windows Live Download Center](http://download.live.com/messenger). Caso contrário, os usuários de versões vulneráveis de clientes Windows Live Messenger talvez não tenham permissão para se conectar ao serviço Windows Live Messenger.

**Por que a Microsoft está lançando a atualização para o Windows Live Messenger através do serviço Windows Live Messenger além de fornecer downloads?**  
A Microsoft atualmente lança atualizações para o cliente Windows Live Messenger usando o serviço Windows Live Messenger porque esses serviços online têm seu próprio mecanismo de implantação de cliente. No entanto, os links do Centro de Download da Microsoft também estão disponíveis para clientes Windows Live Messenger específicos. Os usuários que desejarem baixar as atualizações imediatamente poderão fazê-lo no [Windows Live Download Center](http://download.live.com/messenger).

**Se isso é uma atualização, como posso detectar se tenho uma versão vulnerável do Windows Live Messenger?**    
Quando você tentar se conectar ao serviço Windows Live Messenger, o mecanismo de implantação de cliente determinará automaticamente sua versão de cliente atual e plataforma e, se necessário, recomendará a atualização apropriada. Além disso, você poderá determinar sua versão do cliente Windows Live Messenger clicando em **Ajuda** e em **Sobre**.

**O que acontece se eu não atualizar para a versão mais atual do Windows Live Messenger?**  
Se você não atualizar para uma versão não afetada do cliente Windows Live Messenger, dependendo de sua plataforma, você será notificado para atualizar a cada tentativa de conexão. Se você não aceitar a atualização, talvez não tenha permissão para acessar o serviço Windows Live Messenger.

**Há outros aplicativos de colaboração em tempo real da Microsoft, como o Windows Messenger ou o Office Communicator, que são afetados por essa vulnerabilidade?**  
Não. Os outros aplicativos de mensagens não são afetados pois eles não contêm o componente vulnerável.

**Quando a Microsoft removeu o recurso "Anexar Foto" do Windows Live Hotmail? Isso coincidiu com o lançamento de outro novo recurso?**  
A Microsoft recentemente tomou a decisão de remover o recurso por um curto prazo para corrigir o problema. A remoção temporária desse recurso não coincidiu com o lançamento de outro recurso.

**Qual é a previsão para que o recurso "Anexar Foto" seja completamente restaurado a todos os usuários?**  
A Microsoft vem trabalhando ativamente para corrigir o problema. Enquanto isso, você ainda pode adicionar imagens como anexos às suas mensagens enviadas pelo Hotmail, clicando em **Anexar** e selecionando a imagem que deseja incluir.

Perguntas mais frequentes de desenvolvedores sobre a atualização do Visual Studio
---------------------------------------------------------------------------------

<span></span>
**O que causa esta ameaça na ATL?**  
O problema é causado, em alguns casos, pela maneira como a ATL é usada e, em outros casos, pelo código da ATL propriamente dito. Nestes casos, fluxos de dados podem ser manipulados incorretamente, o que pode levar à corrupção da memória, à divulgação não autorizada de informações e à instanciação de objetos sem levar em conta a diretiva de segurança. Para obter mais informações sobre as vulnerabilidades abordadas na ATL, consulte o boletim [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035), "Vulnerabilidades na Active Template Library do Visual Studio podem permitir a execução remota de código".

**Para que um invasor pode usar essa vulnerabilidade?**  
Para controles e componentes criados com a ATL, o uso não seguro de certas macros pode permitir a instanciação de objetos arbitrários que podem ignorar a diretiva de segurança de ActiveX relacionada (isto é, kill bits) no Internet Explorer. Além disso, componentes e controles criados com a versão vulnerável da ATL podem estar vulneráveis a ameaças de execução remota de código ou de divulgação não autorizada de informações. Se um usuário tiver feito logon com direitos de usuário administrativo e tiver um controle vulnerável em seu sistema, o invasor poderá obter o controle total do sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

**Sou desenvolvedor de aplicativos de terceiros e uso a ATL em meu componente ou controle. Meu componente ou controle está vulnerável? Se estiver, como o atualizo?**    
Componentes e controles podem ser afetados por este problema se certas condições forem satisfeitas durante a criação do componente ou controle. O boletim [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035) contém informações adicionais, exemplos e orientações que desenvolvedores de terceiros podem usar para detectar e corrigir componentes e controles vulneráveis.

**O que a Atualização de Segurança para Visual Studio faz?**  
Estas atualizações abordam vulnerabilidades na Microsoft Active Template Library (ATL) que podem permitir que um usuário remoto não autenticado execute código arbitrário em um sistema afetado. Essas vulnerabilidades são, em alguns casos, causadas pela maneira como a ATL é usada e, em outros casos, pelo código da ATL propriamente dito. Visto que essas vulnerabilidades afetam a ATL, componentes ou controles que foram desenvolvidos usando a ATL podem expor clientes que estejam usando os controles e componentes afetados a cenários de execução remota de código.

A atualização de segurança para Visual Studio atualiza a versão vulnerável da ATL usada pelo Visual Studio. Isso permite aos usuários do Visual Studio modificar e reconstruir seus controles e componentes usando uma versão atualizada da ATL.

Nossa investigação mostrou que tanto componentes e controles da Microsoft quanto de terceiros podem ser afetados por este problema. Portanto, todos os fornecedores afetados precisam modificar e reconstruir seus componentes e controles usando a ATL corrigida fornecida no Boletim de Segurança da Microsoft [MS09-035](http://technet.microsoft.com/security/bulletin/ms09-035).

Perguntas mais frequentes de Profissionais de TI sobre o que eles podem fazer para se proteger
----------------------------------------------------------------------------------------------

<span></span>
**A atualização do IE MS09-034 me protege de todos os componentes e controles que foram criados com a versão vulnerável da ATL?**  
Para ajudar a protege melhor os clientes enquanto os desenvolvedores atualizam seus componentes e controles, a Microsoft desenvolveu uma nova tecnologia de defesa profunda. Esta nova tecnologia de defesa profunda incorporada ao Internet Explorer ajuda a proteger os clientes contra ataques futuros que se valham das vulnerabilidades da Microsoft Active Template Library descritas neste Comunicado e no Boletim de Segurança da Microsoft MS09-035. O Boletim de Segurança da Microsoft [MS09-034](http://technet.microsoft.com/security/bulletin/ms09-034), "Atualização de segurança cumulativa para Internet Explorer", inclui uma atenuação que evita que componentes e controles criados com a ATL vulnerável sejam explorados no Internet Explorer, além de abordar várias vulnerabilidades não relacionadas.

A Microsoft continua investigando todos os controles e componentes da Microsoft e ajudando desenvolvedores de terceiros a avaliar seus controles e componentes.

**O que um profissional de TI pode fazer para atenuar a exposição a este problema?**  
A Microsoft recomenda enfaticamente que os profissionais de TI implementem imediatamente a Atualização de Segurança para o Internet Explorer oferecida no Boletim de Segurança da Microsoft [MS09-034](http://technet.microsoft.com/security/bulletin/ms09-034), "Atualização de segurança cumulativa para Internet Explorer".

Perguntas mais frequentes sobre o que os consumidores podem fazer para se proteger
----------------------------------------------------------------------------------

<span></span>
**O que os consumidores podem fazer para atenuar a exposição a este problema?**  
Para ajudar a protege melhor os clientes enquanto os desenvolvedores atualizam seus componentes e controles, a Microsoft desenvolveu uma nova tecnologia de defesa profunda. Esta nova tecnologia de defesa profunda incorporada ao Internet Explorer ajuda a proteger os clientes contra ataques futuros que se valham das vulnerabilidades da Microsoft Active Template Library descritas neste Comunicado e no Boletim de Segurança da Microsoft MS09-035. A Microsoft recomenda que os consumidores ativem a [Atualização Automática](http://www.microsoft.com/windows/downloads/windowsupdate/automaticupdate.mspx) e instalem imediatamente a Atualização de Segurança do Internet Explorer oferecida no Boletim de Segurança da Microsoft [MS09-034](http://technet.microsoft.com/security/bulletin/ms09-034), "Atualização de segurança cumulativa para Internet Explorer". Os usuários domésticos que recebem atualizações automaticamente receberão as atenuações fornecidas na atualização cumulativa do IE e outras atualizações de segurança relacionadas a este problema, não sendo preciso tomar qualquer outra providência.

A Microsoft também recomenda aos usuários domésticos atualizar para o [Internet Explorer 8](http://www.microsoft.com/windows/internet-explorer/worldwide-sites.aspx) para beneficiar-se de segurança e proteções reforçadas.

Perguntas mais frequentes sobre as atenuações na atualização do Internet Explorer
---------------------------------------------------------------------------------

<span></span>
**O que causa esta ameaça, que pode permitir que a segurança de ActiveX seja ignorada?**  
Os controles ActiveX criados com métodos vulneráveis da ATL podem não validar informações corretamente. Isso pode resultar em um controle ActiveX que permite corrupção de memória ou que permite a um invasor aproveitar um controle ActiveX confiável para carregar um controle ActiveX não confiável cuja execução no Internet Explorer já tenha sido bloqueada.

As novas proteções de defesa profunda oferecidas no boletim MS09-034 incluem atualizações para o Internet Explorer 5.01, Internet Explorer 6 e Internet Explorer 6 Service Pack 1, Internet Explorer 7 e Internet Explorer 8, que monitoram e evitam a exploração bem-sucedida de todas as vulnerabilidades conhecidas da ATL pública e privada, inclusive vulnerabilidades que podem fazer com que o recurso de segurança de kill bit do ActiveX do IE seja ignorado. Estas proteções foram projetadas para proteger os clientes contra ataques baseados na Web.

**Para que um invasor pode usar a função?**  
Um invasor que explore a vulnerabilidade com êxito no Windows Vista ou no Windows 2008 obteria somente os direitos de um usuário restrito, devido ao modo protegido no Internet Explorer. Em outros sistemas Windows, o invasor pode obter os mesmos direitos do usuário local. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

**Como um invasor pode usar essa função?**  
O invasor pode hospedar um site projetado para hospedar um controle ActiveX especialmente criado e, então, convencer um usuário a exibir o site. Isso também inclui sites comprometidos e sites que aceitam ou hospedam anúncios ou conteúdo fornecido pelo usuário. Em todos os casos, entretanto, um invasor não teria como forçar os usuários a visitarem os sites. Em vez disso, um invasor tem que convencer os usuários a visitar o site, geralmente fazendo com que eles cliquem em um link em um email ou por um pedido pelo Instant Messenger que leva o usuário ao site do invasor.

**O que é um killbit?**  
Um recurso de segurança do Microsoft Internet Explorer torna possível impedir que um controle ActiveX seja carregado pelo mecanismo de renderização de HTML do Internet Explorer. Isso é feito com uma configuração do Registro e é chamado de "definição do kill bit". Depois que o killbit é definido, o controle nunca pode ser carregado, mesmo quando está plenamente instalado. Definir o killbit assegura que, ainda que um componente vulnerável seja introduzido ou reintroduzido em um sistema, ele permanece inerte e inofensivo.

Para obter mais informações sobre kill bits, consulte o [Artigo 240797 da Microsoft Knowledge Base:](http://support.microsoft.com/kb/240797) Como impedir que um controle ActiveX seja executado no Internet Explorer. Para obter informações mais detalhadas sobre kill bits e como funcionam no Internet Explorer, consulte a seguinte postagem no blog, [Security Research and Defense](http://blogs.technet.com/srd/archive/2008/02/06/the-kill_2d00_bit-faq_3a00_-part-1-of-3.aspx) (em inglês).

**O que a atualização faz?**  
A atualização reforça o mecanismo de segurança de ActiveX fornecendo validação quando métodos não seguros são usados por controles ActiveX que usam cabeçalhos vulneráveis da ATL em configurações específicas.

**Essa atualização altera a funcionalidade?**  
Sim. Esta atualização não permite mais que conjuntos específicos de métodos da ATL sejam executados no Internet Explorer. A atualização atenua o risco de ignorar a segurança ativa, visto que evita que controles ActiveX confiáveis carreguem controles não confiáveis

**Essa atualização contém alterações de software adicionais?**  
Sim. Esta atualização também contém correções de segurança adicionais e outras atualizações para o Internet Explorer, como parte da atualização cumulativa para o Internet Explorer.

**Esta atualização aborda todos os cenários de controles ActiveX não seguros?**  
Não. Esta atualização aborda especificamente controles ActiveX não seguros/não confiáveis que podem estar vulneráveis aos problemas da ATL descritos neste Comunicado a fim de proteger clientes contra ataques durante a navegação pela Internet.

A Microsoft continua investigando este problema. Ao concluir a investigação, a Microsoft tomará as medidas apropriadas para ajudar a proteger seus clientes. Isso pode incluir o fornecimento de uma atualização de segurança através do nosso processo de lançamento mensal ou em regime excepcional, dependendo das necessidades dos clientes.

**Como o Modo Protegido no Internet Explorer 7 e Internet Explorer 8 no Windows** **Vista** **e posteriores me protege contra esta vulnerabilidade?**  
O Internet Explorer 7 e Internet Explorer 8 no Windows Vista e em sistemas operacionais posteriores são executados no [Modo Protegido](http://www.microsoft.com/windows/windows-vista/features/ie7-protected-mode.aspx) por padrão na zona de segurança da Internet. O Modo Protegido reduz significativamente a capacidade de um invasor de gravar, alterar ou destruir dados na máquina do usuário ou instalar código mal-intencionado. Isso é feito usando os mecanismos de integridade do Windows Vista e versões mais atuais, que restringem o acesso a processos, arquivos e chaves do Registro com níveis mais altos de integridade.

**O que é Prevenção de Execução de Dados (DEP)?**  
A Prevenção de Execução de Dados (DEP) é ativada por padrão no Internet Explorer 8. A DEP foi projetada para ajudar a bloquear ataques, evitando a execução na memória de código que esteja marcado como não-executável. Para obter mais informações sobre DEP no Internet Explorer, consulte a seguinte publicação: [http://blogs.msdn.com/ie/archive/2008/04/08/ie8-security-part-I\_3A00\_-dep-nx-memory-protection.aspx](http://blogs.msdn.com/ie/archive/2008/04/08/ie8-security-part-i_3a00_-dep-nx-memory-protection.aspx).

Ações sugeridas
---------------

<span></span>
-   **Leia o artigo da Microsoft Knowledge Base associado a este comunicado**  
    Os clientes interessados em saber mais sobre os problemas do ATL devem ler o [artigo 973882 (em inglês) do Microsoft Knowledge Base](http://support.microsoft.com/kb/973882).
-   **Aplique as atualizações associadas aos boletins de segurança MS09-034 e MS09-035**  
    Os clientes com sistemas afetados podem baixar as atualizações do [Artigo 969706 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/969706) e do [Artigo 972260 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/972260). A atualização do Internet Explorer fornece novas atenuações que evitam a instanciação de controles ActiveX vulneráveis no Internet Explorer 7 e 8. A atualização do Visual Studio permite aos desenvolvedores criar controles ActiveX que não sejam afetados por estas vulnerabilidades.
-   **Proteja seu PC**  
    Continuamos a incentivar nossos clientes a seguir nossa orientação de proteger o computador por meio de habilitação do firewall, obtenção de atualizações de software e instalação de software antivírus. Os clientes podem aprender mais sobre essas etapas visitando o site [Proteja seu Computador](http://www.microsoft.com/protect/computer/default.mspx).
-   Para obter mais informações sobre como ficar protegido na Internet, os clientes devem visitar a [Central de Segurança da Microsoft](http://www.microsoft.com/security/default.mspx).
-   **Mantenha o Windows atualizado**  
    Todos os usuários do Windows devem aplicar as mais recentes atualizações de segurança da Microsoft para ter certeza de que seus computadores estão protegidos ao máximo. Se não tiver certeza de que seu computador está atualizado, visite o [Windows Update](http://windowsupdate.microsoft.com/), verifique se há atualizações disponíveis para o computador e instale as atualizações de alta prioridade oferecidas. Se o recurso Atualizações automáticas estiver ativado, as atualizações serão fornecidas quando forem lançadas, mas você precisará instalá-las.

#### Soluções alternativas

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Quando uma solução alternativa reduz a funcionalidade, ela é identificada na seção a seguir.

#### Defina as configurações de zona de segurança da Internet e da intranet local como “Alto” para ser notificado antes da execução de controles ActiveX e scripts ativos nessas zonas

Você pode ajudar na proteção contra essa vulnerabilidade alterando as configurações para que a zona de segurança da Internet solicite uma confirmação antes de executar controles ActiveX e scripts ativos. É possível fazer isso configurando a segurança do navegador como **Alta**.

Para aumentar o nível de segurança da navegação no Microsoft Internet Explorer, faça o seguinte:

1.  No menu **Ferramentas** do Internet Explorer, clique em **Opções da Internet**.
2.  Na caixa de diálogo **Opções da Internet**, clique na guia **Segurança** e, em seguida, no ícone **Internet**.
3.  Em **Nível de segurança para esta zona**, mova o controle deslizante para **Alto**. Isso define o nível de segurança para todos os sites visitados como **Alto**.

**Observação** Se o controle deslizante não estiver visível, clique em **Nível Padrão** e mova o controle deslizante para **Alto.**

**Observação** A configuração do nível como **Alto** pode fazer com que alguns sites não funcionem corretamente. Se você encontrar dificuldades ao usar um site após alterar a configuração, mas tiver certeza de que o site é seguro, é possível adicionar esse site à lista de sites confiáveis. Isso permite que o site funcione corretamente, mesmo com a configuração de segurança definida como **Alta**.

**Impacto da solução alternativa:** Há efeitos colaterais para notificação antes da execução de controles ActiveX e scripts ativos. Muitos sites que não estão na Internet ou na intranet usam controles ActiveX e scripts ativos para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou um banco online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução de controles ActiveX ou scripts ativos é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Em cada notificação, se você sentir que confia no site que está visitando, clique em **Sim** para executar os controles ActiveX ou os scripts ativos. Se não quiser ser avisado para todos esses sites, use os passos descritos em “Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer”.

**Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer**

Depois de definir o Internet Explorer para solicitar confirmação antes de executar controles ActiveX e scripts ativos na zona da Internet e da Intranet local, você pode adicionar sites confiáveis à zona de Sites confiáveis do Internet Explorer. Isso permitirá que você continue usando os sites confiáveis exatamente como faz atualmente, enquanto ajuda a proteger-se de ataques em sites não confiáveis. É recomendável adicionar somente sites nos quais você confia à zona de Sites confiáveis.

Para isso, siga estas etapas:

1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique na guia **Segurança**.
2.  Na caixa **Selecione uma zona de conteúdo da Web para especificar suas configurações de segurança**, clique em **Sites Confiáveis** e, em seguida, clique em **Sites**.
3.  Se desejar adicionar sites que não requerem um canal criptografado, clique para desmarcar a caixa de seleção **Exigir verificação do servidor (https:) para todos os sites desta zona**.
4.  Na caixa **Adicionar este site à zona,** digite a URL de um site em que confia e, em seguida, clique em **Adicionar**.
5.  Repita essas etapas para cada site que você deseja adicionar à zona.
6.  Clique em **OK** duas vezes para aceitar as alterações e retornar ao Internet Explorer.

**Observação** Adicione os sites que você considerar que não tenham ação mal-intencionada ao seu computador. Dois em particular que você pode desejar adicionar são **\*.windowsupdate.microsoft.com** e **\*.update.microsoft.com.** Estes são os sites que hospedam a atualização, e é preciso ter um controle ActiveX para instalar a atualização.

#### Configure o Internet Explorer para notificá-lo antes da execução de scripts ativos ou desative os scripts ativos na zona de segurança da Internet e da intranet local

Para se proteger contra essa vulnerabilidade, altere as configurações do Internet Explorer para ser notificado antes da execução de scripts ativos ou desabilite os scripts ativos na zona de segurança da Internet e da intranet local. Para isso, siga estas etapas:

1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
2.  Clique na guia **Segurança**.
3.  Clique em **Internet** e, em seguida, clique em **Nível Personalizado**.
4.  Em **Configurações**, na seção **Script**, em **Scripts Ativos**, clique em **Avisar** ou **Desativar** e, em seguida, clique em **OK**.
5.  Clique em **Intranet local** e, em seguida, clique em **Nível Personalizado**.
6.  Em **Configurações**, na seção **Script**, em **Scripts Ativos**, clique em **Avisar** ou **Desativar** e, em seguida, clique em **OK**.
7.  Clique em **OK** duas vezes para retornar ao Internet Explorer.

**Observação** A desabilitação dos scripts ativos zona de segurança da Internet e da intranet local poderá fazer com que alguns sites não funcionem corretamente. Se você encontrar dificuldades ao usar um site após alterar a configuração, mas tiver certeza de que o site é seguro, é possível adicionar esse site à lista de sites confiáveis. Isso permitirá que o site funcione adequadamente.

**Impacto da solução alternativa:** Há efeitos colaterais para notificação antes da execução de scripts ativos. Muitos sites que não estão na Internet ou na intranet usam scripts ativos para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou bancário online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução dos scripts ativos é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Para cada notificação, se achar que confia no site que está visitando, clique em **Sim** para executar os scripts ativos. Se não quiser ser avisado para todos esses sites, use os passos descritos em “Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer”.

**Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer**

Depois de definir o Internet Explorer para solicitar confirmação antes de executar controles ActiveX e scripts ativos na zona da Internet e da Intranet local, você pode adicionar sites confiáveis à zona de Sites confiáveis do Internet Explorer. Isso permitirá que você continue usando os sites confiáveis exatamente como faz atualmente, enquanto ajuda a proteger-se de ataques em sites não confiáveis. É recomendável adicionar somente sites nos quais você confia à zona de Sites confiáveis.

Para isso, siga estas etapas:

1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique na guia **Segurança**.
2.  Na caixa **Selecione uma zona de conteúdo da Web para especificar suas configurações de segurança**, clique em **Sites Confiáveis** e, em seguida, clique em **Sites**.
3.  Se desejar adicionar sites que não requerem um canal criptografado, clique para desmarcar a caixa de seleção **Exigir verificação do servidor (https:) para todos os sites desta zona**.
4.  Na caixa **Adicionar este site à zona,** digite a URL de um site em que confia e, em seguida, clique em **Adicionar**.
5.  Repita essas etapas para cada site que você deseja adicionar à zona.
6.  Clique em **OK** duas vezes para aceitar as alterações e retornar ao Internet Explorer.

**Observação** Adicione os sites que você considerar que não tenham ação mal-intencionada ao seu computador. Dois em particular que você pode desejar adicionar são **\*.windowsupdate.microsoft.com** e **\*.update.microsoft.com.** Estes são os sites que hospedam a atualização, e é preciso ter um controle ActiveX para instalar a atualização.

### Outras informações

**Recursos:**

-   Você pode fazer comentários, preenchendo o formulário no site [Ajuda e Suporte da Microsoft: Fale conosco](https://support.microsoft.com/common/survey.aspx?scid=sw;en;1257&amp;showpage=1&amp;ws=technet&amp;sd=tech).
-   Os clientes nos EUA e Canadá podem receber suporte técnico do [Suporte de Segurança](http://go.microsoft.com/fwlink/?linkid=21131). Para obter mais informações sobre as opções de suporte disponíveis, consulte [Ajuda e Suporte da Microsoft](http://support.microsoft.com/?ln=pt-br).
-   Os clientes de outros países podem obter suporte nas subsidiárias locais da Microsoft. Para obter mais informações sobre como entrar em contato com a Microsoft para problemas de suporte internacional, visite o site [Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).
-   O [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos da Microsoft.

**Aviso de isenção de responsabilidade:**

As informações oferecidas neste documento são fornecidas "como estão" sem garantia de nenhum tipo. A Microsoft se isenta de todas as garantias, expressas ou implícitas, inclusive as garantias de comercialização e adequação a um propósito específico. Em hipótese alguma a Microsoft Corporation ou seus fornecedores serão responsáveis por quaisquer danos, inclusive danos diretos, indiretos, incidentais, conseqüenciais, danos por lucros cessantes ou danos especiais, mesmo que a Microsoft Corporation ou seus fornecedores tenham sido alertados da possibilidade dos referidos danos. Como alguns estados não permitem a exclusão ou limitação de responsabilidade por danos conseqüenciais ou indiretos, a limitação acima pode não ser aplicável a você.

**Revisões:**

-   V1.0 (28 de julho de 2009): Comunicado publicado
-   V2.0 (11 de agosto de 2009): O comunicado foi revisado para adicionar entradas à seção **Atualizações relacionadas à ATL** para comunicar o lançamento do Boletim de Segurança da Microsoft MS09-037, Vulnerabilidades na Microsoft Active Template Library (ATL) podem permitir a execução remota de código, e o relançamento do Boletim de Segurança da Microsoft MS09-035, Vulnerabilidades na Active Template Library do Visual Studio podem permitir a execução remota de código, para oferecer atualizações adicionais.
-   V3.0 (25 de agosto de 2009): Comunicado revisado para fornecer detalhes sobre o Windows Live Messenger 14.0.8089 e para comunicar a remoção do recurso "Anexar Foto", do Windows Live Hotmail.
-   V4.0 (13 de outubro de 2009): Comunicado revisado para adicionar uma entrada na seção **Atualizações relacionada à ATL** para comunicar a versão do Boletim de Segurança da Microsoft MS09-060, "Vulnerabilidades nos Controles ActiveX da Microsoft Active Template Library (ATL) para Microsoft Office podem permitir a execução remota de código".

*Built at 2014-04-18T13:49:36Z-07:00*
