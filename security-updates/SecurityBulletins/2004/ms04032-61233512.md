---
TOCTitle: 'MS04-032'
Title: 'Microsoft  MS04-032 - Crítica'
ms:assetid: 'ms04-032'
ms:contentKeyID: 61233512
ms:mtpsurl: 'https://technet.microsoft.com/pt-BR/library/ms04-032(v=Security.10)'
---



Microsoft  MS04-032 - Crítica
==============================================

Atualização de Segurança do Microsoft Windows (840987)
------------------------------------------------------

Atualizado: terça-feira, 9 de dezembro de 2008
  
**Versão:** 1.1

**Publicado em:** 12 de outubro de 2004  
**Versão:** 1.1

#### Resumo

**Quem deve ler este documento:** Clientes que usam o Microsoft Windows

**Impacto da vulnerabilidade:** Execução Remota de Código

**Classificação máxima de gravidade:** Crítica

**Recomendação:** Os clientes devem instalar a atualização imediatamente.

**Substituição da atualização de segurança:** Este boletim substitui muitas atualizações de segurança anteriores. Veja a lista completa na seção Perguntas freqüentes deste boletim.

**Advertências:** O Artigo [840987](http://support.microsoft.com/default.aspx?scid=kb;en-us;840987) (em inglês) da Microsoft Knowledge Base documenta os problemas atualmente conhecidos que os clientes podem enfrentar ao instalar esta atualização de segurança. O artigo também documenta as soluções recomendadas para esses problemas. Para obter mais informações, consulte o artigo [840987](http://support.microsoft.com/default.aspx?scid=kb;en-us;840987) (em inglês) do Microsoft Knowledge Base.

**Locais de softwares testados e de download de atualização de segurança:**

**Softwares afetados:**

-   Microsoft Windows NT Server 4.0 Service Pack 6a – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=533ae5cd-74ce-470a-8916-8e358084497c)
-   Microsoft Windows NT Server 4.0 Terminal Server Edition Service Pack 6 – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=3b871a96-5f64-4432-920f-fa5760df683a)
-   Microsoft Windows 2000 Service Pack 3 e Microsoft Windows 2000 Service Pack 4 – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=4a614222-ba0b-4927-856d-d443bbbe1a42)
-   Microsoft Windows XP e Microsoft Windows XP Service Pack 1 – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=715e985b-7929-4bd5-9564-5cfe7d528398)
-   Microsoft Windows XP 64-Bit Edition Service Pack 1 - [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=99184841-70a8-47c7-9993-44a60e999a40)
-   Microsoft Windows XP 64-Bit Edition Versão 2003 – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=b4e6bbcf-f5b9-4b2d-8bc4-30911ca4fd9c)
-   Microsoft Windows Server 2003 64-Bit Edition - [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=b4e6bbcf-f5b9-4b2d-8bc4-30911ca4fd9c)
-   Microsoft Windows 98, Microsoft Windows 98 SE (Second Edition) e Microsoft Windows ME (Millennium Edition) – Consulte a seção Perguntas freqüentes deste boletim para obter detalhes sobre esses sistemas operacionais.

**Softwares não afetados:**

-   Microsoft Windows XP Service Pack 2

Os softwares dessa lista foram testados para determinar se as versões são afetadas. Outras versões já não incluem suporte para a atualização de segurança ou podem não ser afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o site [Ciclo de Vida do Suporte Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

### Informações Gerais

Sinopse
-------

<span></span>
**Sinopse:**

Esta atualização elimina várias vulnerabilidades descobertas recentemente e reportadas em particular. Cada vulnerabilidade está documentada neste boletim em sua própria seção Detalhes da vulnerabilidade.

O invasor que explorar com êxito a mais grave dessas vulnerabilidades poderá assumir o controle total de um sistema afetado, incluindo instalação de programas, exibição, alteração ou exclusão de dados ou criação de novas contas com privilégios totais.

Recomendamos que os clientes apliquem a atualização imediatamente.

**Classificação de Gravidade e Identificadores de Vulnerabilidade:**

| Identificadores de Vulnerabilidade                                                                                                                     | Impacto da Vulnerabilidade | Windows 98, 98 SE, ME | Windows NT 4.0 | Windows 2000 (site em inglês) | Windows XP (site em inglês) | Windows Server 2003 |
|--------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|-----------------------|----------------|-------------------------------|-----------------------------|---------------------|
| Vulnerabilidade no gerenciamento de janelas - [CAN-2004-0207](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0207)                         | Elevação de privilégio     | Não Crítica           | Importante     | Importante                    | Importante                  | Importante          |
| Vulnerabilidade na máquina virtual de DOS - [CAN-2004-0208](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0208)                           | Elevação de privilégio     | Nenhuma               | Importante     | Importante                    | Importante                  | Importante          |
| Vulnerabilidade no mecanismo de processamento de elementos gráficos - [CAN-2004-0209](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0209) | Execução Remota de Código  | Nenhuma               | Nenhuma        | Crítica                       | Crítica                     | Crítica             |
| Vulnerabilidade no kernel do Windows - [CAN-2004-0211](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2004-0211)                                | Negação de Serviço         | Nenhuma               | Nenhuma        | Nenhuma                       | Nenhuma                     | Importante          |
| **Gravidade Agregada de Todas as Vulnerabilidades**                                                                                                    |                            | **Não Crítica**       | **Importante** | **Crítica**                   | **Crítica**                 | **Crítica**         |

Essa [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas afetados pela vulnerabilidade, seus padrões comuns de implantação e o efeito da exploração da vulnerabilidade sobre eles.

Perguntas freqüentes relacionadas a esta atualização de segurança
-----------------------------------------------------------------

<span></span>
**Por que este boletim foi revisado em 9 de dezembro de 2008?**  
Este boletim foi revisado para comunicar a remoção do pacote Windows Server 2003 devido a problemas não relacionados à estabilidade da atualização ou à segurança dos sistemas de destino pretendidos. Os clientes que já aplicaram com êxito esta atualização não precisam realizar nenhuma ação. Os clientes do Windows Server 2003 que não aplicaram essa atualização e que estão preocupados com este problema devem aplicar [o último service pack](http://support.microsoft.com/kb/889100). A aplicabilidade deste boletim em outros sistemas operacionais Windows não mudou.

**Por que esta atualização elimina várias vulnerabilidades de segurança reportadas?**  
Esta atualização contém suporte para diversas vulnerabilidades porque as modificações necessárias para corrigir esses problemas foram feitas em arquivos relacionados. Em vez de instalar várias atualizações quase iguais, os clientes poderão instalar apenas esta atualização.

**Quais atualizações esta versão substitui?**  
Esta atualização de segurança substitui vários boletins de segurança anteriores. A identificação do boletim de segurança e os sistemas operacionais afetados estão relacionados na tabela a seguir.

| ID do Boletim                                                | Windows NT 4.0  | Windows 2000 (site em inglês) | Windows XP (site em inglês) | Windows Server 2003 |
|--------------------------------------------------------------|-----------------|-------------------------------|-----------------------------|---------------------|
| [**MS02-071**](http://go.microsoft.com/fwlink?linkid=10597)  | Substituído     | Substituído                   | Não substituído             | Não Aplicável       |
| [**MS03-007**](http://go.microsoft.com/fwlink?linkid=14822)  | Não substituído | Substituído                   | Não substituído             | Não Aplicável       |
| [**MS03-013**](http://go.microsoft.com/fwlink?linkid=12675)  | Substituído     | Substituído                   | Substituído                 | Não Aplicável       |
| [**MS03-045**](http://go.microsoft.com/fwlink/?linkid=18866) | Substituído     | Substituído                   | Substituído                 | Não substituído     |

**Ainda uso o Windows XP, mas o suporte estendido de atualização de segurança foi encerrado em 30 de setembro de 2004. No entanto, este boletim tem uma atualização de segurança para esta versão de sistema operacional. Por quê?**  

A versão original do Windows XP, geralmente conhecida como a versão Windows XP Gold ou Windows XP Release to Manufacturing (RTM), atingiu o fim do ciclo de vida de seu suporte estendido de atualização de segurança em 30 de setembro de 2004. No entanto, o término da vida ocorreu recentemente. Nesse caso, a maioria das etapas necessárias para a solução desta vulnerabilidade foi concluída antes dessa data. Portanto, decidimos lançar uma atualização de segurança para essa versão do sistema operacional como parte deste boletim de segurança.
Não é nossa intenção fazer isso em relação às futuras vulnerabilidades que afetem essa versão de sistema operacional, mas reservamo-nos o direito de produzir e disponibilizar essas atualizações quando necessário. Os clientes que possuem essa versão de sistema operacional devem ter como prioridade migrar para uma versão com suporte a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do produto Windows Service Pack, visite o [site Microsoft Support Lifecycle](http://support.microsoft.com/default.aspx?pr=lifesupsps) (em inglês). Para obter mais informações sobre o ciclo de vida do produto Windows, visite o site [Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) (em inglês).

Para obter mais informações, consulte o site [Perguntas mais freqüentes sobre o Sistema Operacional Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**Ainda uso o Microsoft Windows NT 4.0 Workstation Service Pack 6a ou o Windows 2000 Service Pack 2, mas o suporte estendido de atualização de segurança foi encerrado em 30 de junho de 2004. O que eu devo fazer?**  
O Windows NT 4.0 Workstation Service Pack 6a e o Windows 2000 Service Pack 2 chegaram ao fim de seus ciclos de vida, como previamente documentado, e a Microsoft estendeu esse suporte até 30 de junho de 2004.

Deve ser uma prioridade dos clientes que possuem essas versões de sistema operacional migrar para as versões com suporte a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do produto Windows, visite o site [Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) (em inglês). Para obter mais informações sobre o período de suporte estendido para atualização de segurança dessas versões de sistema operacional, visite o site [Atendimento Microsoft](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que precisarem de suporte adicional para o Windows NT Workstation 4.0 SP6a deverão entrar em contato com o representante da equipe da conta da Microsoft, o gerente técnico da conta ou o representante do parceiro Microsoft apropriado para obter opções de suporte personalizadas. Os clientes sem contrato Alliance, Premier ou Authorized podem entrar em contato com o escritório de vendas local da Microsoft. Para obter informações de contato, visite o site de [Informações Internacionais da Microsoft](http://go.microsoft.com/fwlink/?linkid=33329), selecione o país e clique em **Ir** para ver uma lista de telefones. Ao ligar, peça para falar com o gerente de vendas local de Suporte Premier.

Para obter mais informações, consulte o site [Perguntas mais freqüentes sobre o Sistema Operacional Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**Como o suporte estendido para Windows 98, Windows 98 Second Edition e Windows Millennium Edition afeta o lançamento das atualizações de segurança para estes sistemas operacionais?**  
A Microsoft lançará atualizações de segurança somente para problemas de segurança críticos. Os problemas de segurança não críticos não serão abordados neste período de suporte. Para obter mais informações sobre as diretivas do ciclo de vida do suporte da Microsoft para esses sistemas operacionais, visite este [site](http://support.microsoft.com/default.aspx?pr=lifean1) (em inglês).

Para obter mais informações sobre as classificações de gravidade, visite este [site](http://go.microsoft.com/fwlink/?linkid=21140) (em inglês).

**O Windows 98, o Windows 98 Second Edition ou o Windows Millennium Edition são afetados drasticamente por alguma vulnerabilidade apresentada neste boletim de segurança?**  
Não. No que diz respeito à gravidade, nenhuma dessas vulnerabilidades é crítica no Windows 98, no Windows 98 Second Edition, nem no Windows Millennium Edition.

**Posso usar o MBSA (Microsoft Baseline Security Analyzer) para determinar se esta atualização é necessária?**  
Sim. O MBSA determinará se a atualização é necessária. Para obter mais informações sobre o MBSA, visite o [site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134).

**Observação** Depois de 20 de abril de 2004, o arquivo Mssecure.xml usado pelo MBSA 1.1.1 e pelas as versões anteriores não foi mais atualizado com novos dados do boletim de segurança. Portanto, as verificações realizadas depois dessa data com o MBSA 1.1.1 ou uma versão anterior serão incompletas. Todos os usuários deverão atualizar para o MBSA 1.2 porque ele fornece uma detecção mais precisa da atualização de segurança e oferece suporte a produtos adicionais. Os usuários podem baixar o MBSA 1.2 do site do [MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Para obter mais informações sobre o suporte do MBSA, visite o site [Microsoft Baseline Security Analyzer](http://www.microsoft.com/technet/security/tools/mbsaqa.mspx)[1.2 Q&A](http://www.microsoft.com/technet/security/tools/mbsaqa.mspx)</a>.

**Posso usar o SMS (Systems Management Server) para determinar se esta atualização é necessária?**  
Sim. O SMS pode ajudar a detectar e implantar a atualização de segurança. Para obter mais informações sobre o SMS, visite o [site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

Detalhes da Vulnerabilidade
---------------------------

<span></span>
#### Vulnerabilidade no gerenciamento de janelas - CAN-2004-0207:

Existe uma vulnerabilidade de [elevação de privilégio](http://go.microsoft.com/fwlink/?linkid=21142) nas interfaces de programação de aplicativo (APIs) do gerenciamento de janelas. Essa vulnerabilidade poderá permitir que um usuário conectado assuma o controle total do sistema.

#### Fatores atenuantes da vulnerabilidade no gerenciamento de janelas - CAN-2004-0207:

O invasor deve ter credenciais de logon válidas e fazer logon localmente para explorar essa vulnerabilidade. Essa vulnerabilidade não pode ser explorada remotamente por usuários anônimos.

#### Soluções alternativas para a vulnerabilidade no gerenciamento de janelas - CAN-2004-0207:

Nada.

#### Perguntas mais freqüentes sobre a vulnerabilidade no gerenciamento de janelas - CAN-2004-0207:

**Qual é o escopo da vulnerabilidade?**  
Essa é uma vulnerabilidade de [elevação de privilégios locais](http://go.microsoft.com/fwlink/?linkid=21142). O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado, incluindo instalação de programas, exibição, alteração ou exclusão de dados ou criação de novas contas com privilégios totais.

**O que provoca a vulnerabilidade?**  
Várias funções de API de Gerenciamento do Windows permitem que os programas alterem as propriedades de outros programas que estejam sendo executados em um nível de privilégio mais elevado. Os programas devem ser limitados a alterar as propriedades de outros programas que estejam sendo executados no mesmo nível de privilégio. As propriedades do programa que está sendo executado em um nível de privilégio mais elevado podem ser alteradas de forma que a alteração cause uma elevação do privilégio do usuário conectado localmente.

**O que são as funções de interface de programação de aplicativo de Gerenciamento do Windows?**  
A interface gráfica do usuário (GUI) do Windows permite que os programas alterem várias propriedades que definem um programa, como o tamanho da janela ou o nome do mesmo. As funções de API de Gerenciamento do Windows são os componentes do sistema operacional que os programas usam para alterar essas propriedades. Para obter mais informações sobre os componentes usados para criar programas do Windows, consulte o [site MSDN](http://msdn2.microsoft.com/en-us/library/ms632587.aspx).

**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado.

**Quem pode explorar a vulnerabilidade?**  
Para explorar a vulnerabilidade, o invasor precisa fazer logon localmente no sistema e executar um programa.

**De que forma o invasor pode explorar a vulnerabilidade?**  
Para explorar essa vulnerabilidade, primeiro o invasor precisa fazer logon no sistema. Ele então precisa executar um aplicativo específico capaz de tentar explorar a vulnerabilidade e assim assumir o controle total do sistema afetado.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
Principalmente as estações de trabalho e os servidores de terminal estão correndo risco. Os servidores só correrão risco se usuários que não possuem credenciais administrativas suficientes puderem fazer logon nos servidores e executar programas. Entretanto, as práticas recomendadas não recomendam esse procedimento.

**O Windows 98, o Windows 98 Second Edition ou o Windows Millennium Edition são drasticamente afetados por esta vulnerabilidade?**  
Não. Embora o Windows 98, o Windows 98 Second Edition e o Windows Millennium Edition contenham o componente afetado, a vulnerabilidade não é crítica. Para obter mais informações sobre as classificações de gravidade, visite o [site](http://go.microsoft.com/fwlink/?linkid=21140) a seguir.

**A vulnerabilidade pode ser explorada pela Internet?**  
Não. O invasor precisa fazer logon no sistema específico que é alvo do ataque. O invasor não pode carregar e executar um programa remotamente usando essa vulnerabilidade.

**O que a atualização faz?**  
A atualização remove a vulnerabilidade impedindo que os programas alterem as propriedades de outros programas que estão sendo executados em um nível de privilégio diferente.

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Não. A Microsoft recebeu informações sobre essa vulnerabilidade por meio de divulgação responsável. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade havia sido divulgada publicamente quando este boletim de segurança foi lançado pela primeira vez.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade havia sido usada publicamente para atacar clientes e não teve conhecimento de nenhum fato que comprovasse a publicação do código quando este boletim de segurança foi originalmente lançado

#### Vulnerabilidade na máquina virtual de DOS - CAN-2004-0208:

Existe uma vulnerabilidade de [elevação de privilégio local](http://go.microsoft.com/fwlink/?linkid=21142) no componente do sistema operacional que lida com o subsistema da VDM (Máquina virtual de DOS). Essa vulnerabilidade poderá permitir que um usuário conectado assuma o controle total do sistema.

#### Fatores atenuantes da vulnerabilidade na máquina virtual de DOS - CAN-2004-0208:

-   O invasor precisa ter credenciais de logon válidas e poder fazer logon localmente para explorar essa vulnerabilidade. Essa vulnerabilidade não pode ser explorada remotamente por usuários anônimos.
-   O Windows XP Service Pack 2 não é afetado por essa vulnerabilidade.

#### Soluções alternativas para a vulnerabilidade na máquina virtual de DOS - CAN-2004-0208:

Nada.

#### Perguntas mais freqüentes sobre a vulnerabilidade na máquina virtual de DOS - CAN-2004-0208:

**Qual é o escopo da vulnerabilidade?**  
Essa é uma vulnerabilidade de [elevação de privilégios](http://go.microsoft.com/fwlink/?linkid=21142). O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado, incluindo instalação de programas, exibição, alteração ou exclusão de dados ou criação de novas contas com privilégios totais. Para explorar a vulnerabilidade, o invasor precisa fazer logon localmente no sistema e executar um programa.

**O que provoca a vulnerabilidade?**  
O componente do sistema operacional que lida com o subsistema da máquina virtual de DOS (VDM) pode ser usado para acessar a memória kernel protegida. Em certas circunstâncias, algumas funções privilegiadas do sistema operacional podem não validar as estruturas do sistema e podem permitir que o invasor execute um programa especialmente criado com privilégios de sistema.

**O que é o subsistema da máquina virtual de DOS?**  
Um subsistema de máquina virtual de DOS (VDM) é um ambiente que emula o sistema operacional MS-DOS e o sistema operacional Windows baseado em MS-DOS em sistemas operacionais baseados em Windows NT. A VDM é criada sempre que o usuário inicia um aplicativo do MS-DOS em um sistema operacional Windows NT.

**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado, incluindo instalação de programas, exibição, alteração ou exclusão de dados ou criação de novas contas com privilégios totais.

**Quem pode explorar a vulnerabilidade?**  
Para explorar a vulnerabilidade, o invasor precisa fazer logon localmente no sistema e executar um programa.

**De que forma o invasor pode explorar essa vulnerabilidade?**  
Para explorar essa vulnerabilidade, primeiro o invasor precisa fazer logon no sistema. Ele então precisa executar um programa específico capaz de explorar a vulnerabilidade e, assim, assumir o controle total do sistema afetado.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
Principalmente as estações de trabalho e os servidores de terminal estão correndo risco. Os servidores só correrão risco se usuários que não possuem credenciais administrativas suficientes puderem fazer logon nos servidores e executar programas. Entretanto, as práticas recomendadas não recomendam esse procedimento.

**A vulnerabilidade pode ser explorada pela Internet?**  
Não. O invasor precisa fazer logon no sistema alvo do ataque. O invasor não pode carregar e executar um programa remotamente usando essa vulnerabilidade.

**O que a atualização faz?**  
Essa atualização modifica o modo como o Windows valida os dados ao consultar as localizações de memória alocadas a uma VDM.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade havia sido usada publicamente para atacar clientes e não teve conhecimento de nenhum fato que comprovasse a publicação do código quando esse boletim de segurança foi originalmente lançado.

**Como essa vulnerabilidade está relacionada à vulnerabilidade na máquina virtual de DOS que é corrigida pelo MS04-011?**  
Ambas as vulnerabilidades eram na máquina virtual de DOS. Entretanto, esta atualização corrige uma nova vulnerabilidade que não foi eliminada como parte do MS04-011. O MS04-011 ajuda a proteger seu computador contra a vulnerabilidade apresentada nesse boletim, mas não elimina essa nova vulnerabilidade. Esta atualização não substitui o MS04-011. Você deve instalar esta atualização e a atualização fornecida no boletim de segurança MS04-011 para proteger o sistema contra as duas vulnerabilidades.

#### Vulnerabilidade no mecanismo de processamento de elementos gráficos - CAN-2004-0209:

Uma vulnerabilidade de execução remota de código no processamento de formatos de imagem WMF (Metarquivo do Windows) e EMF (Metarquivo Avançado) que pode permitir a execução remota de código em um sistema afetado. Qualquer programa que processa imagens WMF ou EMF nos sistemas afetados pode estar vulnerável a esse ataque. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado.

#### Fatores atenuantes da vulnerabilidade no mecanismo de processamento de elementos gráficos - CAN-2004-0209:

-   A vulnerabilidade pode ser explorada por um invasor que convença um usuário a abrir um arquivo específico ou a exibir uma pasta que contenha uma determinada imagem. Não há como um invasor forçar um usuário a abrir um arquivo mal-intencionado, exceto através da visualização de uma mensagem de email.
-   Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Não há como um invasor forçar usuários a visitar o site mal-intencionado. Em vez disso, o invasor terá que atraí-los para lá, fazendo com que cliquem em um link que leve para esse site.
-   O Windows XP Service Pack 2 não é afetado por essa vulnerabilidade.

#### Soluções alternativas para a vulnerabilidade no mecanismo de processamento de elementos gráficos - CAN-2004-0209:

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Quando uma solução alternativa reduz a funcionalidade, ela é identificada abaixo.

-   **Se você estiver usando o Outlook 2002 ou posterior ou o Outlook Express 6 SP1 ou posterior, leia as mensagens de email no formato de texto simples para ajudar a proteger-se do vetor de ataque de email em HTML**

    Os usuários do Microsoft Outlook 2002 que aplicaram o Office XP Service Pack 1 ou posterior e os usuários do Microsoft Outlook Express 6 que aplicaram o Internet Explorer 6 Service Pack 1 podem habilitar essa configuração e exibir todas as mensagens de email assinadas de forma não digital ou não criptografadas como texto sem formatação apenas.

    Mensagens de email assinadas digitalmente ou criptografadas não são afetadas por essa configuração e podem ser lidas em seus formatos originais. Para obter mais informações sobre como habilitar essa configuração no Outlook 2002, consulte o artigo [307594](http://support.microsoft.com/default.aspx?scid=kb;pt-br;307594) (em inglês) do Microsoft Knowledge Base.

    Para obter mais informações sobre essa configuração no Outlook Express 6, consulte o artigo [291387](http://support.microsoft.com/?kbid=291387) (em inglês) do Microsoft Knowledge Base.

    **Impacto da solução alternativa:** As mensagens de email exibidas em formato de texto sem formatação não conterão figuras, fontes específicas, animações nem outro conteúdo formatado. Além disso:

    -   As alterações são aplicadas ao painel de visualização e a mensagens abertas.
    -   As imagens passam a ser anexos para não serem perdidas.
        **Observação** A exibição manual dessas imagens poderá permitir a execução remota de código se você estiver usando um aplicativo ou sistema operacional vulnerável.
    -   Como a mensagem ainda será armazenada como Rich Text ou HTML, o modelo de objeto (soluções de código personalizado) pode comportar-se de maneira inesperada.

#### Perguntas mais freqüentes sobre a vulnerabilidade no mecanismo de processamento de elementos gráficos - CAN-2004-0209:

**Qual é o escopo da vulnerabilidade?**  
Essa é uma vulnerabilidade de execução remota de código. O invasor que explorar com êxito essa vulnerabilidade poderá assumir remotamente o controle total de um sistema afetado, incluindo instalação de programas, exibição, alteração ou exclusão de dados ou criação de novas contas com privilégios totais. Esta vulnerabilidade também pode ser usada na tentativa de realizar uma elevação de privilégio local ou uma negação de serviço remota.

**O que provoca a vulnerabilidade?**  
Um buffer não verificado na maneira como o mecanismo de processamento de elementos gráficos processa formatos de imagem WMF (Metarquivo do Windows) e EMF (Metarquivo Avançado).

**O que são formatos de imagem WMF (metarquivo do Windows) e EMF (metarquivo avançado)?**  
Uma imagem WMF é um formato de metarquivo de 16 bits que pode conter informações sobre vetores e bitmap. Ela é otimizada para o sistema operacional Windows. Uma imagem EMF é um metarquivo de 32 bits que pode conter informações sobre vetores e sobre bitmap. Esse formato é um aprimoramento do formato Metarquivo do Windows e contém mais recursos.

Para obter mais informações sobre os tipos e formatos de imagem, consulte o Artigo [320314](http://support.microsoft.com/default.aspx?scid=kb;en-us;320314) (em inglês) da Microsoft Knowledge Base. Informações adicionais sobre esses formatos de arquivo também estão disponíveis no [site da MSDN Library](http://msdn2.microsoft.com/en-us/library/ms534574.aspx) (em inglês).

**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado, incluindo instalação de programas, exibição, alteração ou exclusão de dados ou criação de novas contas com privilégios totais.

**De que forma o invasor pode explorar essa vulnerabilidade?**  
Qualquer programa que processa os tipos de imagem afetados pode estar vulnerável a esse ataque. Estes são alguns exemplos:

-   O invasor pode hospedar um site mal-intencionado criado para explorar essa vulnerabilidade através do Internet Explorer e, então, persuadir um usuário a exibir o site.
-   O invasor pode criar uma mensagem de email em HTML com uma imagem específica anexada. Essa imagem pode ser criada especialmente para explorar essa vulnerabilidade por meio do Microsoft Outlook ou do Outlook Express 6. O invasor pode persuadir o usuário a exibir a mensagem de email em HTML.
-   O invasor pode incorporar uma imagem específica a um documento do Office e então persuadir o usuário a exibir o documento.
-   Ele pode adicionar uma imagem específica ao sistema de arquivos local ou a um compartilhamento de rede e persuadir o usuário a visualizar a pasta.
-   Pode efetuar logon localmente no sistema. Ou então pode executar um programa específico capaz de explorar a vulnerabilidade e assim assumir o controle total do sistema afetado.

O invasor também poderá acessar o componente afetado por meio de outro vetor. Por exemplo, o invasor pode fazer logon no sistema de maneira interativa ou usar outro programa que transmite parâmetros ao componente vulnerável (local ou remotamente). Para explorar localmente essa vulnerabilidade, primeiro o invasor precisa fazer logon no sistema. Ele então precisa executar um programa específico capaz de explorar a vulnerabilidade e, assim, assumir o controle total do sistema afetado.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
A vulnerabilidade pode ser explorada nos sistemas afetados por um invasor que convença um usuário a abrir um arquivo específico ou a exibir uma pasta que contenha uma determinada imagem. Não há como um invasor forçar um usuário a abrir um arquivo específico, exceto através da visualização de uma mensagem de email.

Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Não há como um invasor forçar usuários a visitar o site mal-intencionado. Em vez disso, o invasor terá que atraí-los para lá, fazendo com que cliquem em um link que leve para esse site.

**A vulnerabilidade pode ser explorada pela Internet?**  
Sim. Um invasor pode tentar explorar essa vulnerabilidade através da Internet.

**O que a atualização faz?**  
A atualização remove a vulnerabilidade modificando a forma como o mecanismo de processamento de elementos gráficos processa formatos de imagem WMF (Metarquivo do Windows) e EMF (Metarquivo Avançado).

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Não. A Microsoft recebeu informações sobre essa vulnerabilidade por meio de divulgação responsável. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade havia sido divulgada publicamente quando este boletim de segurança foi lançado pela primeira vez.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade havia sido usada publicamente para atacar clientes e não teve conhecimento de nenhum fato que comprovasse a publicação do código quando esse boletim de segurança foi originalmente lançado.

**Como essa vulnerabilidade está relacionada à vulnerabilidade no metarquivo corrigida pelo boletim MS04-011?**  
Ambas as vulnerabilidades estão relacionadas ao processamento de formatos de imagem WMF e EMF. Entretanto, esta atualização corrige uma nova vulnerabilidade que não foi eliminada como parte do MS04-011. O MS04-011 ajuda a proteger seu computador contra a vulnerabilidade apresentada nesse boletim, mas não elimina essa nova vulnerabilidade. Esta atualização não substitui o boletim MS04-011. Você deve instalar esta atualização e a atualização fornecida no boletim de segurança MS04-011 para proteger o sistema contra as duas vulnerabilidades.

**Como essa vulnerabilidade está relacionada à vulnerabilidade no processamento do JPEG (GDI+) corrigida pelo MS04-028?**  
O componente afetado dessa vulnerabilidade é um componente de sistema operacional nativo e não é redistribuído. O componente afetado na vulnerabilidade de processamento de JPEG (GDI+), conforme discutido no boletim MS04-028, foi redistribuído por outros aplicativos e programas de terceiros. A instalação da atualização do sistema operacional ajudará a proteger, contra esta vulnerabilidade, todos os aplicativos que possam vir a ser vetores de ataque, os quais podem tentar explorar essa vulnerabilidade. O MS04-028 ajuda a proteger contra a vulnerabilidade discutida naquele boletim, mas não soluciona esta nova vulnerabilidade. Esta atualização não substitui o boletim MS04-028. Você deve instalar esta atualização e a atualização fornecida no boletim de segurança MS04-028 para proteger o sistema contra as duas vulnerabilidades.

#### Vulnerabilidade no kernel do Windows - CAN-2004-0211:

Existe uma vulnerabilidade de [negação de serviço local](http://go.microsoft.com/fwlink/?linkid=21142) no kernel do Windows. Um invasor pode executar um programa localmente que faça o sistema afetado parar de responder.

#### Fatores atenuantes da vulnerabilidade no kernel do Windows - CAN-2004-0211

-   A vulnerabilidade não permite que um invasor obtenha quaisquer privilégios em um sistema afetado. Este problema é simplesmente uma vulnerabilidade de negação de serviço.
-   O Windows NT 4.0, o Windows 2000 e o Windows XP não são afetados por essa vulnerabilidade.

#### Soluções alternativas para a vulnerabilidade no kernel do Windows - CAN-2004-0211:

Nada.

#### Perguntas mais freqüentes sobre a vulnerabilidade no kernel do Windows - CAN-2004-0211:

**Qual é o escopo da vulnerabilidade?**  
É uma vulnerabilidade de [negação de serviço](http://go.microsoft.com/fwlink/?linkid=21142). O invasor que explorar essa vulnerabilidade poderá fazer com que o sistema afetado pare de responder e reinicie automaticamente. Durante esse período, o servidor não poderá responder a solicitações.

**Observação** A vulnerabilidade de negação de serviço não permite que os invasores executem códigos nem elevem seus privilégios, mas pode fazer o sistema afetado parar de aceitar solicitações.

**O que provoca a vulnerabilidade?**  
O kernel do Windows não redefine corretamente alguns valores dentro de algumas estruturas de dados da CPU.

**O que é o kernel do Windows?**  
O kernel do Windows é o núcleo do sistema operacional. Ele fornece serviços no nível do sistema como gerenciamento de dispositivos e de memória, aloca tempo do processador para os processos e gerencia o tratamento de erros. Para obter mais informações sobre o kernel e outras estruturas do sistema operacional, visite o seguinte [site](http://www.microsoft.com/technet/prodtechnol/winntas/training/ntarchitectoview/ntarc_2.mspx).

**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar essa vulnerabilidade poderá fazer com que o sistema afetado pare de responder e reinicie automaticamente. Durante esse período, o servidor não poderá responder a solicitações.

**Quem pode explorar a vulnerabilidade?**  
Para explorar a vulnerabilidade, o invasor precisa fazer logon localmente no sistema e executar um programa.

**De que forma o invasor pode explorar a vulnerabilidade?**  
Para explorar essa vulnerabilidade, primeiro o invasor precisa fazer logon no sistema. Ele pode então executar um programa específico capaz de explorar a vulnerabilidade. Isso pode fazer o sistema parar de responder causando uma condição de negação de serviço.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
Principalmente os servidores de terminal estão correndo risco. Os servidores só correrão risco se usuários que não possuem credenciais administrativas suficientes puderem fazer logon nos servidores e executar programas. Entretanto, as práticas recomendadas não recomendam esse procedimento.

**A vulnerabilidade pode ser explorada pela Internet?**  
Não. O invasor precisa fazer logon no sistema alvo do ataque. O invasor não pode carregar e executar um programa remotamente usando essa vulnerabilidade.

**O que a atualização faz?**  
A atualização corrige a vulnerabilidade modificando a forma como o kernel do Windows redefine alguns valores em algumas estruturas de dados da CPU.

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Não. A Microsoft recebeu informações sobre essa vulnerabilidade por meio de divulgação responsável. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade havia sido divulgada publicamente quando este boletim de segurança foi lançado pela primeira vez.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade havia sido usada publicamente para atacar clientes e não teve conhecimento de nenhum fato que comprovasse a publicação do código quando esse boletim de segurança foi originalmente lançado.

Informações de atualização de segurança
---------------------------------------

<span></span>
**Plataformas de instalação e pré-requisitos:**

Para obter informações sobre uma atualização de segurança específica para sua plataforma, clique no link apropriado:

#### Windows Server 2003 (todas as versões)

**Pré-requisitos**
Esta atualização de segurança requer uma versão de lançamento do Windows Server 2003.

**Inclusão em Service Packs futuros**
A atualização para este problema será incluída no Windows Server 2003 Service Pack 1.

**Informações de instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

**/help                 **Exibe as opções de linha de comando

**Modos de instalação**

**/quiet  **            **  **Modo Silencioso (sem interação com o usuário ou exibição)

**/passive**            Modo Autônomo (apenas barra de progresso)

**      /uninstall**          Desinstala o pacote

**Opções de reinicialização**

**/norestart**          Não reinicia após a conclusão da instalação

**/forcerestart**      Reinicia após a instalação

**Opções especiais**

**/l**                        Lista hotfixes do Windows ou pacotes de atualização instalados

**/o**                       Sobrescreve os arquivos OEM sem notificação

**/n**                       Não faz backup de arquivos necessários à desinstalação

**/f**                        Força o encerramento de outros programas quando o computador é desligado

**/extract**             Extrai arquivos sem iniciar a instalação

**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte a opções de instalação que as versões anteriores do utilitário de instalação usam. Para obter mais informações sobre as opções de instalação com suporte, consulte o artigo [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841) (em inglês) do Microsoft Knowledge Base.

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, utilize o seguinte comando em um prompt de comando para o Windows Server 2003:

**Windowsserver2003-kb840987-x86-enu /passive /quiet**

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando para o Windows Server 2003:

**Windowsserver2003-kb840987-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com os serviços de atualização de software, visite o site [Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Necessidade de Reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB840987$\\Spuninst. O utilitário Spuninst.exe oferece suporte às seguintes opções de instalação:

**/?**: Mostra a lista de opções de instalação.

**/u**: usa o modo Autônomo.

**/f**: Força o encerramento de outros programas quando o computador é desligado.

**/z**: Não reinicia após a conclusão da instalação.

**/q**: Usa o modo Silencioso (sem interação com o usuário).

**Informações sobre o arquivo**

A versão em inglês desta atualização (ou a posterior) tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Windows Server 2003 Enterprise Edition, Windows Server 2003 Standard Edition, Windows Server 2003 Web Edition e Windows Server 2003 Datacenter Edition:

`Data         Hora   Versão       Tamanho       Nome do arquivo     Pasta-------------------------------------------------------------------------27 de maio de 2004  00:33  5.2.3790.175  2.405.888  Ntkrnlmp.exe  RTMGDR26 de maio de 2004  23:51  5.2.3790.175  2.063.360  Ntkrnlpa.exe  RTMGDR26 de maio de 2004  23:51  5.2.3790.175  2.105.856  Ntkrpamp.exe  RTMGDR27 de maio de 2004  00:35  5.2.3790.175  2.206.208  Ntoskrnl.exe  RTMGDR9 de agosto de 2004  22:48  5.2.3790.198  1.812.992  Win32k.sys    RTMGDR1 de junho de 2004  18:06  5.2.3790.177  2.407.424  Ntkrnlmp.exe  RTMQFE1 de junho de 2004  17:37  5.2.3790.177  2.064.384  Ntkrnlpa.exe  RTMQFE1 de junho de 2004  17:37  5.2.3790.177  2.108.928  Ntkrpamp.exe  RTMQFE1 de junho de 2004  18:13  5.2.3790.177  2.207.232  Ntoskrnl.exe  RTMQFE19 de agosto de 2004  21:53  5.2.3790.202  1.814.528  Win32k.sys    RTMQFE`

Windows Server 2003 64-Bit Enterprise Edition e Windows Server 2003 64-Bit Datacenter Edition:

`Data         Hora   Versão       Tamanho       Nome do arquivo    Plataforma  Pasta-------------------------------------------------------------------------10 de agosto de 2004  02:10  5.2.3790.198  4.952.576  Win32k.sys  IA-64     RTMGDR19 de agosto de 2004  21:44  5.2.3790.202  4.956.672  Win32k.sys  IA-64     RTMQFE`

**Observação** Quando você instala esta atualização de segurança no Windows Server 2003 ou no Windows XP 64-Bit Edition, Versão 2003, o instalador verifica se alguns dos arquivos que estão sendo atualizados no sistema foram anteriormente atualizados por um hotfix da Microsoft. Se você já instalou um hotfix para atualizar um desses arquivos, o instalador copiará os arquivos RTMQFE para o sistema. Caso contrário, o instalador copiará os arquivos RTMGDR para o sistema. Para obter mais informações, consulte o artigo [824994](http://support.microsoft.com/default.aspx?kbid=824994) (em inglês) do Microsoft Knowledge Base.

**Verificando a instalação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança está instalada em um sistema afetado, é possível utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (em inglês).

-   **Verificação de Versão do Arquivo**

    **Observação** Como existem diversas versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.

        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos talvez não estejam instalados.

    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.

        **Observação** Os atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Também é possível verificar os arquivos que esta atualização de segurança instalou analisando as seguintes chaves do Registro:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB840987\\Filelist

    **Observação** Essa chave do Registro pode não conter uma lista completa de arquivos instalados. Além disso, essa chave do Registro poderá não ser criada corretamente se um administrador ou um OEM integrar ou adicionar a atualização de segurança 840987 aos arquivos fonte da instalação do Windows.

#### Windows XP (todas as versões)

**Observação** Para o Windows XP 64-Bit Edition, Versão 2003, esta atualização de segurança é igual à atualização de segurança do Windows Server 2003 64-Bit Edition.

**Pré-requisitos**
Esta atualização de segurança requer a versão de lançamento do Windows XP ou do Windows XP Service Pack 1 (SP1). Para obter mais informações, consulte o artigo [322389](http://support.microsoft.com/default.aspx?scid=kb;en-us;322389) (site em inglês) do Microsoft Knowledge Base.

**Inclusão em Service Packs futuros**
A atualização para este problema será incluída no Windows XP Service Pack 2.

**Informações de instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

**/help                 **Exibe as opções de linha de comando

**Modos de instalação**

**/quiet  **            **  **Modo Silencioso (sem interação com o usuário ou exibição)

**/passive**            Modo Autônomo (apenas barra de progresso)

**      /uninstall**          Desinstala o pacote

**Opções de reinicialização**

**/norestart**          Não reinicia após a conclusão da instalação

**/forcerestart**      Reinicia após a instalação

**Opções especiais**

**/l**                        Lista hotfixes do Windows ou pacotes de atualização instalados

**/o**                       Sobrescreve os arquivos OEM sem notificação

**/n**                       Não faz backup de arquivos necessários à desinstalação

**/f**                        Força o encerramento de outros programas quando o computador é desligado

**/extract**             Extrai arquivos sem iniciar a instalação

**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte a opções de instalação que as versões anteriores do utilitário de instalação usam. Para obter mais informações sobre as opções de instalação com suporte, consulte o artigo [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841) (em inglês) do Microsoft Knowledge Base.

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, use o seguinte comando em um prompt de comando para o Windows XP:

**Windowsxp-kb840987-x86-enu /passive /quiet**

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando para o Windows XP:

**Windowsxp-kb840987-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com o Software Update Services, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Necessidade de Reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB840987$\\Spuninst. O utilitário Spuninst.exe oferece suporte às seguintes opções de instalação:

**/?**: Mostra a lista de opções de instalação.

**/u**: usa o modo Autônomo.

**/f**: Força o encerramento de outros programas quando o computador é desligado.

**/z**: Não reinicia após a conclusão da instalação.

**/q**: Usa o modo Silencioso (sem interação com o usuário).

**Informações sobre o arquivo**

A versão em inglês desta atualização (ou a posterior) tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Windows XP Home Edition, Windows XP Professional, Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP Tablet PC Edition e Windows XP Media Center Edition:

`Data         Hora   Versão        Tamanho       Nome do arquivo     Pasta-------------------------------------------------------------------17 de junho de 2004  17:55  5.1.2600.159      48.128  Basesrv.dll   RTMQFE17 de junho de 2004  17:55  5.1.2600.151     241.664  Gdi32.dll     RTMQFE17 de junho de 2004  17:55  5.1.2600.153     898.048  Kernel32.dll  RTMQFE30 de março de 2004  01:25  5.1.2600.132      36.864  Mf3216.dll    RTMQFE17 de junho de 2004  17:00  5.1.2600.160   1.849.856  Ntkrnlmp.exe  RTMQFE17 de junho de 2004  17:00  5.1.2600.160   1.903.872  Ntkrnlpa.exe  RTMQFE17 de junho de 2004  17:00  5.1.2600.160   1.877.504  Ntkrpamp.exe  RTMQFE17 de junho de 2004  17:00  5.1.2600.160   1.881.856  Ntoskrnl.exe  RTMQFE14 de junho de 2004  18:27  5.1.2600.157     395.264  Ntvdm.exe     RTMQFE17 de junho de 2004  17:55  5.1.2600.153      13.312  Ntvdmd.dll    RTMQFE17 de junho de 2004  17:55                 1.055.610  Sysmain.sdb   RTMQFE17 de junho de 2004  17:55  5.1.2600.152     528.896  User32.dll    RTMQFE17 de junho de 2004  17:55  5.1.2600.153      23.040  Vdmdbg.dll    RTMQFE4 de agosto de 2004  00:54  5.1.2600.166   1.648.384  Win32k.sys    RTMQFE17 de junho de 2004  17:55  5.1.2600.153     272.896  Winsrv.dll    RTMQFE5 de junho de 2004  02:21  5.1.2600.156     245.760  Wow32.dll     RTMQFE17 de junho de 2004  17:58  5.1.2600.1566     47.616  Basesrv.dll   SP1QFE17 de junho de 2004  17:58  5.1.2600.1561    257.536  Gdi32.dll     SP1QFE17 de junho de 2004  17:58  5.1.2600.1560    930.816  Kernel32.dll  SP1QFE17 de maio de 2004  22:48  3.10.0.103        92.224  Krnl386.exe   SP1QFE30 de março de 2004  01:48  5.1.2600.1331     36.864  Mf3216.dll    SP1QFE17 de maio de 2004  22:43                    33.840  Ntio.sys      SP1QFE17 de maio de 2004  22:43                    34.560  Ntio404.sys   SP1QFE17 de maio de 2004  22:43                    35.648  Ntio411.sys   SP1QFE17 de maio de 2004  22:43                    35.424  Ntio412.sys   SP1QFE17 de maio de 2004  22:43                    34.560  Ntio804.sys   SP1QFE17 de junho de 2004  08:02  5.1.2600.1568  1.899.008  Ntkrnlmp.exe  SP1QFE17 de junho de 2004  08:03  5.1.2600.1568  1.954.688  Ntkrnlpa.exe  SP1QFE17 de junho de 2004  08:03  5.1.2600.1568  1.926.656  Ntkrpamp.exe  SP1QFE17 de junho de 2004  17:22  5.1.2600.1568  2.051.584  Ntoskrnl.exe  SP1QFE12 de junho de 2004  01:14  5.1.2600.1564    396.288  Ntvdm.exe     SP1QFE17 de junho de 2004  17:58  5.1.2600.1560     13.312  Ntvdmd.dll    SP1QFE17 de junho de 2004  17:58  5.1.2600.1561    560.128  User32.dll    SP1QFE17 de junho de 2004  17:58  5.1.2600.1560     23.040  Vdmdbg.dll    SP1QFE5 de agosto de 2004  18:15  5.1.2600.1581  1.845.888  Win32k.sys    SP1QFE27 de maio de 2004  01:38  5.1.2600.1557    483.328  Winlogon.exe  SP1QFE17 de junho de 2004  17:58  5.1.2600.1561    276.992  Winsrv.dll    SP1QFE4 de junho de 2004  00:43  5.1.2600.1562    245.760  Wow32.dll     SP1QFE`

Windows XP 64-Bit Edition Service Pack 1:

`Data         Hora   Versão        Tamanho       Nome do arquivo    Plataforma  Pasta--------------------------------------------------------------------------------17 de junho de 2004  18:05  5.1.2600.1556    885.248  Gdi32.dll    IA-64     SP1QFE30 de março de 2004  01:45  5.1.2600.1331    128.512  Mf3216.dll   IA-64     SP1QFE17 de junho de 2004  18:05  5.1.2600.1557  1.483.264  User32.dll   IA-64     SP1QFE17 de junho de 2004  00:45  5.1.2600.1567  5.627.520  Win32k.sys   IA-64     SP1QFE5 de agosto de 2004  17:27  5.1.2600.1581  5.629.952  Win32k.sys   IA-64     SP1QFE17 de junho de 2004  17:58  5.1.2600.1561    237.568  Wgdi32.dll   x86       SP1QFE\WOW30 de março de 2004  01:48  5.1.2600.1331     36.864  Wmf3216.dll  x86       SP1QFE\WOW17 de junho de 2004  17:58  5.1.2600.1561    556.544  Wuser32.dll  x86       SP1QFE\WOW`

Windows XP 64-Bit Edition Versão 2003:

`Data         Hora   Versão       Tamanho       Nome do arquivo    Plataforma  Pasta-------------------------------------------------------------------------10 de agosto de 2004  02:10  5.2.3790.198  4.952.576  Win32k.sys  IA-64     RTMGDR19 de agosto de 2004  21:44  5.2.3790.202  4.956.672  Win32k.sys  IA-64     RTMQFE`

**Observações** As versões do Windows XP e do Windows XP 64-Bit Edition Versão 2003 desta atualização de segurança estão em pacotes de modo duplo, que contêm arquivos para a versão original do Windows XP e para o Windows XP Service Pack 1 (SP1). Para obter mais informações sobre pacotes de modo duplo, consulte o artigo [328848](http://support.microsoft.com/default.aspx?kbid=328848) do Microsoft Knowledge Base.

Quando você instala a atualização de segurança do Windows XP 64-Bit Edition Versão 2003, o instalador verifica se alguns dos arquivos que estão sendo atualizados em seu sistema foram anteriormente atualizados por um hotfix da Microsoft. Se você já instalou um hotfix para atualizar um desses arquivos, o instalador copiará os arquivos RTMQFE para o sistema. Caso contrário, o instalador copiará os arquivos RTMGDR para o sistema. Para obter mais informações, consulte o artigo [824994](http://support.microsoft.com/default.aspx?kbid=824994) (em inglês) do Microsoft Knowledge Base.

**Verificando a instalação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança está instalada em um sistema afetado, é possível utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (em inglês).

-   **Verificação de Versão do Arquivo**

    **Observação** Como existem diversas versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.

        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos talvez não estejam instalados.

    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.

        **Observação** Os atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Também é possível verificar os arquivos que esta atualização de segurança instalou analisando as seguintes chaves do Registro:

    Para Windows XP Home Edition, Windows XP Professional, Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP 64-Bit Edition Service Pack 1, Windows XP Tablet PC Edition e Windows XP Media Center Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP2\\KB840987\\Filelist

    Para Windows XP 64-Bit Edition Versão 2003:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB840987\\Filelist

    **Observação** Talvez essas chaves do Registro não contenham uma lista completa dos arquivos instalados. Além disso, talvez essas chaves do Registro não sejam criadas corretamente se um administrador ou um OEM integrar ou adicionar a atualização de segurança 840987 aos arquivos fonte da instalação do Windows.

#### Windows 2000 (todas as versões)

**Pré-requisitos**
Para o Windows 2000, essa atualização de segurança requer Service Pack 3 (SP3) ou Service Pack 4 (SP4).

Os softwares relacionados foram testados para determinar se suas versões são afetadas. Outras versões já não incluem suporte para a atualização de segurança ou podem não ser afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o site Ciclo de Vida do Suporte Microsoft.

Para obter mais informações sobre como obter o service pack mais recente, consulte o artigo [260910](http://support.microsoft.com/default.aspx?scid=kb;en-us;260910) (em inglês) do Microsoft Knowledge Base.

**Inclusão em Service Packs futuros**
A atualização para esse problema será incluída no Windows 2000 Service Pack 5.

**Informações de instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

**/help                 **Exibe as opções de linha de comando

**Modos de instalação**

**/quiet  **            **  **Modo Silencioso (sem interação com o usuário ou exibição)

**/passive**            Modo Autônomo (apenas barra de progresso)

**      /uninstall**          Desinstala o pacote

**Opções de reinicialização**

**/norestart**          Não reinicia após a conclusão da instalação

**/forcerestart**      Reinicia após a instalação

**Opções especiais**

**/l**                        Lista hotfixes do Windows ou pacotes de atualização instalados

**/o**                       Sobrescreve os arquivos OEM sem notificação

**/n**                       Não faz backup de arquivos necessários à desinstalação

**/f**                        Força o encerramento de outros programas quando o computador é desligado

**/extract**             Extrai arquivos sem iniciar a instalação

**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte a opções de instalação que as versões anteriores do utilitário de instalação usam. Para obter mais informações sobre as opções de instalação com suporte, consulte o artigo [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841) (em inglês) do Microsoft Knowledge Base.

**Informações de implantação**

Para instalar a atualização de segurança sem qualquer intervenção do usuário, utilize o comando a seguir em um prompt de comando para o Windows 2000 Service Pack 3 e Windows 2000 Service Pack 4:

**Windows2000-kb840987-x86-enu /passive /quiet**

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o comando a seguir no prompt de comando para Windows 2000 Service Pack 3 e Windows 2000 Service Pack 4:

**Windows2000-kb840987-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com o Software Update Services, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Necessidade de Reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB840987$\\Spuninst. O utilitário Spuninst.exe oferece suporte às seguintes opções de instalação:

**/?**: Mostra a lista de opções de instalação.

**/u**: usa o modo Autônomo.

**/f**: Força o encerramento de outros programas quando o computador é desligado.

**/z**: Não reinicia após a conclusão da instalação.

**/q**: Usa o modo Silencioso (sem interação com o usuário).

**Informações sobre o arquivo**

A versão em inglês desta atualização (ou a posterior) tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

**Observação** As informações de data, hora, tamanho ou nome do arquivo podem ser alteradas durante a instalação. Consulte a seção Verificando a Instalação da Atualização para obter detalhes sobre como verificar uma instalação.

Windows 2000 Service Pack 3 e Windows 2000 Service Pack 4:

`Data         Hora   Versão         Tamanho      Nome do arquivo       Pasta---------------------------------------------------------------------17 de junho de 2004  23:05  5.0.2195.6951     46.352  Basesrv.dll21 de setembro de 2003  00:45  5.0.2195.6824    236.304  Cmd.exe17 de junho de 2004  23:05  5.0.2195.6945    231.184  Gdi32.dll17 de junho de 2004  23:05  5.0.2195.6946    712.464  Kernel32.dll19 de junho de 2003  20:05  3.10.0.103        92.032  Krnl386.exe17 de junho de 2004  23:05  5.0.2195.6898     37.136  Mf3216.dll10 de fevereiro de 2004  19:47  5.0.2195.6897     30.160  Mountmgr.sys17 de junho de 2004  23:05  5.0.2195.6824     54.544  Mpr.dll17 de junho de 2004  23:05  5.0.2195.6928    335.120  Msgina.dll19 de junho de 2003  20:05                    33.824  Ntio.sys19 de junho de 2003  20:05                    34.544  Ntio404.sys19 de junho de 2003  20:05                    35.648  Ntio411.sys19 de junho de 2003  20:05                    35.408  Ntio412.sys19 de junho de 2003  20:05                    34.544  Ntio804.sys17 de junho de 2004  17:15  5.0.2195.6952  1.704.128  Ntkrnlmp.exe17 de junho de 2004  17:15  5.0.2195.6952  1.703.744  Ntkrnlpa.exe17 de junho de 2004  17:15  5.0.2195.6952  1.725.440  Ntkrpamp.exe17 de junho de 2004  17:14  5.0.2195.6952  1.680.960  Ntoskrnl.exe27 de maio de 2004  00:54  5.0.2195.6946    398.096  Ntvdm.exe17 de junho de 2004  23:05  5.0.2195.6946     14.096  Ntvdmd.dll24 de março de 2004  02:17  5.0.2195.6892     90.264  Rdpwd.sys16 de maio de 2004  19:43  5.0.2195.6928  5.873.664  Sp3res.dll24 de março de 2004  02:17  5.0.2195.6897    403.216  User32.dll5 de agosto de 2003  22:14  5.0.2195.6794    385.808  Userenv.dll17 de junho de 2004  23:05  5.0.2195.6946     29.456  Vdmdbg.dll10 de agosto de 2004  03:51  5.0.2195.6966  1.632.624  Win32k.sys24 de agosto de 2004  22:59  5.0.2195.6970    182.544  Winlogon.exe17 de junho de 2004  23:05  5.0.2195.6946    244.496  Winsrv.dll17 de junho de 2004  23:05  5.0.2195.6946    239.888  Wow32.dll17 de junho de 2004  23:05  5.0.2195.6946    712.464  Kernel32.dll  Uniproc10 de agosto de 2004  03:51  5.0.2195.6966  1.632.624  Win32k.sys    Uniproc17 de junho de 2004  23:05  5.0.2195.6946    244.496  Winsrv.dll    Uniproc`

**Verificando a instalação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança está instalada em um sistema afetado, é possível utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (em inglês).

-   **Verificação de Versão do Arquivo**

    **Observação** Como existem diversas versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.

        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos talvez não estejam instalados.

    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.

        **Observação** Os atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Também é possível verificar os arquivos instalados por esta atualização de segurança analisando a seguinte chave do Registro:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB840987\\Filelist

    **Observação** Essa chave do Registro pode não conter uma lista completa de arquivos instalados. Além disso, essa chave do Registro talvez não seja criada corretamente quando um administrador ou um OEM integrar ou adicionar a atualização de segurança 840987 aos arquivos fonte da instalação do Windows.

#### Windows NT 4.0 (todas as versões)

**Pré-requisitos**
Esta atualização de segurança requer o Windows NT Server 4.0 Service Pack 6a (SP6a) ou Windows NT Server 4.0 Terminal Server Edition Service Pack 6 (SP6).

**Observação:** O Artigo [840987](http://support.microsoft.com/default.aspx?scid=kb;en-us;840987) (em inglês) da Microsoft Knowledge Base documenta os problemas atualmente conhecidos que os usuários poderão enfrentar ao instalar essa atualização de segurança nos sistemas Windows NT 4.0 Server e Windows NT 4.0 Terminal Server Edition. Se instalar atualizações de software em um computador executando Windows NT 4.0, cuja partição de sistema é maior que 7,8 GB, o computador poderá não reiniciar corretamente. O artigo também documenta as soluções recomendadas para esses problemas. Para obter mais informações, consulte o artigo [840987](http://support.microsoft.com/default.aspx?scid=kb;en-us;840987) (em inglês) do Microsoft Knowledge Base.

Os softwares relacionados foram testados para determinar se suas versões são afetadas. Outras versões já não incluem suporte para a atualização de segurança ou podem não ser afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o site [Ciclo de Vida do Suporte Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

Para obter mais informações sobre como conseguir o service pack mais recente, consulte o artigo [152734](http://support.microsoft.com/default.aspx?scid=kb;en-us;152734) (em inglês) do Microsoft Knowledge Base.

**Informações de instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

**   /y:** executa a remoção (somente com **/m** ou **/q**).

**   /f:** força os programas a parar durante o processo de encerramento.

**   /n:** não cria uma pasta de Desinstalação.

**   /z:** não reinicia quando a atualização é concluída.

**   /q:** usa o modo Silencioso ou Autônomo sem interface do usuário (essa opção é um superconjunto de **/m**).

**   /m:** usa o modo Autônomo com uma interface do usuário.

**   /l:** relaciona os hotfixes instalados.

**   /x:** extrai os arquivos sem executar a instalação.

**Observação** É possível combinar essas opções em uma única linha de comando. Para obter mais informações sobre as opções de instalação com suporte, consulte o artigo [262841](http://support.microsoft.com/default.aspx?scid=kb;en-us;262841) (em inglês) do Microsoft Knowledge Base.

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, use o seguinte comando em um prompt de comando para o Windows NT Server 4.0:

**Windowsnt4server-kb840987-x86-enu /q**

Para o Windows NT Server 4.0 Terminal Server Edition:

**Windowsnt4terminalserver-kb840987-x86-enu /q**

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando para o Windows NT Server 4.0:

**Windowsnt4server-kb840987-x86-enu /z**

Para o Windows NT Server 4.0 Terminal Server Edition:

**Windowsnt4terminalserver-kb840987-x86-enu /z**

Para obter informações sobre como implantar esta atualização de segurança com o Software Update Services, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125).

**Necessidade de Reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Para remover essa atualização de segurança, use a ferramenta Adicionar ou Remover Programas, no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Hotfix.exe para remover essa atualização de segurança. O utilitário Hotfix.exe está localizado na pasta %Windir%\\$NTUninstallKB840987$. O utilitário Hotfix.exe oferece suporte às seguintes opções de instalação:

**/y:** executa a remoção (somente com a opção **/m** ou **/q**).

**/f:** força os programas a parar durante o processo de encerramento.

**/n:** não cria uma pasta de Desinstalação.

**/z:** não reinicia após a conclusão da instalação.

**/q:** usa o modo Silencioso ou Autônomo sem interface do usuário (essa opção é um superconjunto da opção **/m**).

**/m:** usa o modo Autônomo com uma interface do usuário.

**/l:** relaciona os hotfixes instalados.

**Informações sobre o arquivo**

A versão em inglês desta atualização (ou a posterior) tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

**Observação** As informações de data, hora, tamanho ou nome do arquivo podem ser alteradas durante a instalação. Consulte a seção Verificando a Instalação da Atualização para obter detalhes sobre como verificar uma instalação.

Windows NT Server 4.0:

`Data         Hora   Versão        Tamanho       Nome de arquivo----------------------------------------------------------8 de junho de 2004  14:19  4.0.1381.7270    206.096  Gdi32.dll23 de fevereiro de 2004  15:13  4.0.1381.7263     40.720  Mf3216.dll22 de abril de 2004  17:26  4.0.1381.7267    958.464  Ntkrnlmp.exe22 de abril de 2004  17:26  4.0.1381.7267    938.048  Ntoskrnl.exe8 de junho de 2004  14:19  4.0.1381.7273    326.928  User32.dll3 de agosto de 2004  12:31  4.0.1381.7292  1.255.472  Win32k.sys8 de junho de 2004  14:19  4.0.1381.7260    174.864  Winsrv.dll`

Windows NT Server 4.0 Terminal Server Edition:

`Data         Hora   Versão         Tamanho       Nome do arquivo-------------------------------------------------------20 de maio de 2004  18:23  4.0.1381.33566    206.096  Gdi32.dll24 de fevereiro de 2004  18:25  4.0.1381.33562     40.208  Mf3216.dll21 de maio de 2004  16:41  4.0.1381.33568  1.004.160  Ntkrnlmp.exe21 de maio de 2004  16:41  4.0.1381.33568    983.104  Ntoskrnl.exe20 de maio de 2004  18:23  4.0.1381.33552    332.048  User32.dll3 de agosto de 2004  12:41  4.0.1381.33580  1.280.944  Win32k.sys20 de maio de 2004  18:23  4.0.1381.33559    196.368  Winsrv.dll`

**Verificando a instalação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança está instalada em um sistema afetado, é possível utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (em inglês).

-   **Verificação de Versão do Arquivo**

    **Observação** Como existem diversas versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.

        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos talvez não estejam instalados.

    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.

        **Observação** Os atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Também é possível verificar os arquivos instalados por esta atualização de segurança analisando a seguinte chave do Registro:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Hotfix\\KB840987\\File 1

    **Observação** Essa chave do Registro pode não conter uma lista completa de arquivos instalados. Além disso, essa chave do Registro talvez não seja criada corretamente quando um administrador ou um OEM integrar ou adicionar a atualização de segurança 840987 aos arquivos fonte da instalação do Windows.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) à pessoa citada abaixo por trabalhar conosco para ajudar a proteger os clientes:

-   Brett Moore da [Security-Assessment.com](http://www.security-assessment.com/) por relatar a vulnerabilidade no gerenciamento de janelas (CAN-2004-0207).
-   [eEye Digital Security](http://www.eeye.com/html/) por relatar a vulnerabilidade na máquina virtual de DOS (CAN-2004-0208).
-   [Patrick Porlan](https://technet.microsoft.com/pt-BR/mailto://porlan@free.fr) trabalhando com Mark Russinovich da [Winternals Software](http://www.winternals.com) por relatar a vulnerabilidade no mecanismo de processamento de elementos gráficos (CAN-2004-0209).
-   [hlt](https://technet.microsoft.com/pt-BR/mailto://hlt@dgap.mipt.ru) por relatar a vulnerabilidade no kernel do Windows (CAN-2004-0211).

**Obtendo Outras Atualizações de Segurança:**

As atualizações para outros problemas de segurança estão disponíveis nos seguintes locais:

-   As atualizações de segurança estão disponíveis no [Centro de Download da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). você poderá encontrá-las com mais facilidade, executando uma pesquisa com a palavra-chave "patch\_de\_segurança".
-   Atualizações para plataformas do cliente estão disponíveis no site do [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130).

**Suporte:**

-   Os clientes nos EUA e Canadá podem receber suporte técnico dos [Serviços de suporte ao produto Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) pelo telefone 1-866-PCSAFETY. As ligações para obter suporte associado a atualizações de segurança são gratuitas.
-   Os clientes de outros países podem obter suporte nas subsidiárias locais da Microsoft. O suporte associado a atualizações de segurança é gratuito. Para obter mais informações sobre como entrar em contato com a Microsoft a fim de obter suporte a problemas, visite o [site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de segurança:**

-   O site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos da Microsoft.
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   Catálogo do Windows Update: Para obter mais informações sobre o Catálogo do Windows Update, consulte o Artigo [323166](http://support.microsoft.com/default.aspx?scid=kb;en-us;323166) (em inglês) da Microsoft Knowledge Base.
-   [Atualização do Office](http://go.microsoft.com/fwlink/?linkid=21135)

**Serviços de Atualização de Software:**

Usando o Microsoft Software Update Services (SUS), os administradores podem implantar de maneira rápida e confiável as últimas atualizações críticas e de segurança em servidores que executem o Windows 2000 e o Windows Server 2003 e em sistemas desktop que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter informações sobre como implantar esta atualização de segurança com o Software Update Services, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Systems Management Server:**

O SMS (Microsoft Systems Management Server) fornece uma solução corporativa altamente configurável para gerenciar atualizações. Ao usar o SMS, os administradores podem identificar os sistemas baseados no Windows que precisam de atualizações de segurança, bem como executar a implantação controlada dessas atualizações em toda a empresa com o mínimo de interrupção para os usuários. Para obter mais informações sobre como os administradores podem usar o SMS 2003 para implantar atualizações de segurança, consulte o site de [Gerenciamento de Patches de Segurança do SMS 2003](http://www.microsoft.com/smserver/evaluation/capabilities/patch.mspx). Os usuários do SMS 2.0 também podem usar o [Software Updates Service Feature Pack](http://www.microsoft.com/smserver/downloads/20/featurepacks/suspack/) (site em inglês) para ajudar a implantar atualizações de segurança. Para obter mais informações sobre o SMS, visite o [site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

**Observação** O SMS usa o Microsoft Baseline Security Analyzer e a ferramenta de detecção do Microsoft Office para fornecer amplo suporte à detecção e à implantação de atualizações do boletim de segurança. Algumas atualizações de software podem não ser detectadas por essas ferramentas. Os administradores podem usar os recursos de inventário do SMS nesses casos para apontar as atualizações de sistemas específicos. Para obter mais informações sobre esse procedimento, consulte o seguinte [site](http://www.microsoft.com/technet/prodtechnol/sms/sms2003/patchupdate.mspx). Algumas atualizações de segurança exigirão direitos administrativos quando o sistema for reiniciado. Os administradores podem usar a Elevated Rights Deployment Tool (disponível no [**SMS 2003 Administration Feature Pack**](http://www.microsoft.com/technet/sms/2003/downloads/featurepacks/adminpack.mspx) e no [**SMS 2.0 Administration Feature Pack**](http://www.microsoft.com/smserver/downloads/20/featurepacks/adminpack/)) (sites em inglês) para instalar essas atualizações.

**Aviso de isenção de responsabilidade:**

As informações fornecidas na Microsoft Knowledge Base são apresentadas "no estado em que se encontram", sem garantia de qualquer tipo. A Microsoft se isenta de todas as garantias, expressas ou implícitas, inclusive as garantias de comercialização e adequação a um propósito específico. Em hipótese alguma a Microsoft Corporation ou seus fornecedores serão responsáveis por quaisquer danos, inclusive danos diretos, indiretos, incidentais, conseqüenciais, danos por lucros cessantes ou danos especiais, mesmo que a Microsoft Corporation ou seus fornecedores tenham sido alertados da possibilidade dos referidos danos. Como alguns estados não permitem a exclusão ou limitação de responsabilidade por danos conseqüenciais ou indiretos, a limitação acima pode não ser aplicável a você.

**Revisões:**

-   V1.0 (12 de outubro de 2004): Boletim publicado
-   V1.1 (9 de dezembro de 2008): Boletim atualizado para adicionar uma entrada na seção **Perguntas freqüentes relacionadas a esta atualização de segurança** sobre a remoção do pacote Windows Server 2003. Os clientes que já aplicaram com êxito esta atualização não precisam realizar nenhuma ação.

*Built at 2014-04-18T01:50:00Z-07:00*
