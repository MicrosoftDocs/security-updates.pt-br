---
TOCTitle: 'MS05-053'
Title: 'Microsoft  MS05-053 - Crítica'
ms:assetid: 'ms05-053'
ms:contentKeyID: 61233517
ms:mtpsurl: 'https://technet.microsoft.com/pt-BR/library/ms05-053(v=Security.10)'
---



Microsoft  MS05-053 - Crítica
==============================================

Vulnerabilidades no mecanismo de processamento de elementos gráficos pode permitir a execução remota de código (896424)
-----------------------------------------------------------------------------------------------------------------------

Publicado: terça-feira, 8 de novembro de 2005 | Atualizado: terça-feira, 9 de dezembro de 2008
  
**Versão:** 1.2

#### Resumo

**Quem deve ler este documento:** Clientes que usam o Microsoft Windows

**Impacto da vulnerabilidade:** Execução Remota de Código

**Classificação máxima de gravidade:** Crítica

**Recomendação:** Os clientes devem aplicar a atualização imediatamente.

**Substituição da atualização de segurança:** Este boletim substitui muitas atualizações de segurança anteriores. Veja a lista completa na seção Perguntas freqüentes deste boletim.

**Advertências:** Nenhuma

**Locais de softwares testados e de download de atualização de segurança:**

**Softwares afetados:**

-   Microsoft Windows 2000 Service Pack 4 - [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=f361fccb-b273-47e7-bb15-bc9c27073446)
-   Microsoft Windows XP Service Pack 1 e Microsoft Windows XP Service Pack 2 – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=e38372b2-3bf6-4393-b9a4-f34248c8073e)
-   Microsoft Windows XP Professional x64 Edition – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=086c6878-916c-4a4f-8ca8-a4c0e304fda4)
-   Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1 – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=cee3dd3b-3c20-47a9-8bbd-1ea2fbb4af96)
-   Microsoft Windows Server 2003 para sistemas baseados no Itanium e Microsoft Windows Server 2003 com SP1 para sistemas baseados no Itanium – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=ccff22bb-adc4-4974-813c-7721bdb842c0)
-   Microsoft Windows Server 2003 x64 Edition - [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=f1adb6e4-0a08-496c-b94c-a1b37178914a)

**Softwares não afetados:**

-   Microsoft Windows 98, Microsoft Windows 98 Second Edition (SE) e Microsoft Windows Millennium Edition (ME)

Os softwares dessa lista foram testados para se determinar se as versões são afetadas. Outras versões já não incluem suporte para a atualização de segurança ou podem não ser afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o [site do Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742).

### Informações Gerais

Sinopse
-------

<span></span>
**Sinopse:**

Esta atualização elimina várias vulnerabilidades públicas descobertas recentemente e reportadas em particular. Cada vulnerabilidade está documentada neste boletim em sua própria seção "Detalhes da vulnerabilidade".

Um invasor que explorar com êxito a mais grave dessas vulnerabilidades poderá obter o controle total de um sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário.

Recomendamos que os clientes apliquem a atualização imediatamente.

**Classificação de Gravidade e Identificadores de Vulnerabilidade:**

| Identificadores de Vulnerabilidade                                                                                                                     | Impacto da Vulnerabilidade | Windows 2000 (site em inglês) | Windows XP Service Pack 1 | Windows XP Service Pack 2 | Windows Server 2003 | Windows Server 2003 Service Pack 1 |
|--------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|-------------------------------|---------------------------|---------------------------|---------------------|------------------------------------|
| Vulnerabilidade no mecanismo de processamento de elementos gráficos - [CAN-2005-2123](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2005-2123) | Execução Remota de Código  | Crítica                       | Crítica                   | Crítica                   | Crítica             | Crítica                            |
| Vulnerabilidade de metarquivo do Windows - [CAN-2005-2124](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2005-2124)                            | Execução Remota de Código  | Crítica                       | Crítica                   | Nenhuma                   | Crítica             | Nenhuma                            |
| Vulnerabilidade de metarquivo avançado - [CAN-2005-0803](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=can-2005-0803)                              | Negação de Serviço         | Moderada                      | Moderada                  | Nenhuma                   | Moderada            | Nenhuma                            |
| **Gravidade Agregada de Todas as Vulnerabilidades**                                                                                                    |                            | **Crítica**                   | **Crítica**               | **Crítica**               | **Crítica**         | **Crítica**                        |

Essa [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas afetados pela vulnerabilidade, seus padrões comuns de implantação e o efeito da exploração da vulnerabilidade sobre eles.

**Observação** As classificações de gravidade das versões de sistema operacional não x86 mapeiam para as versões de sistemas operacionais x86 da seguinte forma:

-   A classificação de gravidade do Microsoft Windows XP Professional x64 Edition é a mesma do Windows Server 2003 Service Pack 1.
-   A classificação de gravidade do Microsoft Windows Server 2003 para sistemas baseados no Itanium é a mesma do Windows Server 2003.
-   A classificação de gravidade do Microsoft Windows Server 2003 com SP1 para sistemas baseados no Itanium é a mesma do Windows Server 2003 Service Pack 1.
-   A classificação de gravidade do Microsoft Windows Server 2003 x64 Edition é a mesma do Windows Server 2003 Service Pack 1.

Perguntas freqüentes relacionadas a esta atualização de segurança
-----------------------------------------------------------------

<span></span>
**Por que este boletim foi revisado em 9 de dezembro de 2008?**  
Este boletim foi revisado para comunicar a disponibilidade de uma versão atualizada do pacote de atualização do Windows Server 2003. A atualização foi revisada para abordar problemas menores não relacionados à estabilidade da atualização nem à segurança dos sistemas de destino pretendidos. Os clientes que já aplicaram com êxito esta atualização não precisam realizar nenhuma ação. Os clientes do Windows Server 2003 que nunca instalaram a atualização anterior agora terão a atualização revisada. A aplicabilidade deste boletim em outros sistemas operacionais Windows não mudou.

**Por que esta atualização elimina várias vulnerabilidades de segurança reportadas?**  
Esta atualização contém suporte para diversas vulnerabilidades porque as modificações necessárias para corrigir esses problemas foram feitas em arquivos relacionados. Em vez de instalar várias atualizações quase iguais, os clientes poderão instalar apenas esta atualização.

**Quais atualizações esta versão substitui?**  
Esta atualização de segurança substitui várias atualizações de segurança anteriores. As identificações de boletim de segurança e os sistemas operacionais afetados estão relacionados na tabela a seguir.

| ID do Boletim | Windows 2000 (site em inglês) | Windows XP Service Pack 1 | Windows XP Service Pack 2 | Windows Server 2003 | Windows Server 2003 Service Pack 1 |
|---------------|-------------------------------|---------------------------|---------------------------|---------------------|------------------------------------|
| **MS03-045**  | Não substituído               | Substituído               | Não Aplicável             | Não substituído     | Não Aplicável                      |
| **MS05-002**  | Não substituído               | Substituído               | Não Aplicável             | Não substituído     | Não Aplicável                      |

**O suporte estendido para a atualização de segurança do Microsoft Windows NT Workstation 4.0 Service Pack 6a e do Windows 2000 Service Pack 2 foi encerrado em 30 de junho de 2004. O suporte estendido para a atualização de segurança do Microsoft Windows NT Server 4.0 Service Pack 6a foi encerrado em 31 de dezembro de 2004. O suporte estendido para a atualização de segurança do Microsoft Windows 2000 Service Pack 3 foi encerrado em 30 de junho de 2005. Ainda estou usando um desses sistemas operacionais. O que devo fazer?**  

O ciclo de vida do Windows NT Workstation 4.0 Service Pack 6a, Windows NT Server 4.0 Service Pack 6a, Windows 2000 Service Pack 2 e Windows 2000 Service Pack 3 chegou ao fim. Os clientes que possuem essas versões de sistema operacional devem priorizar a migração para as versões com suporte, a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do produto Windows, visite o [site do Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742). Para obter mais informações sobre o período de suporte estendido da atualização de segurança dessas versões de sistema operacional, visite o [site Microsoft Product Support Services](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que precisarem de suporte adicional para o Windows NT 4.0 SP6a deverão entrar em contato com o representante da equipe da conta da Microsoft, com o gerente técnico da conta ou com o representante do parceiro Microsoft apropriado para obter opções de suporte personalizadas. Os clientes sem um contrato Alliance, Premier ou Authorized podem entrar em contato com o escritório de vendas local da Microsoft. Para obter informações de contato, visite o site de [Informações internacionais da Microsoft](http://go.microsoft.com/fwlink/?linkid=33329), selecione o país e clique em **Go** para ver uma lista de telefones. Ao ligar, peça para falar com o gerente de vendas local de Suporte Premier.

Para obter mais informações, consulte a seção [Perguntas freqüentes sobre o ciclo de vida do suporte ao produto sistema operacional Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**O suporte para a atualização de segurança do Microsoft Windows XP 64-Bit Edition Service Pack 1 (Itanium) e Microsoft Windows XP 64-Bit Edition Version 2003 (Itanium) foi encerrado em 30 de junho de 2005. Ainda estou usando um desses sistemas operacionais. O que devo fazer?**  

Com o lançamento do Windows XP Professional x64 Edition, o Microsoft Windows XP 64-Bit Edition Service Pack 1 (Itanium) e o Microsoft Windows XP 64-Bit Edition Version 2003 (Itanium) deixarão de receber suporte para a atualização de segurança. Os clientes que possuem essas versões de sistema operacional devem priorizar a migração para as versões com suporte, a fim de evitar uma possível exposição a vulnerabilidades. A Microsoft continuará a oferecer total suporte ao Windows Server 2003 para sistemas baseados no Itanium, ao Windows XP Professional x64 Edition e ao Windows Server 2003 x64 Editions para requisitos de computação de 64 bits. A Microsoft continua a licenciar e oferecer suporte às edições Enterprise e Datacenter do Windows Server 2003 para sistemas baseados no Itanium e à versão de 64 bits do SQL Server 2000 Enterprise Edition. Futuramente, expandiremos o suporte do Itanium ao Visual Studio 2005, .NET Framework 2005 e SQL Server 2005.

Os clientes que precisarem de suporte adicional para essa questão deverão entrar em contato com o representante da equipe da conta da Microsoft, com o gerente técnico da conta ou com o representante do parceiro Microsoft apropriado para obter informações sobre as opções de migração disponíveis. Os clientes sem um contrato Alliance, Premier ou Authorized podem entrar em contato com o escritório de vendas local da Microsoft. Para obter informações de contato, visite o site de [Informações internacionais da Microsoft](http://go.microsoft.com/fwlink/?linkid=33329), selecione o país e clique em **Go** para ver uma lista de telefones. Ao ligar, peça para falar com o gerente de vendas local de Suporte Premier.

**Posso usar o MBSA (Microsoft Baseline Security Analyzer) 1.2.1 para determinar se esta atualização é necessária?**  

Sim. O MBSA 1.2.1 determinará se a atualização é necessária. Para obter mais informações sobre o MBSA, visite o [site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134).
**Posso usar o MBSA (Microsoft Baseline Security Analyzer) 2.0 para determinar se esta atualização é necessária?**  
Sim. O MBSA 2.0 determinará se a atualização é necessária. O MBSA 2.0 pode detectar atualizações de segurança de produtos suportados pelo Microsoft Update. Para obter mais informações sobre o MBSA, visite o [site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134).

**Posso usar o SMS (Systems Management Server) para determinar se esta atualização é necessária?**  
Sim. O SMS pode ajudar a detectar e implantar a atualização de segurança. Para obter mais informações sobre o SMS, visite o [site do SMS](http://go.microsoft.com/fwlink/?linkid=21158). A ferramenta Inventário de Atualização de Segurança pode ser usada pelo SMS para detectar atualizações de segurança oferecidas pelo [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130), que têm suporte de [Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133), e outras atualizações de segurança com suporte do MBSA 1.2.1. Para obter mais informações sobre a ferramenta Inventário de Atualização de Segurança, consulte o seguinte[site da Microsoft](http://www.microsoft.com/smserver/downloads/2003/featurepacks/suspack). Para obter mais informações sobre as limitações da ferramenta Inventário de Atualização de Segurança, consulte o [artigo (em inglês) 306460 do Microsoft Knowledge Base](http://support.microsoft.com/kb/306460). A ferramenta de inventário do SMS 2003 para [atualizações da Microsoft](http://update.microsoft.com/microsoftupdate) pode ser usada pelo SMS para detectar atualizações de segurança oferecidas pelo Microsoft Update e com suporte de [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para obter mais informações sobre a ferramenta de inventário do SMS 2003 para atualizações da Microsoft, consulte o seguinte [site da Microsoft](http://go.microsoft.com/fwlink/?linkid=50757).

Detalhes da Vulnerabilidade
---------------------------

<span></span>
#### Mecanismo de tratamento de elementos gráficos - CAN-2005-2123:

Uma vulnerabilidade de execução remota de código no processamento de formatos de imagem WMF (metarquivo do Windows) e EMF (metarquivo avançado) que pode permitir a execução remota de código em um sistema afetado. Qualquer programa que processa imagens WMF ou EMF nos sistemas afetados pode estar vulnerável a esse ataque. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado.

#### Fatores atenuantes do mecanismo de processamento de elementos gráficos - CAN-2005-2123:

-   A vulnerabilidade pode ser explorada por um invasor que convença um usuário a abrir um arquivo específico ou a exibir uma pasta que contenha uma determinada imagem. Não há como um invasor forçar um usuário a abrir um arquivo mal-intencionado, exceto através da visualização de uma mensagem de email.
-   Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Não há como um invasor forçar usuários a visitar o site mal-intencionado. Em vez disso, o invasor terá que atraí-los para lá, normalmente fazendo com que cliquem em um link para esse site.

#### Soluções alternativas do mecanismo de processamento de elementos gráficos - CAN-2005-2123:

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Quando uma solução alternativa reduz a funcionalidade, ela é identificada na seção a seguir.

-   **Se você estiver usando o Outlook 2002 ou posterior, leia as mensagens de email no formato de texto sem formatação para ajudar a proteger-se do vetor de ataque de email em HTML.**

    Os usuários do Microsoft Outlook 2002 que aplicaram o Office XP Service Pack 1 ou posterior, e os usuários do Microsoft Outlook Express 6 que aplicaram o Internet Explorer 6 Service Pack 1 ou posterior, podem habilitar essa configuração e exibir todas as mensagens de email sem assinatura digital ou não criptografadas somente como texto simples.

    Mensagens de email assinadas digitalmente ou criptografadas não são afetadas por essa configuração e podem ser lidas em seus formatos originais. Para obter mais informações sobre como habilitar essa configuração no Outlook 2002, consulte o [Artigo 307594 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/307594).

    **Impacto da solução alternativa:** As mensagens de email exibidas em formato de texto sem formatação não conterão figuras, fontes específicas, animações nem outro conteúdo formatado. Além disso:

    -   As alterações são aplicadas ao painel de visualização e a mensagens abertas.
    -   As imagens passam a ser anexos para não serem perdidas.
    -   Como a mensagem ainda será armazenada como Rich Text ou HTML, o modelo de objeto (soluções de código personalizado) pode comportar-se de maneira inesperada.

#### Perguntas freqüentes sobre o mecanismo de processamento de elementos gráficos - CAN-2005-2123:

**Qual é o escopo da vulnerabilidade?**  
Essa é uma vulnerabilidade de execução remota de código. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Esta vulnerabilidade também pode ser usada na tentativa de realizar uma elevação de privilégio local ou uma negação de serviço remota.

**O que provoca a vulnerabilidade?**  
Um buffer sem verificação no processamento de formatos de imagem WMF (Metarquivo do Windows) e EMF (Metarquivo Avançado).

**O que são formatos de imagem WMF (Metarquivo do Windows) e EMF (Metarquivo Avançado)?**  

Uma imagem WMF é um formato de metarquivo de 16 bits que pode conter informações sobre vetores e bitmap. Ela é otimizada para o sistema operacional Windows.

Uma imagem EMF é um metarquivo de 32 bits que pode conter informações sobre vetores e sobre bitmap. Esse formato é um aprimoramento do formato Metarquivo do Windows e contém mais recursos.

Para obter mais informações sobre os tipos e formatos de imagem, consulte o [artigo 320314 do Microsoft Knowledge Base](http://support.microsoft.com/default.aspx?scid=kb;en-us;320314). Informações adicionais sobre esses formatos de arquivo também estão disponíveis no [site MSDN Library](http://msdn2.microsoft.com/en-us/library/ms536391.aspx).

**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado.

**De que forma o invasor pode explorar essa vulnerabilidade?**  
Qualquer programa que processa os tipos de imagem afetados pode estar vulnerável a esse ataque. Aqui estão alguns exemplos de como um invasor poderia tentar explorar essa vulnerabilidade:

-   O invasor pode hospedar um site mal-intencionado criado para explorar essa vulnerabilidade através do Internet Explorer e, então, persuadir um usuário a exibir o site.
-   O invasor pode criar uma mensagem de email em HTML com uma imagem específica anexada. Essa imagem pode ser criada especialmente para explorar essa vulnerabilidade por meio do Microsoft Outlook ou do Outlook Express 6. O invasor pode persuadir o usuário a exibir a mensagem de email em HTML.
-   O invasor pode incorporar uma imagem específica a um documento do Office e então persuadir o usuário a exibir o documento.
-   Ele pode adicionar uma imagem específica ao sistema de arquivos local ou a um compartilhamento de rede e persuadir o usuário a visualizar a pasta.
-   Se um invasor puder fazer logon localmente, ele poderá executar um programa especialmente criado que poderá explorar a vulnerabilidade e assim ganhar total controle sobre o sistema afetado.

O invasor também poderá acessar o componente afetado por meio de outro vetor. Por exemplo, o invasor pode fazer logon no sistema de maneira interativa ou usar outro programa que transmite parâmetros ao componente vulnerável (local ou remotamente). Para explorar localmente essa vulnerabilidade, primeiro o invasor precisa fazer logon no sistema. Ele então precisa executar um programa específico capaz de explorar a vulnerabilidade e, assim, assumir o controle total do sistema afetado.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
A vulnerabilidade pode ser explorada nos sistemas afetados por um invasor que convença um usuário a abrir um arquivo específico ou a exibir uma pasta que contenha uma determinada imagem. Não há como um invasor forçar um usuário a abrir um arquivo específico, exceto através da visualização de uma mensagem de email. Principalmente as estações de trabalho e os servidores de terminal estão correndo risco. Os servidores correrão mais risco se usuários que não tiverem permissões administrativas suficientes puderem fazer logon nos servidores e executar programas ou navegar a Internet. Entretanto, as práticas recomendadas não recomendam esse procedimento.

**A vulnerabilidade pode ser explorada pela Internet?**  
Sim. Um invasor pode tentar explorar essa vulnerabilidade através de sites mal-intencionados ou através de email via Internet.

**O que a atualização faz?**  
A atualização remove a vulnerabilidade modificando a forma como o mecanismo de processamento de elementos gráficos processa formatos de imagem WMF (Metarquivo do Windows) e EMF (Metarquivo Avançado).

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Não. A Microsoft recebeu informações sobre essa vulnerabilidade por meio de divulgação responsável. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido divulgada publicamente quando este boletim de segurança foi lançado pela primeira vez.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido usada publicamente para atacar clientes e não testemunhou nenhum exemplo de publicação de código de verificação de conceito, quando este boletim de segurança foi lançado pela primeira vez.

#### Vulnerabilidade de metarquivo do Windows - CAN-2005-2124:

Uma vulnerabilidade de execução remota de código no processamento de formatos de imagem WMF (metarquivo do Windows) que pode permitir a execução remota de código em um sistema afetado. Qualquer programa que processa imagens WMF nos sistemas afetados pode estar vulnerável a esse ataque. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado.

#### Fatores atenuantes da vulnerabilidade de metarquivo do Windows - CAN-2005-2124:

-   A vulnerabilidade pode ser explorada por um invasor que convença um usuário a abrir um arquivo específico ou a exibir uma pasta que contenha uma determinada imagem. Não há como um invasor forçar um usuário a abrir um arquivo mal-intencionado, exceto através da visualização de uma mensagem de email.
-   Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Não há como um invasor forçar usuários a visitar o site mal-intencionado. Em vez disso, o invasor terá que atraí-los para lá, normalmente fazendo com que cliquem em um link para esse site.

#### Soluções alternativas para a vulnerabilidade de metarquivo do Windows - CAN-2005-2124:

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Quando uma solução alternativa reduz a funcionalidade, ela é identificada na seção a seguir.

-   **Se você estiver usando o Outlook 2002 ou posterior, leia as mensagens de email no formato de texto sem formatação para ajudar a proteger-se do vetor de ataque de email em HTML.**

    Os usuários do Microsoft Outlook 2002 que aplicaram o Office XP Service Pack 1 ou posterior, e os usuários do Microsoft Outlook Express 6 que aplicaram o Internet Explorer 6 Service Pack 1 ou posterior, podem habilitar essa configuração e exibir todas as mensagens de email sem assinatura digital ou não criptografadas somente como texto simples.

    Mensagens de email assinadas digitalmente ou criptografadas não são afetadas por essa configuração e podem ser lidas em seus formatos originais. Para obter mais informações sobre como habilitar essa configuração no Outlook 2002, consulte o [Artigo 307594 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/307594).

    **Impacto da solução alternativa:** As mensagens de email exibidas em formato de texto sem formatação não conterão figuras, fontes específicas, animações nem outro conteúdo formatado. Além disso:

    -   As alterações são aplicadas ao painel de visualização e a mensagens abertas.
    -   As imagens passam a ser anexos para não serem perdidas.
    -   Como a mensagem ainda será armazenada como Rich Text ou HTML, o modelo de objeto (soluções de código personalizado) pode comportar-se de maneira inesperada.

#### Perguntas freqüentes sobre a vulnerabilidade de metarquivo do Windows - CAN-2005-2124:

**Qual é o escopo da vulnerabilidade?**  
Essa é uma vulnerabilidade de execução remota de código. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Esta vulnerabilidade também pode ser usada na tentativa de realizar uma elevação de privilégio local ou uma negação de serviço remota.

**O que provoca a vulnerabilidade?**  
Um buffer sem verificação no processamento de formatos de imagem WMF (metarquivo do Windows).

**O que são formatos de imagem WMF (metarquivo do Windows)?**  

Uma imagem WMF é um formato de metarquivo de 16 bits que pode conter informações sobre vetores e bitmap. Ela é otimizada para o sistema operacional Windows.

Para obter mais informações sobre os tipos e formatos de imagem, consulte o [artigo 320314 do Microsoft Knowledge Base](http://support.microsoft.com/default.aspx?scid=kb;en-us;320314). Informações adicionais sobre esses formatos de arquivo também estão disponíveis no [site MSDN Library](http://msdn2.microsoft.com/en-us/library/ms536391.aspx).

**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado.

**De que forma o invasor pode explorar essa vulnerabilidade?**  
Qualquer programa que processa os tipos de imagem afetados pode estar vulnerável a esse ataque. Aqui estão alguns exemplos de como um invasor poderia tentar explorar essa vulnerabilidade:

-   O invasor pode hospedar um site mal-intencionado criado para explorar essa vulnerabilidade através do Internet Explorer e, então, persuadir um usuário a exibir o site.
-   O invasor pode criar uma mensagem de email em HTML com uma imagem específica anexada. Essa imagem pode ser criada especialmente para explorar essa vulnerabilidade por meio do Microsoft Outlook ou do Outlook Express 6. O invasor pode persuadir o usuário a exibir a mensagem de email em HTML.
-   O invasor pode incorporar uma imagem específica a um documento do Office e então persuadir o usuário a exibir o documento.
-   Ele pode adicionar uma imagem específica ao sistema de arquivos local ou a um compartilhamento de rede e persuadir o usuário a visualizar a pasta.
-   Pode efetuar logon localmente no sistema. Ou então pode executar um programa específico capaz de explorar a vulnerabilidade e assim assumir o controle total do sistema afetado.

O invasor também poderá acessar o componente afetado por meio de outro vetor. Por exemplo, o invasor pode fazer logon no sistema de maneira interativa ou usar outro programa que transmite parâmetros ao componente vulnerável (local ou remotamente). Para explorar localmente essa vulnerabilidade, primeiro o invasor precisa fazer logon no sistema. Ele então precisa executar um programa específico capaz de explorar a vulnerabilidade e, assim, assumir o controle total do sistema afetado.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
A vulnerabilidade pode ser explorada nos sistemas afetados por um invasor que convença um usuário a abrir um arquivo específico ou a exibir uma pasta que contenha uma determinada imagem. Não há como um invasor forçar um usuário a abrir um arquivo específico, exceto através da visualização de uma mensagem de email. Principalmente as estações de trabalho e os servidores de terminal estão correndo risco. Os servidores correrão mais risco se usuários que não tiverem permissões administrativas suficientes puderem fazer logon nos servidores e executar programas ou navegar a Internet. Entretanto, as práticas recomendadas não recomendam esse procedimento.

**A vulnerabilidade pode ser explorada pela Internet?**  
Sim. Um invasor pode tentar explorar essa vulnerabilidade através de sites mal-intencionados ou através de email via Internet.

**O que a atualização faz?**  
A atualização elimina a vulnerabilidade modificando o modo como as versões do sistema operacional afetado validam o tamanho de uma mensagem antes de transmiti-la ao buffer alocado.

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Não. A Microsoft recebeu informações sobre essa vulnerabilidade por meio de divulgação responsável. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido divulgada publicamente quando este boletim de segurança foi lançado pela primeira vez.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido usada publicamente para atacar clientes e não testemunhou nenhum exemplo de publicação de código de verificação de conceito, quando este boletim de segurança foi lançado pela primeira vez.

#### Vulnerabilidade de metarquivo avançado - CAN-2005-0803:

Existe uma vulnerabilidade de negação de serviço no processamento de formato de imagem EMF (metarquivo avançado) que pode permitir que qualquer programa que processe imagens EMF esteja vulnerável. O invasor que explorar essa vulnerabilidade com sucesso poderá fazer com que o serviço afetado pare de responder.

#### Fatores atenuantes da vulnerabilidade de metarquivo avançado - CAN-2005-0803:

-   A vulnerabilidade pode ser explorada por um invasor que convença um usuário a abrir um arquivo específico ou a exibir uma pasta que contenha uma determinada imagem. Não há como um invasor forçar um usuário a abrir um arquivo mal-intencionado, exceto através da visualização de uma mensagem de email.
-   Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Não há como um invasor forçar usuários a visitar o site mal-intencionado. Em vez disso, o invasor terá que atraí-los para lá, normalmente fazendo com que cliquem em um link para esse site.

#### Soluções alternativas para a vulnerabilidade de metarquivo do avançado - CAN-2005-0803:

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Quando uma solução alternativa reduz a funcionalidade, ela é identificada na seção a seguir.

-   **Se você estiver usando o Outlook 2002 ou posterior, leia as mensagens de email no formato de texto sem formatação para ajudar a proteger-se do vetor de ataque de email em HTML.**

    Os usuários do Microsoft Outlook 2002 que aplicaram o Office XP Service Pack 1 ou posterior, e os usuários do Microsoft Outlook Express 6 que aplicaram o Internet Explorer 6 Service Pack 1 ou posterior, podem habilitar essa configuração e exibir todas as mensagens de email sem assinatura digital ou não criptografadas somente como texto simples.

    Mensagens de email assinadas digitalmente ou criptografadas não são afetadas por essa configuração e podem ser lidas em seus formatos originais. Para obter mais informações sobre como habilitar essa configuração no Outlook 2002, consulte o [Artigo 307594 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/307594).

    **Impacto da solução alternativa:** As mensagens de email exibidas em formato de texto sem formatação não conterão figuras, fontes específicas, animações nem outro conteúdo formatado. Além disso:

    -   As alterações são aplicadas ao painel de visualização e a mensagens abertas.
    -   As imagens passam a ser anexos para não serem perdidas.
    -   Como a mensagem ainda será armazenada como Rich Text ou HTML, o modelo de objeto (soluções de código personalizado) pode comportar-se de maneira inesperada.

#### Perguntas freqüentes sobre a vulnerabilidade de metarquivo do avançado - CAN-2005-0803:

**Qual é o escopo da vulnerabilidade?**  
Essa é uma vulnerabilidade de negação de serviço (site em inglês). O invasor que explorar essa vulnerabilidade poderá fazer com que o sistema afetado pare de responder. O programa pode ser reiniciado para que retorne à operação normal. Observe que a vulnerabilidade de negação de serviço não permite que os invasores executem códigos nem elevem seus privilégios, mas pode fazer com que o sistema afetado pare de responder.

**O que provoca a vulnerabilidade?**  
Um buffer sem verificação no processamento de formatos de imagem EMF (metarquivo aprimorado).

**O que são formatos de imagem EMF (metarquivo avançado)?**  

Uma imagem EMF é um metarquivo de 32 bits que pode conter informações sobre vetores e sobre bitmap. Esse formato é um aprimoramento do formato Metarquivo do Windows e contém mais recursos.

Para obter mais informações sobre os tipos e formatos de imagem, consulte o [artigo 320314 do Microsoft Knowledge Base](http://support.microsoft.com/default.aspx?scid=kb;en-us;320314). Informações adicionais sobre esses formatos de arquivo também estão disponíveis no [site MSDN Library](http://msdn2.microsoft.com/en-us/library/ms536391.aspx).

**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar essa vulnerabilidade com sucesso poderá fazer com que um programa pare de responder.

**De que forma o invasor pode explorar essa vulnerabilidade?**  
Qualquer programa que processa os tipos de imagem afetados pode estar vulnerável a esse ataque. Aqui estão alguns exemplos de como um invasor poderia tentar explorar essa vulnerabilidade:

-   O invasor pode hospedar um site mal-intencionado criado para explorar essa vulnerabilidade através do Internet Explorer e, então, persuadir um usuário a exibir o site.
-   O invasor pode criar uma mensagem de email em HTML com uma imagem específica anexada. Essa imagem pode ser criada especialmente para explorar essa vulnerabilidade por meio do Microsoft Outlook ou do Outlook Express 6. O invasor pode persuadir o usuário a exibir a mensagem de email em HTML.
-   O invasor pode incorporar uma imagem específica a um documento do Office e então persuadir o usuário a exibir o documento.
-   Ele pode adicionar uma imagem específica ao sistema de arquivos local ou a um compartilhamento de rede e persuadir o usuário a visualizar a pasta.
-   Pode efetuar logon localmente no sistema. Ele pode então executar um programa específico capaz de explorar a vulnerabilidade.

O invasor também poderá acessar o componente afetado por meio de outro vetor. Por exemplo, o invasor pode fazer logon no sistema de maneira interativa ou usar outro programa que transmite parâmetros ao componente vulnerável (local ou remotamente). Para explorar localmente essa vulnerabilidade, primeiro o invasor precisa fazer logon no sistema.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
A vulnerabilidade pode ser explorada nos sistemas afetados por um invasor que convença um usuário a abrir um arquivo específico ou a exibir uma pasta que contenha uma determinada imagem. Não há como um invasor forçar um usuário a abrir um arquivo específico, exceto através da visualização de uma mensagem de email. Principalmente as estações de trabalho e os servidores de terminal estão correndo risco. Os servidores correrão mais risco se usuários que não tiverem permissões administrativas suficientes puderem fazer logon nos servidores e executar programas ou navegar a Internet. Entretanto, as práticas recomendadas não recomendam esse procedimento.

**A vulnerabilidade pode ser explorada pela Internet?**  
Sim. Um invasor pode tentar explorar essa vulnerabilidade através de sites mal-intencionados ou através de email via Internet.

**O que a atualização faz?**  
A atualização elimina a vulnerabilidade modificando o modo como as versões do sistema operacional afetado validam o tamanho de uma mensagem antes de transmiti-la ao buffer alocado.

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Sim. Essa vulnerabilidade foi divulgada publicamente. Ela recebeu o número CAN-2005-0803 de vulnerabilidade e exposição comum.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft viu exemplos de código de verificação de conceito divulgados publicamente, mas não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido usada publicamente para atacar clientes quando este boletim de segurança foi originalmente lançado.

**A aplicação desta atualização de segurança ajuda a proteger os clientes contra o código divulgado publicamente que tenta explorar essa vulnerabilidade?**  
Sim. Essa atualização de segurança elimina a vulnerabilidade que está sendo explorada atualmente. A vulnerabilidade abordada recebeu o número CAN-2005-0803 de vulnerabilidade e exposição comum.

Informações de atualização de segurança
---------------------------------------

<span></span>
**Softwares afetados:**

Para obter informações sobre uma atualização de segurança específica para seu software afetado, clique no link apropriado:

#### Windows Server 2003 (todas as versões)

**Pré-requisitos**  
Esta atualização de segurança requer o Windows Server 2003 ou Windows Server 2003 Service Pack 1.

**Inclusão em Service Packs futuros**  
A atualização desse problema será incluída em um service pack ou pacote cumulativo de atualizações futuro.

**Informações de instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Sobrescreve arquivos OEM sem notificação
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz backup de arquivos necessários à desinstalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log: path**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:caminho**
</td>
<td style="border:1px solid black;">
Integra a atualização nos arquivos-fonte do Windows. Esses arquivos se encontram no caminho especificado na opção.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:caminho\]**
</td>
<td style="border:1px solid black;">
Extrai os arquivos sem iniciar o programa de instalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte a várias opções de instalação utilizadas por versões anteriores do programa de instalação. Para obter mais informações sobre opções com suporte de segurança, consulte o [artigo 262841 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o instalador Update.exe, visite [o site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, utilize o seguinte comando em um prompt de comando para o Windows Server 2003:

**Windowsserver2003-kb896424-x86-enu /quiet**

**Observação** O uso da opção **/quiet** eliminará todas as mensagens. Isso inclui a eliminação de mensagens de falha. Os administradores devem usar um dos métodos com suporte para verificar se a instalação foi bem-sucedida quando usarem a opção **/quiet**. Os administradores também deverão analisar o arquivo KB896424.log para obter as mensagens de falha quando usarem essa opção.

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando para o Windows Server 2003:

**Windowsserver2003-kb896424-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com os serviços de atualização de software, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Necessidade de Reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB896424$\\Spuninst.

<p></p>
<table class="dataTable">
<caption>
Opções do Spuninst.exe para as quais existe suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação
</td>
</tr>
</table>
 
**Informações sobre o arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Datacenter Edition; Windows Server 2003, Enterprise Edition; Windows Small Business Server 2003; Windows Server 2003, Web Edition com SP1; Windows Server 2003, Standard Edition com SP1; Windows Server 2003, Enterprise Edition com SP1; e Windows Server 2003, Datacenter Edition com SP1:

| Nome do arquivo | Versão        | Data                 | Hora  | Tamanho   | Pasta  |
|-----------------|---------------|----------------------|-------|-----------|--------|
| Gdi32.dll       | 5.2.3790.419  | 6 de outubro de 2005 | 02:48 | 271.872   | RTMGDR |
| Win32k.sys      | 5.2.3790.419  | 5 de outubro de 2005 | 23:51 | 1.815.552 | RTMGDR |
| Gdi32.dll       | 5.2.3790.419  | 6 de outubro de 2005 | 02:38 | 272.384   | RTMQFE |
| Win32k.sys      | 5.2.3790.419  | 5 de outubro de 2005 | 23:56 | 1.818.112 | RTMQFE |
| Gdi32.dll       | 5.2.3790.2542 | 6 de outubro de 2005 | 02:03 | 281.600   | SP1GDR |
| Win32k.sys      | 5.2.3790.2542 | 6 de outubro de 2005 | 00:42 | 1.848.320 | SP1GDR |
| Gdi32.dll       | 5.2.3790.2542 | 6 de outubro de 2005 | 02:12 | 281.600   | SP1QFE |
| Win32k.sys      | 5.2.3790.2542 | 6 de outubro de 2005 | 00:53 | 1.847.808 | SP1QFE |
| Arpidfix.exe    | 5.2.3790.2542 | 6 de outubro de 2005 | 00:21 | 32.256    |        |

Windows Server 2003 Enterprise Edition para sistemas baseados no Itanium; Windows Server 2003, Datacenter Edition para sistemas baseados no Itanium; Windows Server 2003, Enterprise Edition com SP1 para sistemas baseados no Itanium e Windows Server 2003, Datacenter Edition com SP1 para sistemas baseados no Itanium:

| Nome do arquivo | Versão        | Data                 | Hora  | Tamanho   | CPU   | Pasta       |
|-----------------|---------------|----------------------|-------|-----------|-------|-------------|
| Gdi32.dll       | 5.2.3790.419  | 6 de outubro de 2005 | 03:03 | 806.912   | IA-64 | RTMGDR      |
| Win32k.sys      | 5.2.3790.419  | 6 de outubro de 2005 | 03:03 | 4.959.744 | IA-64 | RTMGDR      |
| Wgdi32.dll      | 5.2.3790.419  | 6 de outubro de 2005 | 03:03 | 250.880   | x86   | RTMGDR\\WOW |
| Gdi32.dll       | 5.2.3790.419  | 6 de outubro de 2005 | 03:03 | 807.936   | IA-64 | RTMQFE      |
| Win32k.sys      | 5.2.3790.419  | 6 de outubro de 2005 | 03:03 | 4.965.888 | IA-64 | RTMQFE      |
| Wgdi32.dll      | 5.2.3790.419  | 6 de outubro de 2005 | 03:03 | 250.880   | x86   | RTMQFE\\WOW |
| Gdi32.dll       | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 907.264   | IA-64 | SP1GDR      |
| Win32k.sys      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 5.547.008 | IA-64 | SP1GDR      |
| Wgdi32.dll      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 285.184   | x86   | SP1GDR\\WOW |
| Gdi32.dll       | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 907.264   | IA-64 | SP1QFE      |
| Win32k.sys      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 5.545.984 | IA-64 | SP1QFE      |
| Wgdi32.dll      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 285.184   | x86   | SP1QFE\\WOW |
| Arpidfix.exe    | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 74.752    | IA-64 |             |

Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition; e Windows Server 2003, Datacenter x64 Edition:

| Nome do arquivo | Versão        | Data                 | Hora  | Tamanho   | CPU | Pasta       |
|-----------------|---------------|----------------------|-------|-----------|-----|-------------|
| Gdi32.dll       | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 609,792   | x64 | SP1GDR      |
| Win32k.sys      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 4.517.376 | x64 | SP1GDR      |
| Wgdi32.dll      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 285.184   | x86 | SP1GDR\\WOW |
| Gdi32.dll       | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 609,792   | x64 | SP1QFE      |
| Win32k.sys      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 4.516.864 | x64 | SP1QFE      |
| Wgdi32.dll      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 285.184   | x86 | SP1QFE\\WOW |
| Arpidfix.exe    | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 43.008    | x64 |             |

**Observações** Quando você instalar estas atualizações de segurança, o instalador verificará se um ou mais arquivos que estão sendo atualizados no sistema já foram atualizados por um hotfix da Microsoft.
Se você já tiver instalado um hotfix para atualizar um desses arquivos, o instalador copiará os arquivos RTMQFE, SP1QFE ou SP2QFE para o sistema. Do contrário, o instalador copiará os arquivos RTMGDR, SP1GDR ou SP2GDR para o sistema. As atualizações de segurança podem não conter todas as variações desses arquivos. Para obter mais informações sobre esse comportamento, consulte o [Artigo 824994 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/824994).

Para obter mais informações sobre esse comportamento, consulte o [Artigo 824994 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/824994).

Para obter mais informações sobre o instalador Update.exe, visite o [site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [Artigo 824684 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/824684).

Arpidfix.exe é usado pelo instalador da atualização de segurança para tratar de um problema documentado no [artigo 904630 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/904630). Este arquivo não está instalado no sistema afetado.

**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, você pode utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (em inglês).

-   **Verificação de Versão do Arquivo**

    **Observação** Como existem diversas versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.  

        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos talvez não estejam instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.  

        **Observação** Atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Também é possível verificar os arquivos que esta atualização de segurança instalou analisando as seguintes chaves do Registro:

    Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Enterprise Edition; Windows Server 2003, Datacenter Edition; Windows Small Business Server 2003; Windows Server 2003, Web Edition com SP1; Windows Server 2003, Standard Edition com SP1; Windows Server 2003, Enterprise Edition com SP1; Windows Server 2003, Datacenter Edition com SP1; Windows Server 2003, Enterprise Edition para sistemas baseados no Itanium; Windows Server 2003, Datacenter Edition para sistemas baseados no Itanium; Windows Server 2003, Enterprise Edition com SP1 para sistemas baseados no Itanium; Windows Server 2003, Datacenter Edition com SP1 para sistemas baseados no Itanium; Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition; e Windows Server 2003, Datacenter x64 Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP2\\KB896424\\Filelist

    **Observação** Essa chave do Registro pode não conter uma lista completa de arquivos instalados. Além disso, essa chave do Registro talvez não seja criada corretamente caso o administrador ou um OEM integre ou adicione a atualização de segurança 896424 nos arquivos originais de instalação do Windows.

#### Windows XP (todas as versões)

**Pré-requisitos**  
Esta atualização de segurança requer o Microsoft Windows XP Service Pack 1 ou uma versão posterior. Para obter mais informações, consulte o [Artigo 322389 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/322389).

**Inclusão em Service Packs futuros**  
A atualização desse problema será incluída em um Service Pack ou conjunto de atualizações futuro.

**Informações de instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Sobrescreve arquivos OEM sem notificação
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz backup de arquivos necessários à desinstalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:caminho**
</td>
<td style="border:1px solid black;">
Integra a atualização nos arquivos-fonte do Windows. Esses arquivos se encontram no caminho especificado na opção.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:caminho\]**
</td>
<td style="border:1px solid black;">
Extrai os arquivos sem iniciar o programa de instalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte às opções de instalação utilizadas por versões anteriores do programa de instalação. Para obter mais informações sobre opções com suporte de segurança, consulte o [artigo 262841 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o instalador Update.exe, visite [o site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, utilize o seguinte comando em um prompt de comando para o Microsoft Windows XP:

**Windowsxp-kb896424-x86-enu /quiet**

**Observação** O uso da opção **/quiet** eliminará todas as mensagens. Isso inclui a eliminação de mensagens de falha. Os administradores devem usar um dos métodos com suporte para verificar se a instalação foi bem-sucedida quando usarem a opção **/quiet**. Os administradores também deverão analisar o arquivo KB896424.log para obter as mensagens de falha quando usarem essa opção.

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando para o Windows XP:

**Windowsxp-kb896424-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com os serviços de atualização de software, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Necessidade de Reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB896424$\\Spuninst.

<p></p>
<table class="dataTable">
<caption>
Opções do Spuninst.exe para as quais existe suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação
</td>
</tr>
</table>
 
**Informações sobre o arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP Tablet PC Edition, Windows XP Media Center Edition, Windows XP Home Edition Service Pack 2, Windows XP Professional Service Pack 2, Windows XP Tablet PC Edition 2005 e Windows XP Media Center Edition 2005:

| Nome do arquivo | Versão        | Data                 | Hora  | Tamanho   | Pasta  |
|-----------------|---------------|----------------------|-------|-----------|--------|
| Gdi32.dll       | 5.1.2600.1755 | 6 de outubro de 2005 | 03:19 | 260.608   | SP1QFE |
| Mf3216.dll      | 5.1.2600.1331 | 30 de março de 2004  | 01:48 | 36.864    | SP1QFE |
| User32.dll      | 5.1.2600.1634 | 2 de março de 2005   | 18:20 | 561.152   | SP1QFE |
| Win32k.sys      | 5.1.2600.1755 | 4 de outubro de 2005 | 01:38 | 1.799.552 | SP1QFE |
| Gdi32.dll       | 5.1.2600.2770 | 6 de outubro de 2005 | 03:09 | 280.064   | SP2GDR |
| Win32k.sys      | 5.1.2600.2770 | 6 de outubro de 2005 | 00:05 | 1.839.488 | SP2GDR |
| Gdi32.dll       | 5.1.2600.2770 | 6 de outubro de 2005 | 03:18 | 280.064   | SP2QFE |
| Win32k.sys      | 5.1.2600.2770 | 6 de outubro de 2005 | 00:10 | 1.839.360 | SP2QFE |
| Arpidfix.exe    | 5.1.2600.2770 | 5 de outubro de 2005 | 23:39 | 30.720    |        |

Windows XP Professional x64:

| Nome do arquivo | Versão        | Data                 | Hora  | Tamanho   | CPU | Pasta       |
|-----------------|---------------|----------------------|-------|-----------|-----|-------------|
| Gdi32.dll       | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 609,792   | x64 | SP1GDR      |
| Win32k.sys      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 4.517.376 | x64 | SP1GDR      |
| Wgdi32.dll      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 285.184   | x86 | SP1GDR\\WOW |
| Gdi32.dll       | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 609,792   | x64 | SP1QFE      |
| Win32k.sys      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 4.516.864 | x64 | SP1QFE      |
| Wgdi32.dll      | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 285.184   | x86 | SP1QFE\\WOW |
| Arpidfix.exe    | 5.2.3790.2542 | 6 de outubro de 2005 | 03:03 | 43.008    | x64 |             |

**Observações** Quando você instalar estas atualizações de segurança, o instalador verificará se um ou mais arquivos que estão sendo atualizados no sistema já foram atualizados por um hotfix da Microsoft.
Se você já tiver instalado um hotfix para atualizar um desses arquivos, o instalador copiará os arquivos RTMQFE, SP1QFE ou SP2QFE para o sistema. Do contrário, o instalador copiará os arquivos RTMGDR, SP1GDR ou SP2GDR para o sistema. As atualizações de segurança podem não conter todas as variações desses arquivos. Para obter mais informações sobre esse comportamento, consulte o [Artigo 824994 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/824994).

Para obter mais informações sobre o instalador Update.exe, visite o [site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951).

Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [Artigo 824684 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/824684).

Arpidfix.exe é usado pelo instalador da atualização de segurança para tratar de um problema documentado no [artigo 904630 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/904630). Este arquivo não está instalado no sistema afetado.

**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, você pode utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (em inglês).

-   **Verificação de Versão do Arquivo**

    **Observação** Como existem diversas versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.  

        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos talvez não estejam instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.  

        **Observação** Atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Também é possível verificar os arquivos que esta atualização de segurança instalou analisando as seguintes chaves do Registro:

    Para Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP Tablet PC Edition, Windows XP Media Center Edition, Windows XP Home Edition Service Pack 2, Windows XP Professional Service Pack 2, Windows XP Tablet PC Edition 2005 e Windows XP Media Center Edition 2005:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP3\\KB896424\\Filelist

    Para Windows XP Professional x64 Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP2\\KB896424\\Filelist

    **Observação** Talvez essas chaves do Registro não contenham uma lista completa dos arquivos instalados. Além disso, essas chaves do Registro talvez não sejam criadas corretamente caso o administrador ou um OEM integre ou adicione a atualização de segurança 896424 aos arquivos originais de instalação do Windows.

#### Windows 2000 (todas as versões)

**Pré-requisitos**  
No Windows 2000, esta atualização de segurança requer o Service Pack 4 (SP4). Para o Small Business Server 2000, esta atualização de segurança requer que o Small Business Server 2000 Service Pack 1a (SP1a) ou o Small Business Server 2000 esteja em execução no Windows 2000 Server Service Pack 4 (SP4).

Os softwares dessa lista foram testados para determinar se as versões são afetadas. Outras versões já não incluem suporte para a atualização de segurança ou podem não ser afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o [site do Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742).

Para obter mais informações sobre como obter o service pack mais recente, consulte o [Artigo 260910 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/260910).

**Inclusão em Service Packs futuros**  
A atualização desse problema poderá ser incluída em um pacote cumulativo de atualizações futuro.

**Informações de instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Sobrescreve arquivos OEM sem notificação
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz backup de arquivos necessários à desinstalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:caminho**
</td>
<td style="border:1px solid black;">
Integra a atualização nos arquivos-fonte do Windows. Esses arquivos se encontram no caminho especificado na opção.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:caminho\]**
</td>
<td style="border:1px solid black;">
Extrai os arquivos sem iniciar o programa de instalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte às opções de instalação utilizadas por versões anteriores do programa de instalação. Para obter mais informações sobre opções com suporte de segurança, consulte o [artigo 262841 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o instalador Update.exe, visite [o site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951). Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [Artigo 824684 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/824684).

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, use o seguinte comando em um prompt de comando do Windows 2000 Service Pack 4:

**Windows2000-kb896424-x86-enu /quiet**

**Observação** O uso da opção **/quiet** eliminará todas as mensagens. Isso inclui a eliminação de mensagens de falha. Os administradores devem usar um dos métodos com suporte para verificar se a instalação foi bem-sucedida quando usarem a opção **/quiet**. Os administradores também deverão analisar o arquivo KB896424.log para obter as mensagens de falha quando usarem essa opção.

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando do Windows XP Service Pack 4:

**Windows2000-kb896424-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com o Software Update Services, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Necessidade de Reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB896424$\\Spuninst.

<p></p>
<table class="dataTable">
<caption>
Opções do Spuninst.exe para as quais existe suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação
</td>
</tr>
</table>
 
**Informações sobre o arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Windows 2000 Service Pack 4 e Small Business Server 2000:

| Nome do arquivo | Versão        | Data                 | Hora  | Tamanho   | Pasta   |
|-----------------|---------------|----------------------|-------|-----------|---------|
| Gdi32.dll       | 5.0.2195.7069 | 7 de outubro de 2005 | 06:19 | 233.744   |         |
| Mf3216.dll      | 5.0.2195.6898 | 24-Mar-2004          | 02:17 | 37.136    |         |
| Win32k.sys      | 5.0.2195.7071 | 6 de outubro de 2005 | 09:33 | 1.638.672 |         |
| Win32k.sys      | 5.0.2195.7071 | 6 de outubro de 2005 | 09:33 | 1.638.672 | UNIPROC |

**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, você pode utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (em inglês).

-   **Verificação de Versão do Arquivo**

    **Observação** Como existem diversas versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.  

        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos talvez não estejam instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.  

        **Observação** Atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Também é possível verificar os arquivos instalados por esta atualização de segurança analisando a seguinte chave do Registro:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB896424\\Filelist

    **Observação** Essa chave do Registro pode não conter uma lista completa de arquivos instalados. Além disso, talvez essa chave do Registro não seja criada corretamente quando um administrador ou um OEM integra ou adiciona a atualização de segurança 896424 aos arquivos originais da instalação do Windows.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) à pessoa citada abaixo por trabalhar conosco para ajudar a proteger os clientes:

-   [eEye Digital Security](http://www.eeye.com/html/) por relatar a vulnerabilidade de metarquivo (CAN-2005-2123).
-   [Venustech AdDLab](http://www.venustech.com.cn), [eEye Digital Security](http://www.eeye.com/html/) e Peter Ferrie da [Symantec Security Response](http://securityresponse.symantec.com) por relatar a vulnerabilidade de metarquivo do Windows (CAN-2005-2124).

**Obtendo Outras Atualizações de Segurança:**

As atualizações para outros problemas de segurança estão disponíveis nos seguintes locais:

-   As atualizações de segurança estão disponíveis no [Centro de Download da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). você poderá encontrá-las com mais facilidade, executando uma pesquisa com a palavra-chave "patch\_de\_segurança".
-   Atualizações para plataformas do cliente estão disponíveis no [site Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747).

**Suporte:**

-   Os clientes nos EUA e Canadá podem receber suporte técnico dos [Serviços de suporte ao produto Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) pelo telefone 1-866-PCSAFETY. As ligações para obter suporte associado a atualizações de segurança são gratuitas.
-   Os clientes de outros países podem obter suporte nas subsidiárias locais da Microsoft. O suporte associado a atualizações de segurança é gratuito. Para obter mais informações sobre como entrar em contato com a Microsoft a fim de obter suporte a problemas, visite o [site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de segurança:**

-   O site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos da Microsoft.
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Catálogo do Windows Update: Para obter mais informações sobre o Catálogo do Windows Update, consulte o [Artigo 323166 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/323166).
-   [Atualização do Office](http://go.microsoft.com/fwlink/?linkid=21135)

**Serviços de Atualização de Software:**

Usando o Microsoft Software Update Services (SUS), os administradores podem implantar de maneira rápida e confiável as últimas atualizações críticas e de segurança em servidores que executem o Windows 2000 e o Windows Server 2003 e em sistemas desktop que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implantar atualizações de segurança usando os serviços de atualização de software, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services**

Usando o WSUS (Windows Server Update Services), os administradores podem implantar de forma rápida e confiável as mais recentes atualizações críticas e de segurança dos sistemas operacionais Windows 2000 e posterior, Office XP e posterior, Exchange Server 2003, e SQL Server 2000 nos sistemas operacionais Windows 2000 e posteriores.

Para obter mais informações sobre como implantar atualizações de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

O SMS (Microsoft Systems Management Server) fornece uma solução corporativa altamente configurável para gerenciar atualizações. Ao usar o SMS, os administradores podem identificar os sistemas baseados no Windows que precisam de atualizações de segurança, bem como executar uma implantação controlada dessas atualizações em toda a empresa com o mínimo de interrupção para os usuários finais. Para obter mais informações sobre como os administradores podem usar o SMS 2003 para implantar atualizações de segurança, visite o [site Gerenciamento de Patches de Segurança do SMS 2003](http://go.microsoft.com/fwlink/?linkid=22939). Os usuários do SMS 2.0 também podem usar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) (site em inglês) para ajudar a implantar atualizações de segurança. Para obter mais informações sobre o SMS, visite o [site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

**Observação:** o SMS usa o Microsoft Baseline Security Analyzer, a Microsoft Office Detection Tool e a Enterprise Update Scanning Tool para oferecer amplo suporte à detecção e à implantação da atualização do boletim de segurança. Algumas atualizações de software podem não ser detectadas por essas ferramentas. Os administradores podem usar os recursos de inventário do SMS nesses casos para apontar as atualizações de sistemas específicos. Para obter mais informações sobre as classificações de gravidade, visite este [site](http://go.microsoft.com/fwlink/?linkid=33341) (em inglês). Algumas atualizações de segurança exigirão direitos administrativos quando o sistema for reiniciado. Os administradores podem usar a Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) (sites em inglês) para instalar essas atualizações.

**Aviso de isenção de responsabilidade:**

As informações fornecidas na Microsoft Knowledge Base são apresentadas "no estado em que se encontram", sem garantia de qualquer tipo. A Microsoft se isenta de todas as garantias, expressas ou implícitas, inclusive as garantias de comercialização e adequação a um propósito específico. Em hipótese alguma a Microsoft Corporation ou seus fornecedores serão responsáveis por quaisquer danos, inclusive danos diretos, indiretos, incidentais, conseqüenciais, danos por lucros cessantes ou danos especiais, mesmo que a Microsoft Corporation ou seus fornecedores tenham sido alertados da possibilidade dos referidos danos. Como alguns estados não permitem a exclusão ou limitação de responsabilidade por danos conseqüenciais ou indiretos, a limitação acima pode não ser aplicável a você.

**Revisões:**

-   V1.0 (8 de novembro de 2005): Boletim publicado.
-   V1.1 (30 de novembro de 2005): Boletim atualizado para corrigir informações sobre o arquivo para as plataformas x64.
-   V1.2 (9 de dezembro de 2008): Boletim atualizado para adicionar uma entrada na seção **Perguntas freqüentes relacionadas a esta atualização de segurança** sobre a revisão secundária do pacote Windows Server 2003. Os clientes que já aplicaram com êxito a atualização anterior não precisam realizar nenhuma ação.

*Built at 2014-04-18T01:50:00Z-07:00*
