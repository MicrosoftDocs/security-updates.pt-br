---
TOCTitle: 'MS06-071'
Title: 'Microsoft Security Bulletin MS06-071 - Crítica'
ms:assetid: 'ms06-071'
ms:contentKeyID: 61233575
ms:mtpsurl: 'https://technet.microsoft.com/pt-BR/library/ms06-071(v=Security.10)'
---

Security Bulletin

Microsoft Security Bulletin MS06-071 - Crítica
==============================================

Vulnerabilidade no Microsoft XML Core Services pode permitir a execução remota de código (928088)
-------------------------------------------------------------------------------------------------

Publicado: terça-feira, 14 de novembro de 2006 | Atualizado: quarta-feira, 15 de novembro de 2006

**Versão:** 1.1

#### Resumo

**Quem deve ler este documento:** Os clientes que usam Microsoft Windows e instalaram Microsoft XML Core Services (MSXML) 4.0 ou Microsoft XML Core Services (MSXML) 6.0

**Impacto da vulnerabilidade:** Execução Remota de Código

**Classificação máxima de gravidade:** Crítica

**Recomendação:** Os clientes que têm as versões vulneráveis do MSXML em seu sistema operacional são afetados e devem implantar esta atualização imediatamente

**Substituição da atualização de segurança:** Esse boletim substitui uma atualização de segurança anterior. Veja a lista completa na seção Perguntas mais freqüentes deste boletim.

**Advertências:** Nenhuma

**Componentes testados do Microsoft Windows:**

**Componentes afetados:**

-   Microsoft XML Core Services 4.0 quando instalado no Windows (todas as versões) – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=24b7d141-6cdf-4fc4-a91b-6f18fe6921d4) (KB927978)
-   Microsoft XML Core Services 6.0 quando instalado no Windows (todas as versões) – [Baixar a atualização](http://www.microsoft.com/downloads/details.aspx?familyid=9ae7f4e9-8228-4098-af71-49c35684c17e) (KB927977)

**Softwares não afetados:**

-   Microsoft XML Core Services 3.0
-   Microsoft XML Core Services 5.0

Os softwares dessa lista foram testados para se determinar se as versões são afetadas. Outras versões já não incluem suporte para a atualização de segurança ou podem não ser afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o [site do Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742).

### Informações Gerais

Sinopse
-------


**Sinopse:**

Esta atualização elimina uma vulnerabilidade recém-descoberta e divulgada publicamente. Cada vulnerabilidade está documentada em sua própria subseção na seção "Detalhes da vulnerabilidade" deste boletim.

Se um usuário tiver feito logon com direitos administrativos, o invasor que explorar com êxito essa vulnerabilidade poderá ter o controle total do sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

Recomendamos que os clientes apliquem a atualização imediatamente.

**Classificação de Gravidade e Identificadores de Vulnerabilidade:**

| Identificadores de Vulnerabilidade                                                                                                | Impacto da Vulnerabilidade | Microsoft XML Core Services 4,0 | Microsoft XML Core Services 6,0 |
|-----------------------------------------------------------------------------------------------------------------------------------|----------------------------|---------------------------------|---------------------------------|
| Vulnerabilidade do Microsoft XML Core Services - [CVE-2006-5745](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5745) | Execução Remota de Código  | Crítica                         | Crítica                         |

Essa [avaliação](http://go.microsoft.com/fwlink/?linkid=21140) baseia-se nos tipos de sistemas afetados pela vulnerabilidade, seus padrões comuns de implantação e o efeito da exploração da vulnerabilidade sobre eles.

Perguntas mais freqüentes relacionadas a esta atualização de segurança
----------------------------------------------------------------------


**Posso implantar esta atualização de segurança depois de aplicar as soluções alternativas fornecidas no Comunicado de Segurança da Microsoft 927892?**  
Os clientes que aplicaram as soluções alternativas fornecidas no Comunicado de Segurança da Microsoft 927892 serão capazes de aplicar esta atualização de segurança sem nenhum problema.

**Tenho uma instalação padrão do Windows sem nenhum aplicativo instalado. Sou afetado por essa vulnerabilidade?**  
Nenhuma versão do Windows inclui as versões vulneráveis do Microsoft XML Core Services.

**Como sei se tenho o Microsoft XML Core Services 4.0 ou o Microsoft XML Core Services 6.0 em meu sistema?**  
As versões vulneráveis do Microsoft XML Core Services 4.0 e do Microsoft XML Core Services 6.0 não são incluídas como padrão em nenhuma versão do Windows. No entanto, elas estão disponíveis para download e também podem ter sido redistribuídas por algum software adicional. Os clientes que desejam determinar se têm o Microsoft XML Core Services 4.0 ou o Microsoft XML Core Services 6.0 em seus sistemas podem seguir os passos descritos a seguir, em “Informações de Atualização de Segurança” para “Verificação de versão de arquivo” e verificar a presença dos arquivos msxml4.dll ou msxml6.dll. Versões do msxlm4.dll anteriores à 4.20.9841.0 e do msxml6.dll anteriores à 6.0.3890.0 são vulneráveis e devem ser atualizadas. Além disso, MBSA 1.2.1, MBSA 2.0, SMS 2.0, SMS 2003 e WSUS também podem ser usados para determinar se esta atualização de segurança é necessária.

Os clientes que têm as versões vulneráveis do Microsoft XML Core Services em seu sistema operacional são afetados e devem implantar esta atualização imediatamente

**O Windows** **Vista** **é vulnerável a este problema?**  
O Windows Vista não inclui uma versão vulnerável do Microsoft XML Core Services. O Windows Vista inclui o msxml6.dll versão 6.10.1129 e não é vulnerável. No entanto, se um aplicativo que instala uma versão vulnerável do Microsoft XML Core Services 4.0 tiver sido aplicado, esta atualização deve ser aplicada.

**Quais são as diferentes versões do Microsoft XML Core Services e que aplicativos as instalam no sistema?**  
Muitos aplicativos podem instalar o Microsoft XML Core Services e não há uma lista completa disponível. Para obter informações sobre as diferentes versões do Microsoft XML Core Services disponíveis e os principais produtos da Microsoft que as instalam, consulte o [Artigo 269238 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/269238).

**Quais atualizações esta versão substitui?**  
Esta atualização de segurança substitui um boletim de segurança anterior. A identificação do boletim de segurança e os componentes afetados estão listados na tabela a seguir.

| ID do Boletim                                                           | Microsoft XML Core Services 4,0 | Microsoft XML Core Services 6,0 |
|-------------------------------------------------------------------------|---------------------------------|---------------------------------|
| [**MS06-061**](http://technet.microsoft.com/security/bulletin/ms06-061) | Substituído                     | Substituído                     |

**Observação** Esta atualização de segurança substitui apenas a atualização de segurança [**MS06-061**](http://technet.microsoft.com/security/bulletin/ms06-061) para Microsoft XML Core Services 4.0 e Microsoft XML Core Services 6.0, visto que tanto o Microsoft XML Core Services 3.0 quanto o Microsoft XML Core Services 5.0 não são afetados**.**

**O suporte estendido da atualização de segurança para Microsoft Windows 98, Windows 98 Second Edition e Windows Millennium Edition terminou no dia 11 de julho de 2006. Ainda uso um desses sistemas operacionais. O que devo fazer?**  
Os ciclos de vida do suporte ao Windows 98, Windows 98 Second Edition e Windows Millennium Edition chegaram ao fim. Os clientes que possuem essas versões de sistema operacional devem priorizar a migração para as versões com suporte, a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do produto Windows, visite o site Microsoft Support Lifecycle Web. Para obter mais informações sobre o período de suporte estendido da atualização de segurança dessas versões de sistema operacional, visite o site Microsoft Product Support Services.

**O suporte estendido para a atualização de segurança do Microsoft Windows NT Workstation 4.0 Service Pack 6a e do Windows 2000 Service Pack 2 foi encerrado em 30 de junho de 2004. O suporte estendido para a atualização de segurança do Microsoft Windows NT Server 4.0 Service Pack 6a foi encerrado em 31 de dezembro de 2004. O suporte estendido para a atualização de segurança do Microsoft Windows 2000 Service Pack 3 foi encerrado em 30 de junho de 2005. Ainda estou usando um desses sistemas operacionais. O que devo fazer?**  
Os ciclos de vida do Windows NT Workstation 4.0 Service Pack 6a, Windows NT Server 4.0 Service Pack 6a, Windows 2000 Service Pack 2 e Windows 2000 Service Pack 3 chegou ao fim. Os clientes que possuem essas versões de sistema operacional devem priorizar a migração para as versões com suporte, a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do produto Windows, visite o [site do Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742). Para obter mais informações sobre o período de suporte estendido da atualização de segurança dessas versões de sistema operacional, visite o [site Microsoft Product Support Services](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que precisarem de suporte adicional para estes produtos deverão entrar em contato com o representante da equipe da conta da Microsoft, o gerente técnico da conta ou o representante do parceiro Microsoft apropriado para obter opções de suporte personalizadas. Os clientes sem um contrato Alliance, Premier ou Authorized podem entrar em contato com o escritório de vendas local da Microsoft. Para obter informações de contato, visite o site de [Informações internacionais da Microsoft](http://go.microsoft.com/fwlink/?linkid=33329), selecione o país e clique em **Go** para ver uma lista de telefones. Ao ligar, peça para falar com o gerente de vendas local de Suporte Premier. Para obter mais informações, consulte a seção [Perguntas mais freqüentes sobre o ciclo de vida do suporte ao produto sistema operacional Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**O suporte estendido para atualização de segurança do Microsoft Windows XP Home Edition Service Pack 1 ou Service Pack 1a, Windows XP Media Center Edition 2002 Service Pack 1, Windows XP Media Center Edition 2004 Service Pack 1, Windows XP Professional Service Pack 1 ou Service Pack 1a e Windows XP Tablet PC Edition Service Pack 1 foi encerrado em 10 de outubro de 2006. Ainda uso um desses sistemas operacionais, o que devo fazer?**  
O suporte ao Windows XP (todas as versões) Service Pack 1 atingiu o final de seu ciclo de vida. Os clientes que possuem essas versões de sistema operacional devem priorizar a migração para as versões com suporte, a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do produto Windows, visite o site Microsoft Support Lifecycle Web. Para obter mais informações sobre o período de suporte estendido da atualização de segurança dessas versões de sistema operacional, visite o site Microsoft Product Support Services.

**Posso usar o MBSA (Microsoft Baseline Security Analyzer) para determinar se esta atualização é necessária?**  
A tabela a seguir fornece o resumo de detecção do MBSA para esta atualização de segurança.

| Produto                                                                        | MBSA 1.2.1 | MBSA 2.0 |
|--------------------------------------------------------------------------------|------------|----------|
| Microsoft XML Core Services 4.0 quando instalado no Windows (todas as versões) | Sim        | Sim      |
| Microsoft XML Core Services 6.0 quando instalado no Windows (todas as versões) | Sim        | Sim      |

Para obter mais informações sobre o MBSA, visite o [site do MBSA](http://go.microsoft.com/fwlink/?linkid=21134). Para obter mais informações sobre os programas que o Microsoft Update e o MBSA 2.0 atualmente não detectam, consulte o [artigo 895660 (em inglês) da Microsoft Knowledge Base.](http://support.microsoft.com/kb/895660)

Para obter mais informações, consulte o [artigo 910723 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/910723).

**Posso usar o SMS (Systems Management Server) para determinar se esta atualização é necessária?**  
A tabela a seguir fornece o resumo de detecção de SMS para esta atualização de segurança.

| Produto                                                                        | SMS 2.0 | SMS 2003 |
|--------------------------------------------------------------------------------|---------|----------|
| Microsoft XML Core Services 4.0 quando instalado no Windows (todas as versões) | Sim     | Sim      |
| Microsoft XML Core Services 6.0 quando instalado no Windows (todas as versões) | Sim     | Sim      |

SMS 2.0 e SMS 2003 Software Update Services (SUS) Feature Pack podem usar MBSA 1.2.1 para detecção e assim têm a mesma limitação listada anteriormente neste boletim relacionada a programas que o MBSA 1.2.1 não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Inventário da Atualização de Segurança (SUIT), pode ser usado pelo SMS para detectar atualizações de segurança. O SMS SUIT usa o mecanismo do MBSA 1.2.1 para detecção. Para obter mais informações sobre SUIT, visite o seguinte [site da Microsoft](http://support.microsoft.com/kb/894154/). Para obter mais informações sobre as limitações da SUIT, consulte o [artigo 306460 da Microsoft Knowledge Base](http://support.microsoft.com/kb/306460/). O SMS SUS Feature Pack também inclui a ferramenta Office Inventory da Microsoft para detectar atualizações necessárias para aplicativos do Microsoft Office.

Para o SMS 2003, a ferramenta Inventário do SMS 2003 para Microsoft Updates pode ser usada pelo SMS para detectar as atualizações de segurança oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate) e que tenham suporte do [Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Para obter mais informações a ferramenta ITMU do SMS 2003, visite o seguinte [site da Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). O SMS 2003 também pode usar a ferramenta Office Inventory da Microsoft para detectar as atualizações necessárias dos aplicativos do Microsoft Office.

Para obter mais informações sobre o SMS, visite o [site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

Para obter mais informações, consulte o [artigo 910723 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/910723).

Detalhes da Vulnerabilidade
---------------------------


#### Vulnerabilidade do Microsoft XML Core Services - CVE-2006-5745:

Existe uma vulnerabilidade no controle ActiveX de XMLHTTP no Microsoft XML Core Services que pode permitir a execução remota de código. O invasor pode explorar a vulnerabilidade criando uma página da Web especialmente desenvolvida que pode potencialmente permitir a execução remota de código se o usuário visitar a página ou clicar em um link em uma mensagem de email. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado. Entretanto, é necessária uma interação do usuário para explorar a vulnerabilidade.

#### Fatores atenuantes da vulnerabilidade do Microsoft XML Core Services - CVE-2006-5745:

-   O Microsoft XML Core Services 4.0 e o Microsoft XML Core Services 6.0 não são incluídos em nenhuma versão do Windows.
-   Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Um invasor não terá como forçar os usuários a visitar a página. Em vez disso, um invasor teria que persuadir os usuários a visitar o site, geralmente fazendo com que eles cliquem em um link em um email ou por um pedido pelo Instant Messenger que leva os usuários ao site do invasor.
-   O invasor que explorar com êxito a vulnerabilidade poderá obter os mesmos direitos de um usuário conectado. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.
-   A zona Sites restritos ajuda a reduzir os ataques que podem tentar explorar essa vulnerabilidade, ao evitar que os controles ActiveX sejam usados durante a leitura de mensagens de email em HTML. No entanto, se um usuário clicar em um link em uma mensagem de email, ele ainda pode estar vulnerável a este problema através do cenário de ataque baseado na Web.
    Por padrão, o Outlook Express 6, o Outlook 2002 e o Outlook 2003 abrem mensagens de email em HTML na zona Sites restritos. Além disso, o Outlook 2000 abre mensagens de email em HTML na zona de Sites restritos se a Atualização de Segurança do Email do Outlook estiver instalada. O Outlook Express 5.5 Service Pack 2 abrirá mensagens de email em HTML na zona Sites Restritos se o [Boletim de Segurança da Microsoft MS04-018](http://technet.microsoft.com/security/bulletin/ms04-018) tiver sido instalado.
-   Por padrão, o Internet Explorer no Windows Server 2003 é executado em um modo restrito, conhecido como [Configuração de Segurança Reforçada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Esse modo define o nível de segurança para a zona da Internet como Alto. Este é um fator atenuante para sites que não tenham sido adicionados à zona Sites confiáveis do Internet Explorer. Consulte a seção Perguntas mais freqüentes desta atualização de segurança para obter mais informações sobre a Configuração de Segurança Reforçada do Internet Explorer.

#### Soluções alternativas para a vulnerabilidade do Microsoft XML Core Services - CVE-2006-5745:

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Quando uma solução alternativa reduz a funcionalidade, ela é indicada na seção a seguir.

-   **Evite que os controles ActiveX de XMLHTTP 4.0 e XMLHTTP 6.0 sejam executados no Internet Explorer.**

    Você pode desativar as tentativas de instanciar esses controles ActiveX no Internet Explorer definindo o kill bit dos controles no Registro.

    **Aviso** O uso incorreto do Editor do Registro pode causar problemas graves e exigir a reinstalação do sistema operacional. A Microsoft não garante a solução de problemas resultantes do uso incorreto do Editor do Registro. Você é responsável pelo uso do Editor do Registro.

    Para obter etapas detalhadas para evitar que um controle seja executado no Internet Explorer, consulte o [artigo 240797 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/240797). Siga as etapas no artigo para criar um valor de Compatibility Flags no Registro e evitar que um objeto COM seja instanciado no Internet Explorer:

    1.  Para definir o kill bit para um CLSID com um valor de {88d969c5-f192-11d4-a65f-0040963251e5} (XMLHTTP 4.0 contido no Microsoft XML Core Services 4.0) e {88d96a0a-f192-11d4-a65f-0040963251e5} (XMLHTTP 6.0 contido no Microsoft XML Core Services 6.0) cole o texto a seguir em um editor de texto como o Bloco de Notas. Em seguida, salve o arquivo usando a extensão de nome de arquivo .reg:

        Windows Registry Editor Versão 5.00

        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{88d969c5-f192-11d4-a65f-0040963251e5}\] "Compatibility Flags"=dword:00000400

        \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{88d96a0a-f192-11d4-a65f-0040963251e5}\] "Compatibility Flags"=dword:00000400

    2.  Você pode aplicar este arquivo .reg em sistemas individuais clicando duas vezes nele. Você também pode aplicá-lo entre domínios usando a Diretiva de Grupo. Para obter mais informações sobre a Diretiva de Grupo, visite estes sites da Microsoft:

        [Conjunto de Diretivas de Grupo](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)

        [O que é o Editor de Objeto de Diretiva de Grupo?](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/47ba1311-6cca-414f-98c9-2d7f99fca8a3.mspx)

        [Ferramentas e configurações principais da Diretiva de Grupo](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)

    **Observação** Você deve reiniciar o Internet Explorer para que as alterações tenham efeito.

    **Impacto da solução alternativa:** Os sites que usam os controles ActiveX XMLHTTP 4.0 ou XMLHTTP 6.0 podem deixar de ser exibidos ou funcionar corretamente.

    Esta atualização de segurança não reverte automaticamente o kill bit para estes controles ActiveX. Para reverter o kill bit siga estes passos:

    1.  Para reverter o kill bit, cole o texto seguinte num editor de texto como o Bloco de Notas. Em seguida, salve o arquivo usando a extensão de nome de arquivo .reg:

        Windows Registry Editor Versão 5.00

        \[-HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{88d969c5-f192-11d4-a65f-0040963251e5}\]

        \[-HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{88d96a0a-f192-11d4-a65f-0040963251e5}\]

    2.  Você pode aplicar este arquivo .reg em sistemas individuais clicando duas vezes nele. Você também pode aplicá-lo entre domínios usando a Diretiva de Grupo. Para obter mais informações sobre a Diretiva de Grupo, visite estes sites da Microsoft:

        [Conjunto de Diretivas de Grupo](http://technet2.microsoft.com/windowsserver/en/library/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd1033.mspx?mfr=true)

        [O que é o Editor de Objeto de Diretiva de Grupo?](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/47ba1311-6cca-414f-98c9-2d7f99fca8a3.mspx)

        [Ferramentas e configurações principais da Diretiva de Grupo](http://technet2.microsoft.com/windowsserver/en/library/e926577a-5619-4912-b5d9-e73d4bdc94911033.mspx?mfr=true)

    **Observação** Você deve reiniciar o Internet Explorer para que as alterações tenham efeito.

-   **Negue acesso aos CLSIDs afetados para Microsoft XML Core Services 4.0 ({88D969C5-F192-11D4-A65F-0040963251E5}) e para Microsoft XML Core Services 6.0 ({88D96A0A-F192-11D4-A65F-0040963251E5}) no Registro**

    Para modificar o acesso ao CLSIDs afetados para Windows 2000, siga estas etapas:

    1.  Clique em **Iniciar**, clique em **Executar**, digite "**rregedt32**" (sem as aspas) e clique em **OK**.
    2.  Expanda **HKEY\_CLASSES\_ROOT** e, em seguida, expanda **CLSID**.
    3.  **Para Microsoft XML Core Services 4.0, clique em**: **{88D969C5-F192-11D4-A65F-0040963251E5}**

        Para Microsoft XML Core Services 6.0, clique em: **{88D96A0A-F192-11D4-A65F-0040963251E5}**

    4.  Clique em **Segurança** e, em seguida, clique em **Permissões**.

        **Observação** Anote as permissões que estão relacionadas nessa caixa de diálogo para que possa restaurá-las aos seus valores originais mais tarde.

    5.  Clique para desmarcar a caixa de seleção **Autorizar as permissões de herança do pai para propagar para este objeto**. Você é solicitado a clicar em **Copiar**, **Remover** ou **Cancelar**. Clique em **Remover** e em **OK**.
    6.  Uma mensagem que afirma que ninguém poderá acessar essa chave do Registro será exibida. Clique em **Sim** quando solicitado.

    Para modificar o acesso aos CLSIDs afetados para Windows XP Service Pack 2 e sistemas operacionais posteriores, siga estas etapas:

    1.  Clique em **Iniciar**, clique em **Executar**, digite "**rregedt32**" (sem as aspas) e clique em **OK**.
    2.  Expanda **HKEY\_CLASSES\_ROOT** e, em seguida, expanda **CLSID**.
    3.  **Para Microsoft XML Core Services 4.0, clique em**: **{88D969C5-F192-11D4-A65F-0040963251E5}**

        Para Microsoft XML Core Services 6.0, clique em: **{88D96A0A-F192-11D4-A65F-0040963251E5}**

    4.  Clique em **Editar** e em **Permissões**.

        **Observação** Anote as permissões que estão relacionadas nessa caixa de diálogo para que possa restaurá-las aos seus valores originais mais tarde.

    5.  Clique em **Avançado**.
    6.  Clique para desmarcar a caixa de seleção **Herdar do pai as entradas de permissão aplicáveis a objetos filho. Incluí-las nas entradas explicitamente definidas aqui**. Você é solicitado a clicar em **Copiar**, **Remover** ou **Cancelar**. Clique em **Remove**r e marque **OK**.
    7.  Uma mensagem que afirma que ninguém poderá acessar essa chave do Registro será exibida. Clique em **Sim** quando solicitado e, então, clique em **OK** para fechar a caixa de diálogo **Permissões para {88D969C5-F192-11D4-A65F-0040963251E5}** ou **Permissões para {88D96A0A-F192-11D4-A65F-0040963251E5}** (dependendo do CLSID escolhido).

    **Impacto da solução alternativa:** Os sites que usam os controles ActiveX XMLHTTP 4.0 ou XMLHTTP 6.0 podem deixar de ser exibidos ou funcionar corretamente.

-   **Configure o Internet Explorer para notificá-lo antes da execução de scripts ativos ou desative os scripts ativos na zona de segurança da Internet e da intranet local.**

    Para se proteger contra essa vulnerabilidade, altere as configurações para ser notificado antes da execução de scripts ativos ou desabilite os scripts ativos na zona de segurança da Internet e da intranet local. Para isso, siga estas etapas:

    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
    2.  Clique na guia **Segurança**.
    3.  Clique em **Internet** e, em seguida, clique em **Nível Personalizado**.
    4.  Em **Configurações**, na seção **Script**, em **Scripts Ativos**, clique em **Avisar** ou **Desativar** e, em seguida, clique em **OK**.
    5.  Clique em **Intranet local** e, em seguida, clique em **Nível Personalizado**.
    6.  Em **Configurações**, na seção **Script**, em **Scripts Ativos**, clique em **Avisar** ou **Desativar** e, em seguida, clique em **OK**.
    7.  Clique em **OK** duas vezes para retornar ao Internet Explorer.

    **Observação** A desativação dos scripts ativos nas zonas de segurança da Internet e da intranet local poderá fazer com que alguns sites não funcionem corretamente. Se você encontrar dificuldades ao usar um site após alterar a configuração, mas tiver certeza de que o site é seguro, é possível adicionar esse site à lista de sites confiáveis. Isso permitirá que o site funcione adequadamente.

    **Observação** Depois de definir o Internet Explorer para solicitar confirmação antes de executar controles ActiveX e/ou scripts ativos na zona da Internet e da Intranet local, você pode adicionar sites confiáveis à zona de Sites confiáveis do Internet Explorer. Isso permitirá que você continue usando os sites confiáveis exatamente como faz atualmente, enquanto ajuda a proteger-se de ataques em sites não confiáveis. É recomendável adicionar somente sites nos quais você confia à zona de Sites confiáveis.

    Para isso, siga estas etapas:

    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique na guia **Segurança**.
    2.  Na caixa **Selecione uma zona de conteúdo da Web para especificar suas configurações de segurança**, clique em **Sites Confiáveis** e, em seguida, clique em **Sites**.
    3.  Se desejar adicionar sites que não requerem um canal criptografado, clique para desmarcar a caixa de seleção **Exigir verificação do servidor (https:) para todos os sites desta zona**.
    4.  Na caixa **Adicionar este site à zona,** digite a URL de um site em que confia e, em seguida, clique em **Adicionar**.
    5.  Repita essas etapas para cada site que você deseja adicionar à zona.
    6.  Clique em **OK** duas vezes para aceitar as alterações e retornar ao Internet Explorer.

    **Observação** Adicione os sites que você considerar que não tenham ação mal-intencionada ao seu computador. Existem dois sites específicos que você deve adicionar: "\*.windowsupdate.microsoft.com" e “\*.update.microsoft.com” (sem as aspas). Esses sites hospedam a atualização e exigem um controle ActiveX para instalá-la.

    **Impacto da solução alternativa:** Há efeitos colaterais para notificação antes da execução de scripts ativos. Muitos sites que não estão na Internet ou na intranet usam scripts ativos para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou bancário online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução dos scripts ativos é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Para cada notificação, se achar que confia no site que está visitando, clique em Sim para executar os scripts ativos. Se não quiser ser avisado para todos esses sites, use os passos descritos em “Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer”.

-   **Configure o Internet Explorer para notificá-lo antes da execução de controles ActiveX ou desative os controles ActiveX na zona de segurança da Internet e da intranet local.**

    Você pode se proteger contra essa vulnerabilidade, alterando as configurações do Internet Explorer para avisá-lo antes de executar os controles ActiveX. Para isso, siga estas etapas:

    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
    2.  Clique na guia **Segurança**.
    3.  Clique em **Internet** e, em seguida, clique em **Nível Personalizado**.
    4.  Em **Configurações**, na seção **Plug-ins e controles ActiveX**, em **Executar controles ActiveX e plug-ins**, clique em **Avisar** ou em **Desativar** e, em seguida, clique em **OK**.
    5.  Clique em **Intranet local** e, em seguida, clique em **Nível Personalizado**.
    6.  Em **Configurações**, na seção **Plug-ins e controles ActiveX**, em **Executar controles ActiveX e plug-ins**, clique em **Avisar** ou em **Desativar** e, em seguida, clique em **OK**.
    7.  Clique em **OK** duas vezes para retornar ao Internet Explorer.

    **Observação** Depois de definir o Internet Explorer para solicitar confirmação antes de executar controles ActiveX e/ou scripts ativos na zona da Internet e da Intranet local, você pode adicionar sites confiáveis à zona de Sites confiáveis do Internet Explorer. Isso permitirá que você continue usando os sites confiáveis exatamente como faz atualmente, enquanto ajuda a proteger-se de ataques em sites não confiáveis. É recomendável adicionar somente sites nos quais você confia à zona de Sites confiáveis.

    Para isso, siga estas etapas:

    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique na guia **Segurança**.
    2.  Na caixa **Selecione uma zona de conteúdo da Web para especificar suas configurações de segurança**, clique em **Sites Confiáveis** e, em seguida, clique em **Sites**.
    3.  Se desejar adicionar sites que não requeiram um canal criptografado, clique para desmarcar a caixa de diálogo **Exigir verificação do servidor (https:) para todos os sites desta zona**.
    4.  Na caixa **Adicionar este site à zona,** digite a URL de um site em que confia e, em seguida, clique em **Adicionar**.
    5.  Repita essas etapas para cada site que você deseja adicionar à zona.
    6.  Clique em **OK** duas vezes para aceitar as alterações e retornar ao Internet Explorer.

    **Observação** Adicione os sites que você considerar que não tenham ação mal-intencionada ao seu computador. Existem dois sites específicos que você deve adicionar: "\*.windowsupdate.microsoft.com" e “\*.update.microsoft.com” (sem as aspas). Esses sites hospedam a atualização e exigem um controle ActiveX para instalá-la.

    **Impacto da solução alternativa:** A notificação antes da execução de controles ActiveX apresenta efeitos colaterais. Muitos sites que não estão na Internet ou na intranet usam o ActiveX para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou um banco online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução dos controles ActiveX é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Para cada notificação, se você sentir que confia no site que está visitando, clique em **Sim** para executar os controles ActiveX. Se não quiser ser avisado para todos esses sites, use os passos descritos em “Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer”.

-   **Defina as configurações de zona de segurança da Internet e da intranet local como “Alta” antes de executar controles ActiveX e scripts ativos nessas zonas.**

    Você pode ajudar a se proteger dessa vulnerabilidade ao alterar suas configurações da zona de segurança da Internet para receber um aviso antes de executar controles ActiveX e scripts ativos. É possível fazer isso configurando a segurança do navegador como **Alta**.

    Para elevar o nível de segurança da navegação no Microsoft Internet Explorer:

    1.  No menu **Ferramentas** do Internet Explorer, clique em **Opções da Internet**.
    2.  Na caixa de diálogo **Opções da Internet**, clique na guia **Segurança** e, em seguida, no ícone **Internet**.
    3.  Em **Nível de segurança para esta zona**, mova o controle deslizante para **Alto**. Isso define o nível de segurança para todos os sites visitados como Alto.

    **Observação** Se o controle deslizante não estiver visível, clique em **Nível padrão** e mova o controle deslizante para **Alto**.

    **Observação** A configuração do nível como Alto pode fazer com que alguns sites não funcionem corretamente. Se você encontrar dificuldades ao usar um site após alterar a configuração, mas tiver certeza de que o site é seguro, é possível adicionar esse site à lista de sites confiáveis. Isso permite que o site funcione corretamente, mesmo com a configuração de segurança alta.

    Como alternativa, é possível alterar as configurações para ser notificado antes de executar os controles ActiveX, seguindo estas etapas:

    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
    2.  Clique na guia **Segurança**.
    3.  Clique em **Internet** e, em seguida, clique em **Nível Personalizado**.
    4.  Em **Configurações**, na seção **Plug-ins e controles ActiveX**, em **Executar controles ActiveX e plug-ins**, clique em **Avisar**.
    5.  Na seção **Script**, em **Scripts Ativos**, clique em **Avisar** e, em seguida, clique em **OK**.
    6.  Clique em **Intranet local** e, em seguida, clique em **Nível Personalizado**.
    7.  Em **Configurações**, na seção **Plug-ins e controles ActiveX**, em **Executar controles ActiveX e plug-ins**, clique em **Avisar**.
    8.  Na seção **Script**, em **Scripts Ativos**, clique em **Avisar**.
    9.  Clique em **OK** duas vezes para retornar ao Internet Explorer.

    **Impacto da solução alternativa:** A notificação antes da execução de controles ActiveX apresenta efeitos colaterais. Muitos sites que não estão na Internet ou na intranet usam o ActiveX para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou um banco online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução dos controles ActiveX é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Para cada notificação, se você sentir que confia no site que está visitando, clique em **Sim** para executar os controles ActiveX. Se você não deseja ser notificado para todos esses sites, use a solução alternativa “Restringir sites a apenas sites confiáveis”.

#### Perguntas mais freqüentes sobre a vulnerabilidade do Microsoft XML Core Services - CVE-2006-5745:

**Qual é o escopo da vulnerabilidade?**  
Esta é uma vulnerabilidade que pode permitir a execução remota de código. O invasor pode explorar a vulnerabilidade criando uma página da Web especialmente criada que pode potencialmente permitir a execução remota de código se o usuário visitar a página ou clicar em um link em uma mensagem de email especialmente criada. Se um usuário tiver feito logon com direitos administrativos, o invasor que explorar com êxito essa vulnerabilidade poderá ter o controle total do sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

**O que provoca a vulnerabilidade?**  
Se dados inesperados forem transmitidos, o controle ActiveX XMLHTTP incluído no Microsoft XML Core Services pode provocar uma falha no Internet Explorer, de forma que ele autorize a execução de códigos.

**O que é o Microsoft XML Core Services (MSXML)?**  
O Microsoft XML Core Services (MSXML) fornece implementações dos seguintes programas, em conformidade com padrões: XML 1.0 (APIs DOM e SAX2), XML Schema (XSD) 1.0, XPath 1.0 e XSLT 1.0. Permite aos desenvolvedores criar aplicativos baseados em XML em Jscript, Visual Basic Scripting Edition (VBScript), Visual Basic 6.0 e C++ nativo que ofereçam interoperabilidade com outros aplicativos que aderem ao padrão XML 1.0. Consulte o [site do MSDN](http://msdn.microsoft.com/library/default.asp?url=/library/en-us/xmlsdk/html/b24aafc2-bf1b-4702-bf1c-b7ae3597eb0c.asp) para obter mais informações sobre MSXML.

**Para que um invasor pode usar a vulnerabilidade?**  
Um invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado.

**De que forma o invasor pode explorar a vulnerabilidade?**  
O invasor pode hospedar um site especialmente projetado para explorar essa vulnerabilidade através do Internet Explorer e, então, persuadir um usuário a exibir o site. Isso também pode incluir sites que aceitam conteúdo ou anúncios fornecidos pelo usuário, sites que hospedam conteúdo ou anúncios fornecidos pelo usuário e sites comprometidos. Esses sites podem ter conteúdo especialmente criado para explorar essa vulnerabilidade. Em todos os casos, entretanto, um invasor não teria como forçar os usuários a visitarem os sites. Em vez disso, um invasor tem que persuadir os usuários a visitar o site, geralmente fazendo com que eles cliquem em um link em um email ou por um pedido pelo Instant Messenger que leva o usuário ao site do invasor. Também é possível exibir conteúdo da Web próprio para a finalidade usando anúncios de banner ou outros métodos para implantar conteúdo da Web nos sistemas afetados.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
Esta vulnerabilidade requer que um usuário esteja conectado e visite um site para que uma ação mal-intencionada ocorra. Portanto, os sistemas nos quais o Internet Explorer é usado com freqüência, como estações de trabalho ou servidores de terminal, estão mais expostos a essa vulnerabilidade. Os sistemas que não são usados normalmente para visitar sites, como a maioria dos sistemas de servidor, correm menos riscos.

**Estou usando o Internet Explorer no Windows Server 2003. Isso atenua essas vulnerabilidades?**  
Sim. Por padrão, o Internet Explorer no Windows Server 2003 é executado em um modo restrito, conhecido como [Configuração de Segurança Reforçada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Esse modo define o nível de segurança para a zona da Internet como Alto. Este é um fator atenuante para sites que não tenham sido adicionados à zona Sites confiáveis do Internet Explorer.

**O que é a Configuração de Segurança Reforçada do Internet Explorer?**  
A Configuração de Segurança Reforçada do Internet Explorer é um grupo de configurações predefinidas do Internet Explorer que reduz a probabilidade de um usuário ou administrador baixar e executar, em um servidor, conteúdo da Web especialmente criado. A Configuração de Segurança Reforçada do Internet Explorer reduz o risco, modificando várias configurações referentes à segurança. Isso inclui as configurações da guia **Segurança** e da guia **Avançado** na caixa de diálogo **Opções da Internet**. Algumas das importantes modificações incluem:

-   O nível de segurança para a zona da Internet é definido como **Alto**. Esta configuração desabilita scripts, controles ActiveX conteúdo da MSJVM (Microsoft Java Virtual Machine - máquina virtual da Microsoft) e downloads de arquivos.
-   A detecção automática de sites da intranet é desabilitada. Essa definição atribui todos os sites da intranet e todos os caminhos de UNC (Convenção universal de nomenclatura), que não estão listados explicitamente na zona de intranet local, para a zona da Internet.
-   A instalação de extensões de navegador que não são da Microsoft e sob demanda são desabilitadas. Essa definição evita que páginas da Web instalem componentes automaticamente e evita a execução de extensões que não são da Microsoft.
-   O conteúdo de multimídia é desabilitado. Essa definição evita a execução de música, animações e clipes de vídeo.

Para obter mais informações sobre a Configuração de Segurança Reforçada do Internet Explorer, consulte o guia Gerenciamento de Configurações de Segurança Avançadas do Internet Explorer neste [site](http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en%20http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en).

**O que a atualização faz?**  
A atualização elimina a vulnerabilidade, modificando o modo como o controle ActiveX XMLHTTP executa a validação de parâmetros.

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Sim. Essa vulnerabilidade foi divulgada publicamente. Ela recebeu o número CVE-2006-5745 da lista Common Vulnerability and Exposure.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Sim. Quando o boletim de segurança foi lançado, a Microsoft recebeu informações de que essa vulnerabilidade tinha sido explorada.

**A aplicação dessa atualização de segurança ajuda a proteger os clientes contra código divulgado publicamente que tente explorar essa vulnerabilidade?**  
Sim. Essa atualização de segurança elimina a vulnerabilidade que está sendo explorada atualmente. A vulnerabilidade abordada recebeu o número CVE-2006-5745 da lista Common Vulnerability and Exposure.

Informações de atualização de segurança
---------------------------------------


**Softwares afetados:**

Para obter informações sobre uma atualização de segurança específica para seu software afetado, clique no link apropriado:

#### Microsoft XML Core Services 4 quando instalado no Windows (todas as versões)

**Inclusão em Service Packs futuros**
A atualização desse problema poderá ser incluída em um conjunto de atualizações futuro.

**Informações sobre instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando.
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte às opções de instalação utilizadas por versões anteriores do programa de instalação. Para obter mais informações sobre opções com suporte de segurança, consulte o [artigo 262841 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o instalador Update.exe, visite [o site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951). Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [artigo 824684 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/824684).

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, use o comando a seguir em um prompt de comando do Windows 2000 Service Pack 4, Microsoft Windows XP Service Pack 2, Microsoft Windows Server 2003 ou Microsoft Windows Server 2003 Service Pack 1:

**msxml4-KB927978-enu /quiet**

**Observação** O uso da opção **/quiet** suprimirá todas as mensagens. Isso inclui a eliminação de mensagens de falha. Os administradores devem usar um dos métodos com suporte para verificar se a instalação foi bem-sucedida quando usarem a opção **/quiet**. Os administradores também devem analisar o arquivo KB927978.log para obter informações sobre quaisquer mensagens de falha quando usarem essa opção.

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando do Windows 2000 Service Pack 4, Microsoft Windows XP Service Pack 2, Microsoft Windows Server 2003 ou Microsoft Windows Server 2003 Service Pack 1:

**msxml4-KB927978-enu /norestart**

**Observação** Todos os parâmetros de linha de comando se baseiam no Windows Installer 3.0. Os clientes com o Windows Installer 2.0 podem executar o comando a seguir para fazer uma instalação silenciosa, suprimir a reinicialização e coletar um log detalhado:

**msxml4-KB927978-enu /q REBOOT=ReallySuppress /l\*v c:\\KB927978.log**

Para obter informações sobre como implantar esta atualização de segurança com o Software Update Services, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Requisitos de reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Esta versão do Microsoft XML Core Services é instalada em um modo lado-a-lado com versões anteriores do MSXML4. Siga estas etapas para remover a atualização de segurança:

1.  Remova a atualização de segurança 927978 usando a ferramenta Adicionar ou Remover Programas no Painel de Controle.
2.  Exclua o arquivo Msxml4.dll da pasta %SystemRoot%\\System32.
3.  Corrija o Msxml4.dll anterior usando a ferramenta Adicionar ou Remover Programas no Painel de Controle.

**Observação** As versões anteriores dos arquivos Msxml4.dll e Msxml4r.dll são restauradas tanto à pasta %SystemRoot%\\System32, quanto à pasta lado-a-lado %SystemRoot%\\WinSxS.

**Informações sobre o arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Microsoft XML Core Services 4.0:

| Nome do arquivo | Versão      | Data                  | Hora | Tamanho |
|-----------------|-------------|-----------------------|------|---------|
| MSXML4.dll      | 4.20.9841.0 | 4 de novembro de 2006 | 2:14 | 1,18 MB |

**Observação** Esta atualização de segurança é instalada tanto na pasta %SystemRoot%\\System32, quanto na pasta lado-a-lado %SystemRoot%\\WinSxS.

**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, é possível utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Consulte a seção de perguntas mais freqüentes, “Posso usar o MBSA (Microsoft Baseline Security Analyzer) para determinar se esta atualização é necessária?” na seção Perguntas mais freqüentes relacionadas a esta atualização de segurança, anteriormente neste boletim.

-   **Verificação de versão de arquivo**

    **Observação** Como existem várias versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.
        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos podem não estar instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.
        **Observação** Atributos com versão diferente da versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

#### Microsoft XML Core Services 6 quando instalado no Windows (todas as versões)

**Inclusão em Service Packs futuros**
A atualização desse problema poderá ser incluída em um conjunto de atualizações futuro.

**Informações sobre instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando.
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte às opções de instalação utilizadas por versões anteriores do programa de instalação. Para obter mais informações sobre opções com suporte de segurança, consulte o [artigo 262841 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o instalador Update.exe, visite [o site Microsoft TechNet](http://go.microsoft.com/fwlink/?linkid=38951). Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [artigo 824684 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/824684).

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, use o comando a seguir em um prompt de comando do Windows 2000 Service Pack 4, Microsoft Windows XP Service Pack 2, Microsoft Windows Server 2003 ou Microsoft Windows Server 2003 Service Pack 1:

**msxml6-KB927977-enu-x86 /quiet**

**Observação** O uso da opção **/quiet** suprimirá todas as mensagens. Isso inclui a eliminação de mensagens de falha. Os administradores devem usar um dos métodos com suporte para verificar se a instalação foi bem-sucedida quando usarem a opção **/quiet**. Os administradores também devem analisar o arquivo KB927977.log para obter informações sobre quaisquer mensagens de falha quando usarem essa opção.

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando do Windows 2000 Service Pack 4, Microsoft Windows XP Service Pack 2, Microsoft Windows Server 2003 ou Microsoft Windows Server 2003 Service Pack 1:

**msxml6-KB927977-enu-x86 /norestart**

**Observação** Todos os parâmetros de linha de comando se baseiam no Windows Installer 3.0. Os clientes com o Windows Installer 2.0 podem executar o comando a seguir para fazer uma instalação silenciosa, suprimir a reinicialização e coletar um log detalhado:

**msxml6-KB927977-enu-x86 /q REBOOT=ReallySuppress /l\*v c:\\KB927977.log**

Para obter informações sobre como implantar esta atualização de segurança com o Software Update Services, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21125). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Requisitos de reinicialização**

É necessário reiniciar o sistema depois de aplicar esta atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

**Observação** A remoção desta atualização de segurança para Microsoft XML Core Services 6 remove completamente o MSXML6 do computador.

**Informações sobre o arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Microsoft XML Core Services 6.0:

| Nome do arquivo | Versão     | Data                  | Hora | Tamanho |
|-----------------|------------|-----------------------|------|---------|
| MSXML6.dll      | 6.0.3890.0 | 4 de novembro de 2006 | 8:25 | 1,25 MB |

**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, é possível utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Consulte a seção de perguntas mais freqüentes, “Posso usar o MBSA (Microsoft Baseline Security Analyzer) para determinar se esta atualização é necessária?” na seção Perguntas mais freqüentes relacionadas a esta atualização de segurança, anteriormente neste boletim.

-   **Verificação de versão de arquivo**

    **Observação** Como existem várias versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.
        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos podem não estar instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.
        **Observação** Atributos com versão diferente da versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da chave do Registro**

    Também é possível verificar os arquivos instalados por esta atualização de segurança analisando a seguinte chave do Registro:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\MSXML 6.0 Parser and SDK\\CurrentVersion

    **Observação** Essa chave do Registro pode não conter uma lista completa de arquivos instalados. Além disso, essa chave do Registro pode não ser criada corretamente se um administrador ou um OEM integrar ou adicionar a atualização de segurança 927977 aos arquivos-fonte da instalação do Windows.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) à pessoa citada abaixo por trabalhar conosco para ajudar a proteger os clientes:

-   Robert Freeman, da [ISS](http://www.iss.net/), por trabalhar conosco na vulnerabilidade do Microsoft XML Core Services ([CVE-2006-5745](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5745)).
-   Dror Shalev e Moti Jospeh, da [Checkpoint](http://www.checkpoint.com/), por trabalharem conosco na vulnerabilidade do Microsoft XML Core Services ([CVE-2006-5745](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-5745)).

**Obtendo outras atualizações de segurança:**

As atualizações para outros problemas de segurança estão disponíveis nos seguintes locais:

-   As atualizações de segurança estão disponíveis no [Centro de Download da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). você poderá encontrá-las com mais facilidade, executando uma pesquisa com a palavra-chave "patch\_de\_segurança".
-   Atualizações para plataformas do cliente estão disponíveis no [site Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747).

**Suporte:**

-   Os clientes nos EUA e Canadá podem receber suporte técnico dos [Serviços de suporte ao produto Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) pelo telefone 1-866-PCSAFETY. As ligações para obter suporte associado a atualizações de segurança são gratuitas.
-   Os clientes de outros países podem obter suporte nas subsidiárias locais da Microsoft. O suporte associado a atualizações de segurança é gratuito. Para obter mais informações sobre como entrar em contato com a Microsoft a fim de obter suporte a problemas, visite o [site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de segurança:**

-   O site [Microsoft TechNet Security](http://go.microsoft.com/fwlink/?linkid=21132) fornece informações adicionais sobre segurança em produtos da Microsoft.
-   [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133)
-   [Microsoft Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120)
-   [Microsoft Baseline Security Analyzer](http://go.microsoft.com/fwlink/?linkid=21134) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Catálogo do Windows Update: Para obter mais informações sobre o Catálogo do Windows Update, consulte o [artigo 323166 (em inglês) da Microsoft Knowledge Base](http://support.microsoft.com/kb/323166).
-   [Atualização do Office](http://go.microsoft.com/fwlink/?linkid=21135)

**Software Update Services:**

Usando o Microsoft Software Update Services (SUS), os administradores podem implantar de maneira rápida e confiável as últimas atualizações críticas e de segurança em servidores que executem o Windows 2000 e o Windows Server 2003 e em sistemas desktop que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implantar atualizações de segurança usando os serviços de atualização de software, visite o [site Software Update Services](http://go.microsoft.com/fwlink/?linkid=21133).

**Windows Server Update Services:**

Usando o WSUS (Windows Server Update Services), os administradores podem implantar de forma rápida e confiável as mais recentes atualizações críticas e de segurança dos sistemas operacionais Windows 2000 e posterior, Office XP e posterior, Exchange Server 2003, e SQL Server 2000 nos sistemas operacionais Windows 2000 e posteriores.

Para obter mais informações sobre como implantar atualizações de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://go.microsoft.com/fwlink/?linkid=50120).

**Systems Management Server:**

O SMS (Microsoft Systems Management Server) fornece uma solução corporativa altamente configurável para gerenciar atualizações. Ao usar o SMS, os administradores podem identificar os sistemas baseados no Windows que precisam de atualizações de segurança, bem como executar uma implantação controlada dessas atualizações em toda a empresa com o mínimo de interrupção para os usuários finais. Para obter mais informações sobre como os administradores podem usar o SMS 2003 para implantar atualizações de segurança, visite o [site Gerenciamento de Patches de Segurança do SMS 2003](http://go.microsoft.com/fwlink/?linkid=22939). Os usuários do SMS 2.0 também podem usar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) (site em inglês) para ajudar a implantar atualizações de segurança. Para obter mais informações sobre o SMS, visite o [site do SMS](http://go.microsoft.com/fwlink/?linkid=21158).

**Observação** O SMS usa o Microsoft Baseline Security Analyzer, a Microsoft Office Detection Tool e a Enterprise Update Scanning Tool para oferecer amplo suporte à detecção e à implantação da atualização do boletim de segurança. Algumas atualizações de software podem não ser detectadas por essas ferramentas. Os administradores podem usar os recursos de inventário do SMS nesses casos para apontar as atualizações de sistemas específicos. Para obter mais informações sobre as classificações de gravidade, visite este [site](http://go.microsoft.com/fwlink/?linkid=33341) (em inglês). Algumas atualizações de segurança exigirão direitos administrativos quando o sistema for reiniciado. Os administradores podem usar a Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) (sites em inglês) para instalar essas atualizações.

**Aviso de isenção de responsabilidade:**

As informações fornecidas na Microsoft Knowledge Base são apresentadas "no estado em que se encontram", sem garantia de qualquer tipo. A Microsoft se isenta de todas as garantias, expressas ou implícitas, inclusive as garantias de comercialização e adequação a um propósito específico. Em hipótese alguma a Microsoft Corporation ou seus fornecedores serão responsáveis por quaisquer danos, inclusive danos diretos, indiretos, incidentais, conseqüenciais, danos por lucros cessantes ou danos especiais, mesmo que a Microsoft Corporation ou seus fornecedores tenham sido alertados da possibilidade dos referidos danos. Como alguns estados não permitem a exclusão ou limitação de responsabilidade por danos conseqüenciais ou indiretos, a limitação acima pode não ser aplicável a você.

**Revisões:**

-   V1.0 (14 de novembro de 2006): Boletim publicado.
-   V1.1 (15 de novembro de 2006): Boletim atualizado: o nome do executável de msxml6 foi atualizado com o nome correto e o arquivo de log foi atualizado com o número KB correto. Esclarecimentos adicionais também foram adicionados com relação a quais componentes do Boletim anterior esta atualização substitui.

*Built at 2014-04-18T01:50:00Z-07:00*
