---
TOCTitle: 'MS06-050'
Title: 'Microsoft  MS06-050 - Importante'
ms:assetid: 'ms06-050'
ms:contentKeyID: 61233554
ms:mtpsurl: 'https://technet.microsoft.com/pt-BR/library/ms06-050(v=Security.10)'
---



Microsoft  MS06-050 - Importante
=================================================

Vulnerabilidades na biblioteca de objetos de hiperlink do Microsoft Windows podem permitir a execução remota de código (920670)
-------------------------------------------------------------------------------------------------------------------------------

Publicado: terça-feira, 8 de agosto de 2006
  
**Versão:** 1.0

#### Resumo

**Quem deve ler este documento:** Clientes que usam o Microsoft Windows

**Impacto da vulnerabilidade:** Execução Remota de Código

**Classificação máxima de gravidade:** Importante

**Recomendação:** Os clientes devem aplicar a atualização assim que possível

**Substituição da atualização de segurança:** esse boletim substitui uma atualização de segurança anterior. Veja a lista completa na seção Perguntas mais freqüentes deste boletim.

**Advertências:** Nenhuma

**Locais de softwares testados e de download de atualização de segurança:**

**Softwares afetados:**

-   Microsoft Windows 2000 Service Pack 4 — [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=bfe3f869-08be-4f13-97a1-7274ad44c7fb)
-   Microsoft Windows XP Service Pack 1 e Microsoft Windows XP Service Pack 2 – [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=2d014bac-f03d-474a-a7ab-49e8ead8edb0)
-   Microsoft Windows XP Professional x64 Edition – [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=cae094e4-64a0-4577-986b-4d6c131806d9)
-   Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1 – [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=21d1e864-4517-4353-8477-b4cd3c6187c0)
-   Microsoft Windows Server 2003 para sistemas baseados no Itanium e Microsoft Windows Server 2003 com SP1 para sistemas baseados no Itanium – [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=bc60b6c3-ada8-48ab-a63d-b2f1c9320b0d)
-   Microsoft Windows Server 2003 x64 Edition - [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=9d2ba5d1-6f91-47b4-8cc1-dcd44baaa6ce)

Os softwares dessa lista foram testados para se determinar se as versões são afetadas. Outras versões já não incluem suporte para a atualização de segurança ou podem não ser afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o [site do Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742).

**Observação** As atualizações de segurança do Microsoft Windows Server 2003, Windows Server 2003 Service Pack 1 e Windows Server 2003 x64 Edition também se aplicam ao Windows Server 2003 R2.

### Informações Gerais

Sinopse
-------

<span></span>
**Sinopse:**

Esta atualização elimina duas vulnerabilidades descobertas recentemente. Cada vulnerabilidade está documentada em sua própria subseção na seção "Detalhes da vulnerabilidade" deste boletim.

Se um usuário tiver feito logon com direitos administrativos, o invasor que explorar com êxito essa vulnerabilidade poderá ter o controle total do sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

A interação do usuário é obrigatória para que um invasor explore estas vulnerabilidades.

Recomendamos que os clientes apliquem a atualização logo que possível.

**Classificação de Gravidade e Identificadores de Vulnerabilidade:**

| Identificadores de Vulnerabilidade                                                                                                                | Impacto da Vulnerabilidade | Windows 2000 Service Pack 4 | Windows XP Service Pack 1 e Windows XP Service Pack 2 | Windows Server 2003 e Windows Server 2003 Service Pack 1: |
|---------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------|-----------------------------|-------------------------------------------------------|-----------------------------------------------------------|
| Vulnerabilidade de saturação do buffer de objetos de hiperlink - [CVE-2006-3086](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3086) | Execução Remota de Código  | Importante                  | Importante                                            | Importante                                                |
| Vulnerabilidade da função de objetos de hiperlink - [CVE-2006-3438](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3438)              | Execução Remota de Código  | Importante                  | Importante                                            | Importante                                                |
| **Gravidade agregada de todas as vulnerabilidades**                                                                                               | ** **                      | **Importante**              | **Importante**                                        | **Importante**                                            |

Essa [avaliação](http://www.microsoft.com/brasil/security/boletins/rating.mspx) baseia-se nos tipos de sistemas afetados pela vulnerabilidade, seus padrões comuns de implantação e o efeito da exploração da vulnerabilidade sobre eles.

**Observação** As atualizações de segurança do Windows Server 2003, Windows Server 2003 Service Pack 1 e Windows Server 2003 x64 Edition também se aplicam ao Windows Server 2003 R2.

**Observação** As classificações de gravidade das versões de sistema operacional não x86 mapeiam para as versões de sistemas operacionais x86 da seguinte forma:

-   A classificação de gravidade do Windows XP Professional x64 Edition é a mesma do Windows XP Service Pack 2.
-   A classificação de gravidade do Windows Server 2003 para sistemas baseados no Itanium é a mesma do Windows Server 2003.
-   A classificação de gravidade do Windows Server 2003 com SP1 para sistemas baseados no Itanium é a mesma do Windows Server 2003 Service Pack 1.
-   A classificação de gravidade do Windows Server 2003 x64 Edition é a mesma do Windows Server 2003 Service Pack 1.

Perguntas mais freqüentes relacionadas a esta atualização de segurança
----------------------------------------------------------------------

<span></span>
**Quais atualizações esta versão substitui?**  
Esta atualização de segurança substitui um boletim de segurança anterior. A identificação do boletim de segurança e os sistemas operacionais afetados estão relacionados na tabela a seguir.

| ID do Boletim                                                                            | Windows 2000 (site em inglês) | Windows XP Service Pack 1 e Windows XP Service Pack 2 | Windows Server 2003 | Windows Server 2003 Service Pack 1 |
|------------------------------------------------------------------------------------------|-------------------------------|-------------------------------------------------------|---------------------|------------------------------------|
| [**MS05-015**](http://www.microsoft.com/brasil/technet/seguranca/bulletin/ms05-015.mspx) | Substituído                   | Substituído                                           | Substituído         | Não Aplicável                      |

**O suporte estendido da atualização de segurança para Windows 98, Windows 98 Second Edition ou Windows Millennium Edition terminou no dia 11 de julho de 2006.  Ainda uso um desses sistemas operacionais. O que devo fazer?**  
Os ciclos de vida do suporte ao Windows 98, Windows 98 Second Edition e Windows Millennium Edition chegaram ao fim. Os clientes que possuem essas versões de sistema operacional devem priorizar a migração para as versões com suporte, a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do suporte ao produto Windows, visite o[site Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) (em inglês). Para obter mais informações sobre o período de suporte estendido da atualização de segurança dessas versões de sistema operacional, visite o [site Microsoft Product Support Services](http://go.microsoft.com/fwlink/?linkid=33328).

**O suporte estendido para a atualização de segurança do Microsoft Windows NT Workstation 4.0 Service Pack 6a e do Windows 2000 Service Pack 2 foi encerrado em 30 de junho de 2004. O suporte estendido para a atualização de segurança do Microsoft Windows NT Server 4.0 Service Pack 6a foi encerrado em 31 de dezembro de 2004. O suporte estendido para a atualização de segurança do Microsoft Windows 2000 Service Pack 3 foi encerrado em 30 de junho de 2005. Ainda estou usando um desses sistemas operacionais. O que devo fazer?**  
Os ciclos de vida do Windows NT Workstation 4.0 Service Pack 6a, Windows NT Server 4.0 Service Pack 6a, Windows 2000 Service Pack 2 e Windows 2000 Service Pack 3 chegou ao fim. Os clientes que possuem essas versões de sistema operacional devem priorizar a migração para as versões com suporte, a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do suporte ao produto Windows, visite o[site Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742) (em inglês). Para obter mais informações sobre o período de suporte estendido da atualização de segurança dessas versões de sistema operacional, visite o [site Microsoft Product Support Services](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que precisarem de suporte adicional para o estes produtos deverão entrar em contato com o representante da equipe da conta da Microsoft, o gerente técnico da conta ou o representante do parceiro Microsoft apropriado para obter opções de suporte personalizadas. Os clientes sem um contrato Alliance, Premier ou Authorized podem entrar em contato com o escritório de vendas local da Microsoft. Para obter informações de contato, visite o site de [Informações internacionais da Microsoft](http://go.microsoft.com/fwlink/?linkid=33329), selecione o país e clique em **Go** para ver uma lista de telefones. Ao ligar, peça para falar com o gerente de vendas local de Suporte Premier. Para obter mais informações, consulte a seção [Perguntas mais freqüentes sobre o ciclo de vida do suporte ao produto sistema operacional Windows](http://go.microsoft.com/fwlink/?linkid=33330).

**Posso usar o MBSA (Microsoft Baseline Security Analyzer) para determinar se esta atualização é necessária?**  
A tabela a seguir fornece o resumo de detecção do MBSA para esta atualização de segurança.

| Produto                                                                                                                                              | MBSA 1.2.1 | MBSA 2.0 |
|------------------------------------------------------------------------------------------------------------------------------------------------------|------------|----------|
| Microsoft Windows 2000 Service Pack 4                                                                                                                | Sim        | Sim      |
| Microsoft Windows XP Service Pack 1 e Microsoft Windows XP Service Pack 2                                                                            | Sim        | Sim      |
| Microsoft Windows XP Professional x64 Edition                                                                                                        | Não        | Sim      |
| Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1                                                                         | Sim        | Sim      |
| Microsoft Windows Server 2003 para sistemas baseados no Itanium e Microsoft Windows Server 2003 com Service Pack 1 para sistemas baseados no Itanium | Não        | Sim      |
| Família do Microsoft Windows Server 2003 x64 Edition                                                                                                 | Não        | Sim      |

Para obter mais informações sobre o MBSA, visite o [site do MBSA](http://www.microsoft.com/brasil/technet/seguranca/mbsa/). Para obter mais informações sobre os programas que o Microsoft Update e o MBSA 2.0 atualmente não detectam, consulte o [artigo 895660 (em inglês) da Base de Conhecimento Microsoft.](http://support.microsoft.com/kb/895660)

Para obter mais informações, consulte o [artigo 910723 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/910723).

**Posso usar o SMS (Systems Management Server) para determinar se esta atualização é necessária?**  
A tabela a seguir fornece o resumo de detecção de SMS para esta atualização de segurança.

| Produto                                                                                                                                              | SMS 2.0 | SMS 2003 |
|------------------------------------------------------------------------------------------------------------------------------------------------------|---------|----------|
| Microsoft Windows 2000 Service Pack 4                                                                                                                | Sim     | Sim      |
| Microsoft Windows XP Service Pack 1 e Microsoft Windows XP Service Pack 2                                                                            | Sim     | Sim      |
| Microsoft Windows XP Professional x64 Edition                                                                                                        | Não     | Sim      |
| Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1                                                                         | Sim     | Sim      |
| Microsoft Windows Server 2003 para sistemas baseados no Itanium e Microsoft Windows Server 2003 com Service Pack 1 para sistemas baseados no Itanium | Não     | Sim      |
| Família do Microsoft Windows Server 2003 x64 Edition                                                                                                 | Não     | Sim      |

O SMS usa o MBSA para detecção. Assim, o SMS tem a mesma limitação listada anteriormente neste boletim relacionada aos programas que o MBSA não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Security Update Inventory Tool, pode ser usado pelo SMS para detectar atualizações de segurança. O SMS SUIT usa o mecanismo do MBSA 1.2.1 para detecção. Para obter mais informações sobre a ferramenta Inventário da Atualização de Segurança, visite o seguinte [site da Microsoft](http://support.microsoft.com/kb/894154/). Para obter mais informações sobre as limitações da ferramenta Security Update Inventory Tool, consulte o [artigo 306460 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/306460/). O SMS SUS Feature Pack também inclui a ferramenta Office Inventory da Microsoft para detectar atualizações necessárias para aplicativos do Microsoft Office.

Para o SMS 2003, ferramenta de inventário do SMS 2003 para Microsoft Updates pode ser usada pelo SMS para detectar as atualizações de segurança oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate) e que tenham suporte do [Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx). Para obter mais informações sobre a ferramenta de inventário do SMS 2003 para Microsoft Updates, consulte o seguinte [site da Microsoft](http://www.microsoft.com/smserver/downloads/2003/tools/msupdates.mspx). O SMS 2003 também pode usar a ferramenta Office Inventory da Microsoft para detectar as atualizações necessárias dos aplicativos do Microsoft Office.

Para obter mais informações sobre o SMS, visite o [site do SMS](http://www.microsoft.com/brasil/sms).

Para obter mais informações, consulte o [artigo 910723 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/910723).

Detalhes da Vulnerabilidade
---------------------------

<span></span>
#### Vulnerabilidade de saturação do buffer de objetos COM de hiperlink - CVE-2006-3086:

Há uma vulnerabilidade de execução remota de código na biblioteca de objetos de hiperlink. A causa desse problema é um buffer não verificado no código usado para manipulação de hiperlinks. Um invasor pode explorar essa vulnerabilidade com êxito, criando um hiperlink mal-intencionado, potencialmente capaz de induzir a execução remota de código se o usuário clicar no link mal-intencionado em um arquivo do Office ou em um email. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado. É necessária uma interação do usuário para explorar essa vulnerabilidade.

#### Fatores atenuantes da vulnerabilidade de saturação do buffer de objetos COM de hiperlink - CVE-2006-3086:

-   O invasor que explorar com êxito a vulnerabilidade poderá obter os mesmos direitos que o usuário local. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.
-   A vulnerabilidade não pode ser explorada automaticamente por email. Para que um ataque seja bem-sucedido, um invasor deve persuadir o usuário a clicar em um link em uma mensagem de email ou abrir um arquivo do Office e clicar em um link contido nesse arquivo.

#### Soluções alternativas para a vulnerabilidade de saturação do buffer de objeto COM de Hiperlink - CVE-2006-3086:

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Uma solução alternativa não pode bloquear todos os vetores de ataque. Quando uma solução alternativa reduz a funcionalidade, ela é indicada na seção a seguir.

-   **Modifique a Lista de controle de acesso para negar acesso a Hlink.dll para todos os usuários**
    A desativação da chave de Registro Hlink.dll ajuda a proteger o sistema afetado de tentativas de exploração desta vulnerabilidade. Para modificar a chave de Registro Hlink.dll:

    -   Clique em **Iniciar**, **Executar**, digite **cacls "%windir%\\system32\\hlink.dll" /d everyone** (sem as aspas) e depois clique em **OK**.

    **Impacto da solução alternativa:** Os usuários de aplicativos Office não poderão editar hiperlinks nem clicar em hiperlinks incorporados a documentos Office.

-   **Modifique a Lista de controle de acesso para desativar a chave do registro HLINK**
    Modificando a Lista de controle de acesso na chave do registro "**HLINK**" ajuda a proteger o sistema afetado de tentativas de exploração desta vulnerabilidade. Para modificar a chave do registro do protocolo MHTML, siga estas etapas.

    **Observação** O uso incorreto do Editor do Registro pode causar problemas sérios e exigir a reinstalação do sistema operacional. A Microsoft não garante que os problemas resultantes do uso incorreto do Editor do Registro possam ser solucionados. Você é responsável pelo uso do Editor do Registro. Para obter informações sobre como editar o Registro, consulte o tópico da Ajuda "Alterar chaves e valores" do Editor do Registro (Regedit.exe) ou exiba os tópicos da Ajuda "Adicionar e excluir informações no Registro" e "Editar informações do Registro" no Regedt32.exe.

    **Observação** É recomendável fazer backup do Registro antes de editá-lo.

    **Para Windows 2000**

    **Observação** Anote as permissões que estão relacionadas na caixa de diálogo para que possa restaurá-las aos seus valores originais mais tarde

    1.  Clique em **Iniciar**, clique em **Executar**, digite "**rregedt32**" (sem as aspas) e clique em **OK**.
    2.  Expanda **HKEY\_CLASSES\_ROOT**, expanda **CLSID** e então clique em **{79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.
    3.  Clique em **Segurança** e, em seguida, clique em **Permissões**.
    4.  Clique para desmarcar a caixa de seleção **Autorizar as permissões de herança do pai para propagar para este objeto**. Você é solicitado a clicar em **Copiar**, **Remover** ou **Cancelar**. Clique em **Remover** e em **OK**.
    5.  Você recebe uma mensagem que afirma que ninguém poderá acessar essa chave de registro. Clique em **Sim** quando assim for solicitado.

    **Para sistemas operacionais Windows XP Service Pack 1 ou superior**

    **Observação** Anote as permissões que estão relacionadas na caixa de diálogo para que possa restaurá-las aos seus valores originais mais tarde

    1.  Clique em **Iniciar**, clique em **Executar**, digite "**regedit**" (sem as aspas) e clique em **OK**.
    2.  Expanda **HKEY\_CLASSES\_ROOT**, expanda **CLSID** e então clique em **{79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.
    3.  Clique em **Editar** e em **Permissões**.
    4.  Clique em **Avançado.**
    5.  Clique para desmarcar a caixa de seleção **Herdar do pai as entradas de permissão aplicáveis a objetos filho. Incluir estas entradas explicitamente definidas aqui**. Você é solicitado a clicar em **Copiar**, **Remover** ou **Cancelar**. Clique em **Remove**r e marque **OK**.
    6.  Você recebe uma mensagem que afirma que ninguém poderá acessar essa chave de registro. Clique em **Sim** e, em seguida, clique em **OK** para fechar a caixa de diálogo **Permissões para {79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.

    **Impacto da solução alternativa:** Os usuários de aplicativos Office não poderão editar hiperlinks nem clicar em hiperlinks incorporados a documentos Office.

-   **Se você estiver usando o Outlook 2002 ou posterior ou o Outlook Express 6 SP1 ou posterior, leia as mensagens de email no formato de texto sem formatação. Isso ajudará você a se proteger contra o vetor de ataque de email em HTML.**

    Os usuários do Microsoft Outlook 2002 que aplicaram o Office XP Service Pack 1 ou posterior, e os usuários do Microsoft Outlook Express 6 que aplicaram o Internet Explorer 6 Service Pack 1 ou posterior, podem habilitar essa configuração e exibir todas as mensagens de email sem assinatura digital ou não criptografadas somente como texto simples.

    Para obter informações sobre essa configuração no Outlook Express 6, consulte o [artigo 291387 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/291387).

    **Impacto da solução alternativa:** As mensagens de email exibidas em formato de texto sem formatação não conterão figuras, fontes específicas, animações nem outro conteúdo formatado. Além disso:

    -   As alterações são aplicadas ao painel de visualização e a mensagens abertas.
    -   As imagens passam a ser anexos para não serem perdidas.
    -   Como a mensagem ainda será armazenada como Rich Text ou HTML, o modelo de objeto (soluções de código personalizado) pode comportar-se de maneira inesperada.

-   **Não clique em hiperlinks em documentos do Microsoft Office de fontes não confiáveis.**

#### Perguntas freqüentes para a vulnerabilidade de saturação do buffer de objeto COM de Hiperlink - CVE-2006-3086:

**Qual é o escopo da vulnerabilidade?**  
Há uma vulnerabilidade de execução remota de código na biblioteca de objetos de hiperlink. A causa desse problema é um buffer não verificado no código usado para manipulação de hiperlinks. Um invasor pode explorar essa vulnerabilidade com êxito, criando um hiperlink mal-intencionado, potencialmente capaz de induzir a execução remota de código se o usuário clicar no link mal-intencionado em um arquivo do Office ou em um email. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado. É necessária uma interação do usuário para explorar essa vulnerabilidade.

Se um usuário tiver feito logon com direitos administrativos, o invasor que explorar com êxito essa vulnerabilidade poderá obter o controle total do sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

**O que provoca a vulnerabilidade?**  
Um buffer não verificado na biblioteca de objetos de hiperlink.

**O que é a biblioteca de objetos de hiperlink?**  
A biblioteca de objetos de hiperlink é um conjunto de interfaces de programação de aplicativos. Essas interfaces fornecem funcionalidades aos desenvolvedores de software para o processamento de hiperlinks. Para obter mais informações sobre hiperlinks, consulte a [documentação do produto](http://msdn.microsoft.com/library/default.asp?url=/workshop/misc/hlink/overview/overview.asp).

**Para que um invasor pode usar a vulnerabilidade?**  
Um invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado.

**De que forma o invasor pode explorar a vulnerabilidade?**  
A vulnerabilidade não pode ser explorada automaticamente por email. Para que um ataque seja bem-sucedido, um invasor deve persuadir o usuário a clicar em um link em uma mensagem de email ou abrir um arquivo do Office e clicar em um link contido nesse arquivo.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
As estações de trabalho e os servidores de terminal são os que correm mais risco. Os servidores correm mais riscos se os administradores permitirem que os usuários façam logon em servidores e executem programas. Entretanto, as práticas recomendadas não recomendam esse procedimento.

**O que a atualização faz?**  
A atualização elimina a vulnerabilidade, modificando a forma como a biblioteca de objetos de hiperlink valida o tamanho de uma mensagem antes de transmiti-la ao buffer alocado.

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Sim. Essa vulnerabilidade foi divulgada publicamente. Ela recebeu o número CVE-2006-3086 da lista Common Vulnerability and Exposure. Este boletim de segurança trata a vulnerabilidade exposta publica e particularmente, assim como problemas adicionais descobertos por investigações internas.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft viu exemplos de código de verificação de conceito divulgados publicamente, mas não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido usada publicamente para atacar clientes quando este boletim de segurança foi originalmente lançado.

**A aplicação dessa atualização de segurança ajuda a proteger os clientes contra código divulgado publicamente que tente explorar essa vulnerabilidade?**  
Sim. Essa atualização de segurança elimina a vulnerabilidade que poderia ser explorada por meio do uso do código de verificação de conceito publicado. A vulnerabilidade tratada recebeu o número CVE-2006-3086 da lista Common Vulnerability and Exposure.

#### Vulnerabilidade da função de objetos de hiperlink - CVE-2006-3438:

Há uma vulnerabilidade de execução remota de código na biblioteca de objetos de hiperlink. Este problema existe quando a Biblioteca de objetos de hiperlink usa um arquivo que contém uma função malformada durante a manipulação de hiperlinks. Um invasor pode explorar essa vulnerabilidade com êxito, criando um hiperlink mal-intencionado, potencialmente capaz de induzir a execução remota de código se o usuário clicar no link mal-intencionado em um arquivo do Office ou em um email. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado. É necessária uma interação do usuário para explorar essa vulnerabilidade.

#### Fatores atenuantes da Vulnerabilidade de função de objeto de hiperlink - CVE-2006-3438:

-   O invasor que explorar com êxito a vulnerabilidade poderá obter os mesmos direitos que o usuário local. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.
-   A vulnerabilidade não pode ser explorada automaticamente por email. Para que um ataque seja bem-sucedido, um invasor deve persuadir o usuário a clicar em um link em uma mensagem de email ou abrir um arquivo do Office e clicar em um link contido nesse arquivo.

#### Soluções alternativas para a Vulnerabilidade de função de objeto de hiperlink - CVE-2006-3438:

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Uma solução alternativa não pode bloquear todos os vetores de ataque. Quando uma solução alternativa reduz a funcionalidade, ela é indicada na seção a seguir.

-   **Modifique a Lista de controle de acesso para negar acesso a Hlink.dll para todos os usuários**
    A desativação da chave de Registro Hlink.dll ajuda a proteger o sistema afetado de tentativas de exploração desta vulnerabilidade. Para modificar a chave de Registro Hlink.dll:

    -   Clique em **Iniciar**, **Executar**, digite **cacls "%windir%\\system32\\hlink.dll" /d everyone** (sem as aspas) e depois clique em **OK**.

    **Impacto da solução alternativa:** Os usuários de aplicativos Office não poderão editar hiperlinks nem clicar em hiperlinks incorporados a documentos Office.

-   **Modifique a Lista de controle de acesso para desativar a chave do registro HLINK**
    Modificando a Lista de controle de acesso na chave do registro "**HLINK**" ajuda a proteger o sistema afetado de tentativas de exploração desta vulnerabilidade. Para modificar a chave do registro do protocolo MHTML, siga estas etapas.

    **Observação** O uso incorreto do Editor do Registro pode causar problemas sérios e exigir a reinstalação do sistema operacional. A Microsoft não garante que os problemas resultantes do uso incorreto do Editor do Registro possam ser solucionados. Você é responsável pelo uso do Editor do Registro. Para obter informações sobre como editar o Registro, consulte o tópico da Ajuda "Alterar chaves e valores" do Editor do Registro (Regedit.exe) ou exiba os tópicos da Ajuda "Adicionar e excluir informações no Registro" e "Editar informações do Registro" no Regedt32.exe.

    **Observação** É recomendável fazer backup do Registro antes de editá-lo.

    **Para Windows 2000**

    **Observação** Anote as permissões que estão relacionadas na caixa de diálogo para que possa restaurá-las aos seus valores originais mais tarde

    1.  Clique em **Iniciar**, clique em **Executar**, digite "**rregedt32**" (sem as aspas) e clique em **OK**.
    2.  Expanda **HKEY\_CLASSES\_ROOT**, expanda **CLSID** e então clique em **{79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.
    3.  Clique em **Segurança** e, em seguida, clique em **Permissões**.
    4.  Clique para desmarcar a caixa de seleção **Autorizar as permissões de herança do pai para propagar para este objeto**. Você é solicitado a clicar em **Copiar**, **Remover** ou **Cancelar**. Clique em **Remover** e em **OK**.
    5.  Você recebe uma mensagem que afirma que ninguém poderá acessar essa chave de registro. Clique em **Sim** quando assim for solicitado.

    **Para sistemas operacionais Windows XP Service Pack 1 ou superior**

    **Observação** Anote as permissões que estão relacionadas na caixa de diálogo para que possa restaurá-las aos seus valores originais mais tarde

    1.  Clique em **Iniciar**, clique em **Executar**, digite "**regedit**" (sem as aspas) e clique em **OK**.
    2.  Expanda **HKEY\_CLASSES\_ROOT**, expanda **CLSID** e então clique em **{79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.
    3.  Clique em **Editar** e em **Permissões**.
    4.  Clique em **Avançado.**
    5.  Clique para desmarcar a caixa de seleção **Herdar do pai as entradas de permissão aplicáveis a objetos filho. Incluir estas entradas explicitamente definidas aqui**. Você é solicitado a clicar em **Copiar**, **Remover** ou **Cancelar**. Clique em **Remove**r e marque **OK**.
    6.  Você recebe uma mensagem que afirma que ninguém poderá acessar essa chave de registro. Clique em **Sim** e, em seguida, clique em **OK** para fechar a caixa de diálogo **Permissões para {79eac9d0-baf9-11ce-8c82-00aa004ba90b}**.

    **Impacto da solução alternativa:** Os usuários de aplicativos Office não poderão editar hiperlinks nem clicar em hiperlinks incorporados a documentos Office.

-   **Se você estiver usando o Outlook 2002 ou posterior ou o Outlook Express 6 SP1 ou posterior, leia as mensagens de email no formato de texto sem formatação. Isso ajudará você a se proteger contra o vetor de ataque de email em HTML.**

    Os usuários do Microsoft Outlook 2002 que aplicaram o Office XP Service Pack 1 ou posterior, e os usuários do Microsoft Outlook Express 6 que aplicaram o Internet Explorer 6 Service Pack 1 ou posterior, podem habilitar essa configuração e exibir todas as mensagens de email sem assinatura digital ou não criptografadas somente como texto simples.

    Para obter informações sobre essa configuração no Outlook Express 6, consulte o [artigo 291387 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/291387).

    **Impacto da solução alternativa:** As mensagens de email exibidas em formato de texto sem formatação não conterão figuras, fontes específicas, animações nem outro conteúdo formatado. Além disso:

    -   As alterações são aplicadas ao painel de visualização e a mensagens abertas.
    -   As imagens passam a ser anexos para não serem perdidas.
    -   Como a mensagem ainda será armazenada como Rich Text ou HTML, o modelo de objeto (soluções de código personalizado) pode comportar-se de maneira inesperada.

-   **Não clique em hiperlinks em documentos do Microsoft Office de fontes não confiáveis.**

#### Perguntas freqüentes sobre a Vulnerabilidade de função de objeto de hiperlink - CVE-2006-3438:

**Qual é o escopo da vulnerabilidade?**  
Há uma vulnerabilidade de execução remota de código na biblioteca de objetos de hiperlink. Este problema existe quando a Biblioteca de objetos de hiperlink usa um arquivo que contém uma função malformada durante a manipulação de hiperlinks. Um invasor pode explorar essa vulnerabilidade com êxito, criando um hiperlink mal-intencionado, potencialmente capaz de induzir a execução remota de código se o usuário clicar no link mal-intencionado em um arquivo do Office ou em um email. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado. É necessária uma interação do usuário para explorar essa vulnerabilidade.

Se um usuário tiver feito logon com direitos administrativos, o invasor que explorar com êxito essa vulnerabilidade poderá obter o controle total do sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

**O que provoca a vulnerabilidade?**  
Um buffer não verificado na biblioteca de objetos de hiperlink.

**O que é a biblioteca de objetos de hiperlink?**  
A biblioteca de objetos de hiperlink é um conjunto de interfaces de programação de aplicativos. Essas interfaces fornecem funcionalidades aos desenvolvedores de software para processamento de hiperlinks. Para obter mais informações sobre hiperlinks, consulte a [documentação do produto](http://msdn.microsoft.com/library/default.asp?url=/workshop/misc/hlink/overview/overview.asp).

**Para que um invasor pode usar a vulnerabilidade?**  
Um invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado.

**De que forma o invasor pode explorar a vulnerabilidade?**  
A vulnerabilidade não pode ser explorada automaticamente por email. Para que um ataque seja bem-sucedido, um invasor deve persuadir o usuário a clicar em um link em uma mensagem de email ou abrir um arquivo do Office e clicar em um link contido nesse arquivo.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
As estações de trabalho e os servidores de terminal são os que correm mais risco. Os servidores correm mais riscos se os administradores permitirem que os usuários façam logon em servidores e executem programas. Entretanto, as práticas recomendadas não recomendam esse procedimento.

**O que a atualização faz?**  
A atualização elimina a vulnerabilidade, modificando a forma como a biblioteca de objetos de hiperlink valida o tamanho de uma mensagem antes de transmiti-la ao buffer alocado.

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Não. A Microsoft recebeu informações sobre essa vulnerabilidade por meio de divulgação responsável. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido divulgada publicamente quando este boletim de segurança foi lançado pela primeira vez.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido usada publicamente para atacar clientes e não testemunhou nenhum exemplo de publicação de código de verificação de conceito, quando este boletim de segurança foi lançado pela primeira vez.

Informações de atualização de segurança
---------------------------------------

<span></span>
**Softwares afetados:**

Para obter informações sobre uma atualização de segurança específica para seu software afetado, clique no link apropriado:

#### Windows Server 2003 (todas as versões)

**Pré-requisitos**
Esta atualização de segurança requer o Windows Server 2003 ou Windows Server 2003 Service Pack 1.

**Observação** As atualizações de segurança para Microsoft Windows Server 2003 e Microsoft Windows Server 2003 Service Pack 1 também se aplicam ao Microsoft Windows Server 2003 R2.

**Inclusão em Service Packs futuros:**
A atualização desse problema será incluída em um service pack ou conjunto de atualizações futuro.

**Informações sobre instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando.
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização.
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Sobrescreve arquivos OEM sem notificação.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz backup de arquivos necessários à desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log: path**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:caminho**
</td>
<td style="border:1px solid black;">
Integra a atualização nos arquivos-fonte do Windows. Esses arquivos se encontram no caminho especificado na opção.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:caminho\]**
</td>
<td style="border:1px solid black;">
Extrai os arquivos sem iniciar o programa de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte a várias opções de instalação utilizadas por versões anteriores do programa de instalação. Para obter mais informações sobre opções com suporte de segurança, consulte o [artigo 262841 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o instalador Update.exe, visite [o site Microsoft TechNet](http://www.microsoft.com/brasil/technet).

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, utilize o seguinte comando em um prompt de comando para o Windows Server 2003:

**Windowsserver2003-kb920670-x86-enu /quiet**

**Observação** O uso da opção **/quiet** eliminará todas as mensagens. Isso inclui a eliminação de mensagens de falha. Os administradores devem usar um dos métodos com suporte para verificar se a instalação foi bem-sucedida quando utilizarem a opção **/quiet**. Os administradores também devem analisar o arquivo KB920670.log para obter informações sobre quaisquer mensagens de falha quando usarem essa opção.

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando para o Windows Server 2003:

**Windowsserver2003-kb920670-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com os serviços de atualização de software, visite o [site Software Update Services](http://www.microsoft.com/brasil/technet/seguranca/sus/). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Requisitos de reinicialização**

É necessário reiniciar o sistema depois de aplicar essa atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB920670$\\Spuninst.

<p></p>
<table class="dataTable">
<caption>
Opções do Spuninst.exe para as quais existe suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando.
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização.
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação.
</td>
</tr>
</table>
 
**Informações sobre o arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Datacenter Edition; Windows Server 2003, Enterprise Edition; Windows Small Business Server 2003; Windows Server 2003, Web Edition com SP1; Windows Server 2003, Standard Edition com SP1; Windows Server 2003, Enterprise Edition com SP1; Windows Server 2003, Datacenter Edition com SP1; Windows Server 2003 R2, Web Edition; Windows Server 2003 R2, Standard Edition; Windows Server 2003 R2, Datacenter Edition; Windows Server 2003 R2, Enterprise Edition; Windows Small Business Server 2003 R2:

| Nome do arquivo | Versão        | Data                | Hora  | Tamanho | CPU | Pasta  |
|-----------------|---------------|---------------------|-------|---------|-----|--------|
| Hlink.dll       | 5.2.3790.560  | 17 de julho de 2006 | 22:17 | 71.680  | x86 | RTMGDR |
| Hlink.dll       | 5.2.3790.560  | 17 de julho de 2006 | 22:37 | 71.680  | x86 | RTMQFE |
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 22:40 | 72.704  | x86 | SP1GDR |
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 22:45 | 72.704  | x86 | SP1QFE |

| Nome do arquivo | Versão        | Data                | Hora  | Tamanho | CPU   | Pasta       |
|-----------------|---------------|---------------------|-------|---------|-------|-------------|
| Hlink.dll       | 5.2.3790.560  | 17 de julho de 2006 | 23:09 | 231.936 | IA-64 | RTMGDR      |
| Whlink.dll      | 5.2.3790.560  | 17 de julho de 2006 | 23:09 | 71.680  | x86   | RTMGDR\\WOW |
| Hlink.dll       | 5.2.3790.560  | 17 de julho de 2006 | 23:09 | 231.936 | IA-64 | RTMQFE      |
| Whlink.dll      | 5.2.3790.560  | 17 de julho de 2006 | 23:09 | 71.680  | x86   | RTMQFE\\WOW |
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 23:13 | 246.784 | IA-64 | SP1GDR      |
| Whlink.dll      | 5.2.3790.2748 | 17 de julho de 2006 | 23:13 | 72.704  | x86   | SP1GDR\\WOW |
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 23:11 | 246.784 | IA-64 | SP1QFE      |
| Whlink.dll      | 5.2.3790.2748 | 17 de julho de 2006 | 23:11 | 72.704  | x86   | SP1QFE\\WOW |

Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition; e Windows Server 2003, Datacenter x64 Edition; Windows Server 2003 R2, Standard x64 Edition; Windows Server 2003 R2, Enterprise x64 Edition; e Windows Server 2003 R2, Datacenter x64 Edition:

| Nome do arquivo | Versão        | Data                | Hora  | Tamanho | CPU | Pasta       |
|-----------------|---------------|---------------------|-------|---------|-----|-------------|
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 23:11 | 156.160 | x64 | SP1GDR      |
| Whlink.dll      | 5.2.3790.2748 | 17 de julho de 2006 | 23:11 | 72.704  | x86 | SP1GDR\\WOW |
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 23:08 | 156.160 | x64 | SP1QFE      |
| Whlink.dll      | 5.2.3790.2748 | 17 de julho de 2006 | 23:08 | 72.704  | x86 | SP1QFE\\WOW |

**Observações** Quando você instalar estas atualizações de segurança, o instalador verificará se um ou mais arquivos que estão sendo atualizados no sistema já foram atualizados por um hotfix da Microsoft.

Se você já tiver instalado um hotfix para atualizar um desses arquivos, o instalador copiará os arquivos RTMQFE, SP1QFE ou SP2QFE para o sistema. Do contrário, o instalador copiará os arquivos RTMGDR, SP1GDR ou SP2GDR para o sistema. As atualizações de segurança podem não conter todas as variações desses arquivos. Para obter mais informações sobre esse comportamento, consulte o [artigo 824994 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/824994).

Para obter mais informações sobre o instalador Update.exe, visite o [site Microsoft TechNet](http://www.microsoft.com/brasil/technet).

Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [artigo 824684 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/824684).

**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, você pode utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://www.microsoft.com/brasil/technet/seguranca/mbsa/) (em inglês).

-   **Verificação de versão de arquivo**

    **Observação** Como existem várias versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.
        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos podem não estar instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.
        **Observação** Atributos com versão diferente da versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da chave do Registro**

    Também é possível verificar os arquivos que esta atualização de segurança instalou analisando as seguintes chaves do Registro:

    Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Enterprise Edition; Windows Server 2003, Datacenter Edition; Windows Small Business Server 2003; Windows Server 2003, Enterprise Edition para sistemas baseados em Itanium e Windows Server 2003, Datacenter Edition para sistemas baseados em Itanium:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP1\\KB920670\\Filelist

    Windows Server 2003, Web Edition; Windows Server 2003, Standard Edition; Windows Server 2003, Enterprise Edition; Windows Server 2003, Datacenter Edition; Windows Small Business Server 2003; Windows Server 2003, Web Edition com SP1; Windows Server 2003, Standard Edition com SP1; Windows Server 2003, Enterprise Edition com SP1; Windows Server 2003, Datacenter Edition com SP1; Windows Server 2003, Enterprise Edition para sistemas baseados no Itanium; Windows Server 2003, Datacenter Edition para sistemas baseados no Itanium; Windows Server 2003, Enterprise Edition com SP1 para sistemas baseados no Itanium; Windows Server 2003, Datacenter Edition com SP1 para sistemas baseados no Itanium; Windows Server 2003, Standard x64 Edition; Windows Server 2003, Enterprise x64 Edition; e Windows Server 2003, Datacenter x64 Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows Server 2003\\SP2\\KB920670\\Filelist

    **Observação** Essa chave do Registro pode não conter uma lista completa de arquivos instalados. Além disso, essa chave do Registro pode não ser criada corretamente se um administrador ou um OEM integrar ou adicionar a atualização de segurança 920670 aos arquivos-fonte da instalação do Windows.

#### Windows XP (todas as versões)

**Pré-requisitos**
Esta atualização de segurança requer o Microsoft Windows XP Service Pack 1 ou uma versão posterior. Para obter mais informações, consulte o [artigo 322389 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/322389).

**Inclusão em Service Packs futuros:**
A atualização desse problema será incluída em um service pack ou conjunto de atualizações futuro.

**Informações sobre instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando.
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização.
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Sobrescreve arquivos OEM sem notificação.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz backup de arquivos necessários à desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:caminho**
</td>
<td style="border:1px solid black;">
Integra a atualização nos arquivos-fonte do Windows. Esses arquivos se encontram no caminho especificado na opção.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:caminho\]**
</td>
<td style="border:1px solid black;">
Extrai os arquivos sem iniciar o programa de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte às opções de instalação utilizadas por versões anteriores do utilitário de instalação. Para obter mais informações sobre opções com suporte de segurança, consulte o [artigo 262841 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o instalador Update.exe, visite [o site Microsoft TechNet](http://www.microsoft.com/brasil/technet).

**Informações de implantação**

Para instalar a atualização de segurança sem qualquer intervenção do usuário, use o seguinte comando em um prompt de comando do Microsoft Windows XP:

**Windowsxp-kb920670-x86-enu /quiet**

**Observação** O uso da opção **/quiet** eliminará todas as mensagens. Isso inclui a eliminação de mensagens de falha. Os administradores devem usar um dos métodos com suporte para verificar se a instalação foi bem-sucedida quando utilizarem a opção **/quiet**. Os administradores também devem analisar o arquivo KB920670.log para obter informações sobre quaisquer mensagens de falha quando usarem essa opção.

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando do Windows XP:

**Windowsxp-kb920670-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com os serviços de atualização de software, visite o [site Software Update Services](http://www.microsoft.com/brasil/technet/seguranca/sus/). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Requisitos de reinicialização**

É necessário reiniciar o sistema depois de aplicar essa atualização de segurança.

**Informações sobre remoção**

Para remover esta atualização de segurança, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB920670$\\Spuninst.

<p></p>
<table class="dataTable">
<caption>
Opções do Spuninst.exe para as quais existe suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando.
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização.
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação.
</td>
</tr>
</table>
 
**Informações sobre o arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP Tablet PC Edition, Windows XP Media Center Edition, Windows XP Home Edition Service Pack 2, Windows XP Professional Service Pack 2, Windows XP Tablet PC Edition 2005 e Windows XP Media Center Edition 2005:

| Nome do arquivo | Versão        | Data                | Hora  | Tamanho | CPU | Pasta  |
|-----------------|---------------|---------------------|-------|---------|-----|--------|
| Hlink.dll       | 5.2.3790.2748 | 21 de julho de 2006 | 08:30 | 72.704  | x86 | SP1QFE |
| Hlink.dll       | 5.2.3790.2748 | 21 de julho de 2006 | 08:24 | 72.704  | x86 | SP2GDR |
| Hlink.dll       | 5.2.3790.2748 | 21 de julho de 2006 | 08:26 | 72.704  | x86 | SP2QFE |

Windows XP Professional x64:

| Nome do arquivo | Versão        | Data                | Hora  | Tamanho | CPU | Pasta       |
|-----------------|---------------|---------------------|-------|---------|-----|-------------|
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 23:11 | 156.160 | x64 | SP1GDR      |
| Whlink.dll      | 5.2.3790.2748 | 17 de julho de 2006 | 23:11 | 72.704  | x86 | SP1GDR\\WOW |
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 23:08 | 156.160 | x64 | SP1QFE      |
| Whlink.dll      | 5.2.3790.2748 | 17 de julho de 2006 | 23:08 | 72.704  | x86 | SP1QFE\\WOW |
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 23:11 | 156.160 | x64 | SP1GDR      |
| Whlink.dll      | 5.2.3790.2748 | 17 de julho de 2006 | 23:11 | 72.704  | x86 | SP1GDR\\WOW |
| Hlink.dll       | 5.2.3790.2748 | 17 de julho de 2006 | 23:08 | 156.160 | x64 | SP1QFE      |
| Whlink.dll      | 5.2.3790.2748 | 17 de julho de 2006 | 23:08 | 72.704  | x86 | SP1QFE\\WOW |

**Observações** Quando você instalar estas atualizações de segurança, o instalador verificará se um ou mais arquivos que estão sendo atualizados no sistema já foram atualizados por um hotfix da Microsoft.

Se você já tiver instalado um hotfix para atualizar um desses arquivos, o instalador copiará os arquivos RTMQFE, SP1QFE ou SP2QFE para o sistema. Do contrário, o instalador copiará os arquivos RTMGDR, SP1GDR ou SP2GDR para o sistema. As atualizações de segurança podem não conter todas as variações desses arquivos. Para obter mais informações sobre esse comportamento, consulte o [artigo 824994 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/824994).

Para obter mais informações sobre o instalador Update.exe, visite o [site Microsoft TechNet](http://www.microsoft.com/brasil/technet).

Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [artigo 824684 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/824684).

**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, você pode utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://www.microsoft.com/brasil/technet/seguranca/mbsa/) (em inglês).

-   **Verificação de versão de arquivo**

    **Observação** Como existem várias versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.
        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos podem não estar instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.
        **Observação** Atributos com versão diferente da versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da chave do Registro**

    Também é possível verificar os arquivos que esta atualização de segurança instalou analisando as seguintes chaves do Registro:

    Para Windows XP Home Edition Service Pack 1, Windows XP Professional Service Pack 1, Windows XP Tablet PC Edition, Windows XP Media Center Edition, Windows XP Home Edition Service Pack 2, Windows XP Professional Service Pack 2, Windows XP Tablet PC Edition 2005 e Windows XP Media Center Edition 2005:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP\\SP3\\KB920670\\Filelist

    Para Windows XP Professional x64 Edition:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows XP Version 2003\\SP2\\KB920670\\Filelist

    **Observação** Estas chaves do Registro podem não conter uma lista completa dos arquivos instalados. Além disso, essas chaves do Registro podem não ser criadas corretamente caso o administrador ou um OEM integre ou adicione a atualização de segurança 920670 aos arquivos-fonte de instalação do Windows.

#### Windows 2000 (todas as versões)

**Pré-requisitos**
No caso do Windows 2000, esta atualização de segurança requer o Service Pack 4 (SP4). Para o Small Business Server 2000, esta atualização de segurança requer que o Small Business Server 2000 Service Pack 1a (SP1a) ou o Small Business Server 2000 esteja em execução no Windows 2000 Server Service Pack 4 (SP4).

Os softwares relacionados foram testados para determinar se suas versões são afetadas. Outras versões já não incluem suporte para a atualização de segurança ou podem não ser afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o [site do Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742).

Para obter mais informações sobre como obter o service pack mais recente, consulte o [artigo 260910 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/260910).

**Inclusão em Service Packs futuros:**
A atualização desse problema poderá ser incluída em um conjunto de atualizações futuro.

**Informações sobre instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando.
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização.
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Sobrescreve arquivos OEM sem notificação.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz backup de arquivos necessários à desinstalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/integrate:caminho**
</td>
<td style="border:1px solid black;">
Integra a atualização nos arquivos-fonte do Windows. Esses arquivos se encontram no caminho especificado na opção.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/extract\[:caminho\]**
</td>
<td style="border:1px solid black;">
Extrai os arquivos sem iniciar o programa de instalação.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte às opções de instalação utilizadas por versões anteriores do utilitário de instalação. Para obter mais informações sobre opções com suporte de segurança, consulte o [artigo 262841 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/262841). Para obter mais informações sobre o instalador Update.exe, visite [o site Microsoft TechNet](http://www.microsoft.com/brasil/technet). Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [artigo 824684 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/824684).

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, use o seguinte comando em um prompt de comando do Windows 2000 Service Pack 4:

**Windows2000-kb920670-x86-enu /quiet**

**Observação** O uso da opção **/quiet** eliminará todas as mensagens. Isso inclui a eliminação de mensagens de falha. Os administradores devem usar um dos métodos com suporte para verificar se a instalação foi bem-sucedida quando utilizarem a opção **/quiet**. Os administradores também devem analisar o arquivo KB920670.log para obter informações sobre quaisquer mensagens de falha quando usarem essa opção.

Para instalar a atualização de segurança sem forçar a reinicialização do sistema, use o seguinte comando em um prompt de comando do Windows XP Service Pack 4:

**Windows2000-kb920670-x86-enu /norestart**

Para obter informações sobre como implantar esta atualização de segurança com os serviços de atualização de software, visite o site [Serviços de Atualização de Software](http://www.microsoft.com/brasil/technet/seguranca/sus/). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Requisitos de reinicialização**

Essa atualização não requer reinicialização. O instalador interrompe os serviços necessários, aplica a atualização e reinicia-os em seguida. Contudo, se esses serviços necessários não puderem ser interrompidos por algum motivo, ou se os arquivos necessários estiverem em uso, a atualização exigirá uma reinicialização. Se isso ocorrer, uma mensagem que aconselha a reinicialização será exibida.

Para reduzir a possibilidade de uma reinicialização ser solicitada, interrompa todos os serviços afetados e feche todos os aplicativos que possam usar os arquivos afetados antes de instalar a atualização de segurança. Para obter mais informações sobre os motivos pelos quais você será solicitado a reiniciar, consulte o [artigo 887012 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/887012).

**Informações sobre remoção**

Para remover esta atualização de segurança, use Adicionar ou Remover Programas no Painel de Controle.

Os administradores de sistema também podem usar o utilitário Spuninst.exe para remover esta atualização de segurança. O utilitário Spuninst.exe está localizado na pasta %Windir%\\$NTUninstallKB920670$\\Spuninst.

<p></p>
<table class="dataTable">
<caption>
Opções do Spuninst.exe para as quais existe suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando.
</td>
</tr>
<tr>
<th colspan="2">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização.
</td>
</tr>
<tr>
<th colspan="2">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação.
</td>
</tr>
</table>
 
**Informações sobre o arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Windows 2000 Service Pack 4 e Small Business Server 2000:

| Nome do arquivo | Versão        | Data                | Hora  | Tamanho |
|-----------------|---------------|---------------------|-------|---------|
| Hlink.dll       | 5.2.3790.2748 | 22 de julho de 2006 | 03:38 | 72.704  |

**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, você pode utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Essa ferramenta permite que os administradores examinem os sistemas locais e remotos para saber se faltam atualizações de segurança ou se existem problemas de configuração comuns. Para obter mais informações sobre o MBSA, visite o site [Microsoft Baseline Security Analyzer](http://www.microsoft.com/brasil/technet/seguranca/mbsa/) (em inglês).

-   **Verificação de versão de arquivo**

    **Observação** Como existem várias versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.
        **Observação** Dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos podem não estar instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.
        **Observação** Atributos com versão diferente da versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da chave do Registro**

    Também é possível verificar os arquivos instalados por esta atualização de segurança analisando a seguinte chave do Registro:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Updates\\Windows 2000\\SP5\\KB920670\\Filelist

    **Observação** Essa chave do Registro pode não conter uma lista completa de arquivos instalados. Além disso, essa chave do Registro pode não ser criada corretamente se um administrador ou um OEM integrar ou adicionar a atualização de segurança 920670 aos arquivos-fonte da instalação do Windows.

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) à pessoa citada abaixo por trabalhar conosco para ajudar a proteger os clientes:

-   Pedram Amini, da [TippingPoint Security Research Team](http://www.tippingpoint.com/security), por relatar a vulnerabilidade de estouro de buffer de objeto hiperlink - [CVE-2006-3086](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3086).
-   Steve Tai da [CSC Australia Pty Limited](http://au.country.csc.com/en/) por relatar a Vulnerabilidade da função de objetos de hiperlink - [CVE-2006-3438.](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2006-3438)
-   **Obtendo outras atualizações de segurança:**

As atualizações para outros problemas de segurança estão disponíveis nos seguintes locais:

-   As atualizações de segurança estão disponíveis no [Centro de Download da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). você poderá encontrá-las com mais facilidade, executando uma pesquisa com a palavra-chave "patch\_de\_segurança".
-   Atualizações para plataformas do cliente estão disponíveis no [site Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747).

**Suporte:**

-   Os clientes nos EUA e Canadá podem receber suporte técnico dos [Serviços de suporte ao produto Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) pelo telefone 1-866-PCSAFETY. As ligações para obter suporte associado a atualizações de segurança são gratuitas.
-   Os clientes de outros países podem obter suporte nas subsidiárias locais da Microsoft. O suporte associado a atualizações de segurança é gratuito. Para obter mais informações sobre como entrar em contato com a Microsoft a fim de obter suporte a problemas, visite o site de [Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de segurança:**

-   O site [Microsoft TechNet Security](http://www.microsoft.com/brasil/technet/seguranca) fornece informações adicionais sobre segurança em produtos da Microsoft.
-   [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://www.microsoft.com/brasil/technet/seguranca/sus/)
-   [Microsoft Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx)
-   [MBSA](http://www.microsoft.com/brasil/technet/seguranca/mbsa/) (Microsoft Baseline Security Analyzer)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Catálogo do Windows Update: Para obter mais informações sobre o Catálogo do Windows Update, consulte o [artigo 323166 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/323166).
-   [Atualização do Office](http://go.microsoft.com/fwlink/?linkid=21135)

**Software Update Services:**

Usando o Microsoft Software Update Services (SUS), os administradores podem implantar de maneira rápida e confiável as últimas atualizações críticas e de segurança em servidores que executem o Windows 2000 e o Windows Server 2003 e em sistemas desktop que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implantar atualizações de segurança usando os serviços de atualização de software, visite o site [Software Update Services](http://www.microsoft.com/brasil/technet/seguranca/sus/).

**Windows Server Update Services:**

Usando o WSUS (Windows Server Update Services), os administradores podem implantar de forma rápida e confiável as mais recentes atualizações críticas e de segurança dos sistemas operacionais Windows 2000 e posterior, Office XP e posterior, Exchange Server 2003, e SQL Server 2000 nos sistemas operacionais Windows 2000 e posteriores.

Para obter mais informações sobre como implantar atualizações de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx).

**Systems Management Server:**

O SMS (Microsoft Systems Management Server) fornece uma solução corporativa altamente configurável para gerenciar atualizações. Ao usar o SMS, os administradores podem identificar os sistemas baseados no Windows que precisam de atualizações de segurança, bem como executar uma implantação controlada dessas atualizações em toda a empresa com o mínimo de interrupção para os usuários finais. Para obter mais informações sobre como os administradores podem usar o SMS 2003 para implantar atualizações de segurança, visite o site [Gerenciamento de Patches de Segurança do SMS 2003](http://go.microsoft.com/fwlink/?linkid=22939). Os usuários do SMS 2.0 também podem usar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) (site em inglês) para ajudar a implantar atualizações de segurança. Para obter mais informações sobre o SMS, visite o [site do SMS](http://www.microsoft.com/brasil/sms)

**Observação** O SMS usa o Microsoft Baseline Security Analyzer, a Microsoft Office Detection Tool e a Enterprise Update Scanning Tool para oferecer amplo suporte à detecção e à implantação da atualização do boletim de segurança. Algumas atualizações de software podem não ser detectadas por essas ferramentas. Os administradores podem usar os recursos de inventário do SMS nesses casos para apontar as atualizações de sistemas específicos. Para obter mais informações sobre esse procedimento, consulte o seguinte [site](http://go.microsoft.com/fwlink/?linkid=33341). Algumas atualizações de segurança exigirão direitos administrativos quando o sistema for reiniciado. Os administradores podem usar a Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) (sites em inglês) para instalar essas atualizações.

**Aviso de isenção de responsabilidade:**

As informações fornecidas na Base de Conhecimento Microsoft são apresentadas "no estado em que se encontram", sem garantia de qualquer tipo. A Microsoft se isenta de todas as garantias, expressas ou implícitas, inclusive as garantias de comercialização e adequação a um propósito específico. Em hipótese alguma a Microsoft Corporation ou seus fornecedores serão responsáveis por quaisquer danos, inclusive danos diretos, indiretos, incidentais, conseqüenciais, danos por lucros cessantes ou danos especiais, mesmo que a Microsoft Corporation ou seus fornecedores tenham sido alertados da possibilidade dos referidos danos. Como alguns estados não permitem a exclusão ou limitação de responsabilidade por danos conseqüenciais ou indiretos, a limitação acima pode não ser aplicável a você.

**Revisões:**

-   V1.0 (8 de agosto de 2006): Boletim publicado.

*Built at 2014-04-18T01:50:00Z-07:00*
