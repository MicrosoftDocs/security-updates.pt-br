---
TOCTitle: 'MS07-028'
Title: 'Microsoft Security Bulletin MS07-028 - Crítica'
ms:assetid: 'ms07-028'
ms:contentKeyID: 61233607
ms:mtpsurl: 'https://technet.microsoft.com/pt-BR/library/ms07-028(v=Security.10)'
---


Microsoft Security Bulletin MS07-028 - Crítica
==============================================

Vulnerabilidade no CAPICOM pode permitir a execução remota de códigos (931906)
------------------------------------------------------------------------------

Publicado: terça-feira, 8 de maio de 2007

**Versão:** 1.0

#### Resumo

**Quem deve ler este documento:** Clientes que usam CAPICOM ou BizTalk 2004

**Impacto da vulnerabilidade:** Execução Remota de Código

**Classificação máxima de gravidade:** Crítica

**Recomendação:** Os clientes devem aplicar a atualização imediatamente.

**Substituição da atualização de segurança:** Nenhuma

**Advertências:** Nenhuma

**Locais de softwares testados e de download de atualização de segurança:**

**Softwares afetados:**

-   CAPICOM — [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   Platform SDK Redistributable: CAPICOM — [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   BizTalk Server 2004 Service Pack 1 — [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)
-   BizTalk Server 2004 Service Pack 2 – [Fazer o download da atualização](http://www.microsoft.com/downloads/details.aspx?familyid=ca930018-4a66-4da6-a6c5-206df13af316)

**Softwares não afetados:**

-   BizTalk Server 2000
-   BizTalk Server 2002
-   BizTalk Server 2006

Os softwares dessa lista foram testados para se determinar se as versões são afetadas. O ciclo de vida do suporte das outras versões já terminou ou elas não são afetadas. Para determinar o ciclo de vida do suporte para seu produto e sua versão, visite o [site do Microsoft Support Lifecycle](http://go.microsoft.com/fwlink/?linkid=21742).

### Informações Gerais

Sinopse
-------


**Sinopse:**

Esta atualização elimina uma vulnerabilidade descoberta recentemente e reportada em particular. Cada vulnerabilidade está documentada em sua própria subseção na seção Detalhes da Vulnerabilidade deste boletim.

Recomendamos que os clientes apliquem a atualização imediatamente.

**Classificação de Gravidade e Identificadores de Vulnerabilidade:**

| Identificadores de Vulnerabilidade                                                                                         | Impacto da Vulnerabilidade | CAPICOM | Microsoft BizTalk Server 2004 |
|----------------------------------------------------------------------------------------------------------------------------|----------------------------|---------|-------------------------------|
| Vulnerabilidade do CAPICOM.Certificates - [CVE-2007-0940](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-0940) | Execução Remota de Código  | Crítica | Crítica                       |

Essa [avaliação](http://www.microsoft.com/brasil/security/boletins/rating.mspx) baseia-se nos tipos de sistemas afetados pela vulnerabilidade, seus padrões comuns de implantação e o efeito da exploração da vulnerabilidade sobre eles.

Perguntas mais freqüentes relacionadas a esta atualização de segurança
----------------------------------------------------------------------


**Quais atualizações esta versão substitui?**  
Esta atualização não substitui uma atualização de segurança anterior.

**Posso usar o MBSA (Microsoft Baseline Security Analyzer) para determinar se esta atualização é necessária?**  
A tabela a seguir fornece o resumo de detecção do MBSA para esta atualização de segurança.

| Produto             | MBSA 1.2.1 | EST | MBSA 2.0.1 |
|---------------------|------------|-----|------------|
| CAPICOM             | Não        | Sim | Sim        |
| BizTalk Server 2004 | Não        | Sim | Sim        |

Para obter mais informações sobre o MBSA, visite o [site do MBSA](http://www.microsoft.com/brasil/technet/seguranca/tools/mbsahome.mspx). Para obter mais informações sobre os softwares não detectados no momento pelo Microsoft Update e o MBSA 2.0, consulte [o artigo 895660 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/895660).

Para obter informações detalhadas, consulte o [artigo 910723 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/910723). Lista de resumo de detecção mensal e os artigos de diretrizes de implantação.

**O que é a EST (Enterprise Update Scanning Tool)?**  
Como parte de um compromisso contínuo de fornecer ferramentas de detecção para atualizações de segurança da classe de boletins, a Microsoft oferece uma ferramenta de detecção independente sempre que o Microsoft Baseline Security Analyzer 1.2.1 e a ODT (Office Detection Tool) não podem detectar se a atualização é necessária para um ciclo de lançamento MSRC. Essa ferramenta independente é denominada EST (Enterprise Update Scanning Tool) e foi criada para administradores de empresas. Quando uma versão da Enterprise Update Scan Tool é criada para um boletim específico, os clientes podem executar a ferramenta de uma interface de linha de comando e exibir os resultados do arquivo de saída XML. Para ajudar os clientes a utilizarem melhor a ferramenta, uma documentação detalhada será fornecida. Também há uma versão da ferramenta que oferece uma experiência integrada para administradores SMS.

**Possa usar uma versão da EST (Enterprise Update Scan Tool) para determinar se esta atualização é necessária?**  
Sim. A Microsoft criou uma versão da EST que determinará se é necessário aplicar esta atualização. Para obter links de download e mais informações sobre a versão da EST que está sendo lançada este mês, consulte o [artigo 894193 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/894193). Os clientes SMS devem ler a pergunta mais freqüente "Posso usar o SMS (Systems Management Server) para determinar se esta atualização é necessária?" para obter mais informações sobre SMS e EST.

**Posso usar o SMS (Systems Management Server) para determinar se esta atualização é necessária?**  
A tabela a seguir fornece o resumo de detecção de SMS para esta atualização de segurança.

| Produto             | SMS 2.0       | SMS 2003 |
|---------------------|---------------|----------|
| CAPICOM             | Sim (com EST) | Sim      |
| BizTalk Server 2004 | Sim (com EST) | Sim      |

SMS 2.0 e SMS 2003 Software Update Services (SUS) Feature Pack podem usar MBSA 1.2.1 para detecção e assim têm a mesma limitação listada anteriormente neste boletim relacionada a programas que o MBSA 1.2.1 não detecta.

Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Inventário da Atualização de Segurança (SUIT), pode ser usado pelo SMS para detectar atualizações de segurança. O SMS SUIT usa o mecanismo do MBSA 1.2.1 para detecção. Para obter mais informações sobre SUIT, visite o seguinte [site da Microsoft](http://support.microsoft.com/kb/894154/). Para obter mais informações sobre as limitações da SUIT, consulte o [artigo 306460 da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/306460/). O SMS SUS Feature Pack também inclui a ferramenta Office Inventory da Microsoft para detectar atualizações necessárias para aplicativos do Microsoft Office.

Para o SMS 2003, a ferramenta Inventário do SMS 2003 para Microsoft Updates pode ser usada pelo SMS para detectar as atualizações de segurança oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate) e que tenham suporte do [Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx). Para obter mais informações a ferramenta ITMU do SMS 2003, visite o seguinte [site da Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). O SMS 2003 também pode usar a ferramenta Office Inventory da Microsoft para detectar as atualizações necessárias dos aplicativos do Microsoft Office.

Para obter mais informações sobre o SMS, visite o [site do SMS](http://www.microsoft.com/brasil/sms).

Para obter informações detalhadas, consulte o [artigo 910723 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/910723). Lista de resumo de detecção mensal e os artigos de diretrizes de implantação.

**Posso usar o SMS (Systems Management Server) para determinar se outros programas instalados devem ser atualizados?**  
Sim. O SMS pode ajudar a detectar se existem outros programas que instalaram uma versão do componente vulnerável. O SMS pode pesquisar a existência do arquivo CAPICOM.dll. Atualize todas as versões de CAPICOM.dll que sejam anteriores à versão 2.1.0.2.

Detalhes da Vulnerabilidade
---------------------------


#### Vulnerabilidade do CAPICOM.Certificates - CVE-2007-0940:

Há uma vulnerabilidade de execução remota de código no CAPICOM (Cryptographic API Component Object Model) que pode permitir a um invasor que tenha explorado com sucesso essa vulnerabilidade assumir total controle do sistema afetado.

#### Fatores atenuantes para Vulnerabilidade do CAPICOM.Certificates - CVE-2007-0940:

-   Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Não há como um invasor forçar usuários a visitar o site especialmente criado. Em vez disso, o invasor terá que convencê-los a visitar o site, normalmente fazendo com que cliquem em um link para esse site. Depois de clicar no link, os usuários são instruídos a executarem várias ações. Um ataque pode ocorrer após a execução dessas ações.
-   O invasor que explorar com êxito a vulnerabilidade poderá obter os mesmos direitos que o usuário local. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.
-   Por padrão, todas as versões compatíveis do Microsoft Outlook e do Microsoft Outlook Express abrem mensagens de email em HTML na zona de sites restritos. A zona Sites restritos ajuda a reduzir o número de ataques bem-sucedidos que exploram essa vulnerabilidade, ao evitar que os controles ActiveX e de Script Ativos sejam usados durante a leitura de email em HTML. Entretanto, se um usuário clicar em um link dentro de um email, ele ainda estará vulnerável a este problema por meio do cenário de ataque baseado na Web.
-   Por padrão, o Internet Explorer no Windows Server 2003 é executado em um modo restrito, conhecido como [Configuração de Segurança Reforçada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Esse modo define o nível de segurança para a zona da Internet como Alto. Este é um fator atenuante para sites que não tenham sido adicionados à zona Sites confiáveis do Internet Explorer. Consulte a subseção Perguntas mais freqüentes desta vulnerabilidade para obter mais informações sobre a Configuração de Segurança Reforçada do Internet Explorer.
-   Por padrão, esse controle ActiveX não é incluído na lista de permissões padrão para controles ActiveX no Internet Explorer 7. Somente os clientes que tenham aprovado explicitamente esse controle usando o recurso de opção de ativação de ActiveX estão suscetíveis a tentativas de explorar essa vulnerabilidade. No entanto, se um cliente tiver usado este controle ActiveX numa versão prévia do Internet Explorer, este controle ActiveX estará habilitado para funcionar no Internet Explorer 7, ainda que o cliente não o tenha aprovado explicitamente usando o recurso de opção de ativação de ActiveX.

#### Soluções alternativas para a vulnerabilidade do CAPICOM.Certificates - CVE-2007-0940:

A Microsoft testou as seguintes soluções alternativas. Apesar de essas soluções alternativas não corrigirem a vulnerabilidade subjacente, elas ajudam a bloquear vetores de ataque conhecidos. Quando uma solução alternativa reduz a funcionalidade, ela é identificada na seção a seguir.

-   **Desativar tentativas de instanciar o controle CAPICOM no Internet Explorer**

    Você pode desativar as tentativas de instanciar esse controle ActiveX, definindo o kill bit (bit de eliminação) do controle no Registro.

    **Aviso** O uso incorreto do Editor do Registro pode causar problemas graves e exigir a reinstalação do sistema operacional. A Microsoft não garante a solução de problemas resultantes do uso incorreto do Editor do Registro. Você é responsável pelo uso do Editor do Registro.

    Para obter etapas detalhadas para evitar que um controle seja executado no Internet Explorer, consulte o [artigo 240797 (em inglês) da Base de Conhecimento Microsoft.](http://support.microsoft.com/kb/240797) Siga as etapas no artigo para criar um valor de Compatibility Flags no Registro e evitar que um objeto COM seja instanciado no Internet Explorer.

    Para definir o kill bit (bit de eliminação) para os CLSIDs com o valor de:

    -   {17E3A1C3-EA8A-4970-AF29-7F54610B1D4C}
    -   {FBAB033B-CDD0-4C5E-81AB-AEA575CD1338}

    Cole o texto a seguir em um editor de texto como o Bloco de Notas. Em seguida, salve o arquivo usando a extensão de nome de arquivo .reg.

    Windows Registry Editor Versão 5.00
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{17E3A1C3-EA8A-4970-AF29-7F54610B1D4C}\]

    "Compatibility Flags"=dword:00000400

    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{FBAB033B-CDD0-4C5E-81AB-AEA575CD1338}\]

    "Compatibility Flags"=dword:00000400

    Você pode aplicar este arquivo .reg em sistemas individuais clicando duas vezes nele. Você também pode aplicá-lo entre domínios usando a Diretiva de Grupo. Para obter mais informações sobre a Diretiva de Grupo, visite estes sites da Microsoft:

    [Conjunto de Diretivas de Grupo](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd.mspx)

    [O que é o Editor de Objeto de Diretiva de Grupo?](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/47ba1311-6cca-414f-98c9-2d7f99fca8a3.mspx)

    [Ferramentas e configurações principais da Diretiva de Grupo](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/e926577a-5619-4912-b5d9-e73d4bdc9491.mspx)

    **Observação:** Você deve reiniciar o Internet Explorer para que as alterações tenham efeito.

    **Impacto da solução alternativa**: O controle CAPICOM não pode mais ser exibido nem funcionar corretamente.

-   **Configure o Internet Explorer para notificá-lo antes da execução de controles ActiveX ou desative os controles ActiveX na zona de segurança da Internet e da intranet local.**

    Você pode se proteger contra essa vulnerabilidade, alterando as configurações do Internet Explorer para avisá-lo antes de executar os controles ActiveX. Para isso, siga estas etapas:

    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.
    2.  Clique na guia **Segurança**.
    3.  Clique em **Internet** e, em seguida, clique em **Nível Personalizado**.
    4.  Em **Configurações**, na seção **Plug-ins e controles ActiveX**, em **Executar controles ActiveX e plug-ins**, clique em **Avisar** ou em **Desativar** e, em seguida, clique em **OK**.
    5.  Clique em **Intranet local** e, em seguida, clique em **Nível Personalizado**.
    6.  Em **Configurações**, na seção **Plug-ins e controles ActiveX**, em **Executar controles ActiveX e plug-ins**, clique em **Avisar** ou em **Desativar** e, em seguida, clique em **OK**.
    7.  Clique em **OK** duas vezes para retornar ao Internet Explorer.

    **Impacto da solução alternativa:** A notificação antes da execução de controles ActiveX apresenta efeitos colaterais. Muitos sites que não estão na Internet ou na intranet usam o ActiveX para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou um banco online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução dos controles ActiveX é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Para cada notificação, se você sentir que confia no site que está visitando, clique em **Sim** para executar os controles ActiveX. Se não quiser ser avisado para todos esses sites, use os passos descritos em “Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer”.

    **Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer**

    Depois de definir o Internet Explorer para solicitar confirmação antes de executar controles ActiveX e scripts ativos na zona da Internet e da Intranet local, você pode adicionar sites confiáveis à zona de Sites confiáveis do Internet Explorer. Isso permitirá que você continue usando os sites confiáveis exatamente como faz atualmente, enquanto ajuda a proteger-se de ataques em sites não confiáveis. É recomendável adicionar somente sites nos quais você confia à zona de Sites confiáveis.

    Para isso, siga estas etapas:

    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique na guia **Segurança**.
    2.  Na caixa **Selecione uma zona de conteúdo da Web para especificar suas configurações de segurança**, clique em **Sites Confiáveis** e, em seguida, clique em **Sites**.
    3.  Se desejar adicionar sites que não requerem um canal criptografado, clique para desmarcar a caixa de seleção **Exigir verificação do servidor (https:) para todos os sites desta zona**.
    4.  Na caixa **Adicionar este site à zona,** digite a URL de um site em que confia e, em seguida, clique em **Adicionar**.
    5.  Repita essas etapas para cada site que você deseja adicionar à zona.
    6.  Clique em **OK** duas vezes para aceitar as alterações e retornar ao Internet Explorer.

    **Observação** Adicione os sites que você tem certeza de que não realizarão ações mal-intencionadas em seu computador. Existem dois sites específicos que você deve adicionar: "\*.windowsupdate.microsoft.com" e “\*.update.microsoft.com” (sem as aspas). Esses sites hospedam a atualização e exigem um controle ActiveX para instalá-la.

-   **Defina as configurações de zona de segurança da Internet e da intranet local como "Alto" para ser notificado antes da execução de controles ActiveX e scripts ativos nessas zonas**

    Você pode se proteger contra essa vulnerabilidade alterando suas configurações para que a zona de segurança da Internet solicite uma confirmação antes de executar os componentes ActiveX. É possível fazer isso configurando a segurança do navegador como **Alta**.

    Para aumentar o nível de segurança da navegação no Microsoft Internet Explorer, faça o seguinte:

    1.  No menu **Ferramentas** do Internet Explorer, clique em **Opções da Internet**.
    2.  Na caixa de diálogo **Opções da Internet**, clique na guia **Segurança** e, em seguida, no ícone **Internet**.
    3.  Em **Nível de segurança para esta zona**, mova o controle deslizante para **Alto**. Isso define o nível de segurança para todos os sites visitados como **Alto**.

    **Observação** Se o controle deslizante não estiver visível, clique em **Nível padrão** e então mova o controle deslizante para **Alto**.

    **Observação** A configuração do nível como **Alto** pode fazer com que alguns sites não funcionem corretamente. Se você encontrar dificuldades ao usar um site após alterar a configuração, mas tiver certeza de que o site é seguro, é possível adicionar esse site à lista de sites confiáveis. Isso permite que o site funcione corretamente, mesmo com a configuração de segurança definida como **Alta**.

    **Impacto da solução alternativa:** A notificação antes da execução de controles ActiveX apresenta efeitos colaterais. Muitos sites que não estão na Internet ou na intranet usam o ActiveX para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou um banco online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução dos controles ActiveX é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Para cada notificação, se você sentir que confia no site que está visitando, clique em **Sim** para executar os controles ActiveX. Se não quiser ser avisado para todos esses sites, use os passos descritos em “Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer”.

    **Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer**

    Depois de definir o Internet Explorer para solicitar confirmação antes de executar controles ActiveX e scripts ativos na zona da Internet e da Intranet local, você pode adicionar sites confiáveis à zona de Sites confiáveis do Internet Explorer. Isso permitirá que você continue usando os sites confiáveis exatamente como faz atualmente, enquanto ajuda a proteger-se de ataques em sites não confiáveis. É recomendável adicionar somente sites nos quais você confia à zona de Sites confiáveis.

    Para isso, siga estas etapas:

    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique na guia **Segurança**.
    2.  Na caixa **Selecione uma zona de conteúdo da Web para especificar suas configurações de segurança**, clique em **Sites Confiáveis** e, em seguida, clique em **Sites**.
    3.  Se desejar adicionar sites que não requerem um canal criptografado, clique para desmarcar a caixa de seleção **Exigir verificação do servidor (https:) para todos os sites desta zona**.
    4.  Na caixa **Adicionar este site à zona,** digite a URL de um site em que confia e, em seguida, clique em **Adicionar**.
    5.  Repita essas etapas para cada site que você deseja adicionar à zona.
    6.  Clique em **OK** duas vezes para aceitar as alterações e retornar ao Internet Explorer.

    **Observação** Adicione os sites que você tem certeza de que não realizarão ações mal-intencionadas em seu computador. Existem dois sites específicos que você deve adicionar: "\*.windowsupdate.microsoft.com" e “\*.update.microsoft.com” (sem as aspas). Esses sites hospedam a atualização e exigem um controle ActiveX para instalá-la.

#### Perguntas freqüentes sobre a vulnerabilidade do CAPICOM.Certificates - CVE-2007-0940:

**Qual é o escopo da vulnerabilidade?**  
Essa é uma vulnerabilidade de execução remota de código. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

**O que provoca a vulnerabilidade?**  
A maneira que a classe de Certificados CAPICOM trata determinadas entradas gera a vulnerabilidade. Se forem transmitidos dados inesperados, o controle ActiveX pode falhar de forma que pode permitir a execução remota de código.

**O que é CAPICOM.Certificates?**  
O CAPICOM.Certificates é um controle ActiveX que fornece aos criadores de scripts (VBS, ASP, ASP.NET, etc.) um método de criptografia de dados com base na funcionalidade Windows CryptoAPI segura subjacente. O CAPICOM Suite também está disponível para download como [Platform SDK Redistributable: CAPICOM](http://www.microsoft.com/downloads/details.aspx?familyid=860ee43a-a843-462f-abb5-ff88ea5896f6) e também faz parte do Windows Platform SDK e do Window Driver Kit.

**E se eu desenvolver aplicativos ou software e redistribuir o CAPICOM?**  
É necessário baixar a versão mais recente do [Platform SDK Redistributable: CAPICOM.](http://www.microsoft.com/downloads/details.aspx?familyid=860ee43a-a843-462f-abb5-ff88ea5896f6) Esta nova versão contém o CAPICOM.dll atualizado que está associado a esta atualização de segurança.

**Como vou saber se tenho o CAPICOM.Certificates instalado e registrado?**  
É possível verificar se você tem o CAPICOM instalado procurando o arquivo CAPICOM.dll em seu sistema. Se você tiver a versão 2.1.01 ou inferior, deverá atualizar seu sistema.

É possível verificar se você tem qualquer combinação das seguintes chaves de Registro para verificar se há uma versão vulnerável do controle ActiveX do CAPICOM.Certificates registrada em seu sistema:

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.1\\CLSID

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.2\\CLSID

HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.3\\CLSID

**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

**Por que a versão antiga do CAPICOM.dll ainda está no sistema depois da instalação dessa atualização de segurança?**  
Os usuários podem ter instalado o CAPICOM.dll de uma fonte diferente da Microsoft. O CAPICOM.dll pode ter sido instalado por um produto que não seja da Microsoft. Uma vez que a atualização de segurança não pode determinar a origem da versão anterior do CAPICOM.dll, ela é deixada no sistema para assegurar a compatibilidade dos aplicativos. A versão anterior não deixa seu sistema vulnerável a esta vulnerabilidade.

**Quem pode explorar a vulnerabilidade?**  
Em cenário de ataque baseado na Web, o invasor terá que hospedar um site que contém uma página da Web usada para explorar a vulnerabilidade. Não há como um invasor forçar usuários a visitar o site especialmente criado. Em vez disso, o invasor terá que convencê-los a visitar o site, normalmente fazendo com que cliquem em um link que leve para esse site.

**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
Esta vulnerabilidade requer que um usuário esteja conectado e visite um site para que uma ação mal-intencionada ocorra. Portanto, os sistemas nos quais o CAPICOM Certificates esteja instalado e registrado e o Internet Explorer seja usado com freqüência, como estações de trabalho ou servidores de terminal, estão mais expostos a essa vulnerabilidade.

**Estou executando o Internet Explorer 7. Isso atenua essa vulnerabilidade?**  
Sim. Os clientes que executam o Internet Explorer 7 com configurações padrão não estão vulneráveis até que o controle CAPICOM Certificates tenha sido ativado pelo recurso de opção de ativação de ActiveX na Zona da Internet. No entanto, se um cliente tiver usado este controle ActiveX numa versão prévia do Internet Explorer, este controle ActiveX estará habilitado para funcionar no Internet Explorer 7, ainda que o cliente não o tenha aprovado explicitamente usando o recurso de opção de ativação de ActiveX.

**O que é o recurso de opção de ativação de ActiveX no Internet Explorer 7?**  
O Internet Explorer 7 inclui um recurso de opção de ativação do ActiveX, o que significa que praticamente todos os controles ActiveX pré-instalados são desativados por padrão. Os usuários são avisados pela Barra de Informações antes que possam acessar um controle ActiveX previamente instalado que ainda não tenha sido usado na Internet. Isto habilita o usuário a permitir ou negar acesso de acordo com o controle. Para obter mais informação sobre este e outros recursos novos, consulte a [página de recursos do Windows Internet Explorer 7.](http://www.microsoft.com/windows/ie/ie7/about/features/default.mspx)

**Estou executando o Internet Explorer no Windows Server 2003. Isso atenua essa vulnerabilidade?**  
Sim. Por padrão, o Internet Explorer no Windows Server 2003 é executado em um modo restrito, conhecido como [Configuração de Segurança Reforçada](http://msdn.microsoft.com/library/default.asp?url=/workshop/security/szone/overview/esc_changes.asp). Esse modo define o nível de segurança para a zona da Internet como Alto. Este é um fator atenuante para sites que não tenham sido adicionados à zona Sites confiáveis do Internet Explorer. Consulte a seção Perguntas mais freqüentes desta atualização de segurança para obter mais informações sobre a Configuração de Segurança Reforçada do Internet Explorer.

**O que é a Configuração de segurança reforçada do Internet Explorer?**  
A Configuração de Segurança Reforçada do Internet Explorer é um grupo de definições pré-configuradas do Internet Explorer que reduz a probabilidade de um usuário ou administrador baixar e executar um conteúdo da Web mal-intencionado em um servidor. A Configuração de Segurança Reforçada do Internet Explorer reduz essa ameaça modificando muitas configurações relacionadas à segurança, inclusive as configurações das guias Segurança e Avançado nas Opções da Internet. Algumas das principais modificações incluem:

-   O nível de segurança para a zona da Internet é definido como **Alto**. Essa configuração desativa scripts, componentes ActiveX, conteúdo em HTML da máquina virtual da Microsoft (Microsoft VM) e downloads de arquivos.
-   A detecção automática de sites da intranet é desabilitada. Essa definição atribui todos os sites da intranet e todos os caminhos de UNC (Convenção universal de nomenclatura), que não estão listados explicitamente na zona de intranet local, para a zona da Internet.
-   A instalação por demanda e as extensões de navegadores não-Microsoft são desativadas. Essa definição evita que páginas da Web instalem componentes automaticamente e evita a execução de extensões que não são da Microsoft.
-   O conteúdo de multimídia é desabilitado. Essa definição evita a execução de música, animações e clipes de vídeo.

Para obter mais informações sobre a Configuração de Segurança Reforçada do Internet Explorer, consulte o guia Gerenciamento de Configurações de Segurança Avançadas do Internet Explorer, localizado no seguinte [site](http://www.microsoft.com/downloads/details.aspx?familyid=d41b036c-e2e1-4960-99bb-9757f7e9e31b&displaylang=en).

**O que a atualização faz?**  
A atualização elimina a vulnerabilidade, modificando o modo como o controle ActiveX do CAPICOM.Certificates executa a validação de parâmetros. Ela também resolve problemas adicionais descobertos por investigações internas.

**Quando esse boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Não. A Microsoft recebeu informações sobre essa vulnerabilidade por meio de divulgação responsável.

**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido usada publicamente para atacar clientes e não testemunhou nenhum exemplo de publicação de código de verificação de conceito, quando este boletim de segurança foi lançado pela primeira vez.

Informações de atualização de segurança
---------------------------------------


**Softwares afetados:**

Para obter informações sobre a atualização de segurança específica para seu software afetado, consulte a seção apropriada:

#### CAPICOM e BizTalk Server 2004

**Pré-requisitos**
Esta atualização de segurança exige que o CAPICOM Certificates esteja instalado e registrado. O BizTalk Server 2004 instala o CAPICOM Certificates. Esta atualização funcionará de maneira independente e em instalações do Biztalk Server 2004. Os produtos que não são da Microsoft podem redistribuir e instalar o CAPICOM.dll. Consulte a pergunta freqüente “**Como vou saber se tenho o CAPICOM.Certificates instalado e registrado?”** para obter mais detalhes.

**Inclusão em Service Packs futuros**
A atualização para esse problema pode ser incluída em um Service Pack futuro ou distribuição de atualização do Microsoft BizTalk Server 2004.

**Informações de instalação**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Modos de instalação
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/q**
</td>
<td style="border:1px solid black;">
Especifica o modo silencioso ou suprime avisos durante a extração dos arquivos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/q:u**
</td>
<td style="border:1px solid black;">
Especifica o modo silencioso-usuário, que exibe algumas caixas de diálogo ao usuário.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/q:a**
</td>
<td style="border:1px solid black;">
Especifica o modo silencioso do administrador, que não exibe nenhuma caixa de diálogo ao usuário.
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/t:**&lt;caminho completo&gt;
</td>
<td style="border:1px solid black;">
Especifica a pasta de destino para extração dos arquivos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/c**
</td>
<td style="border:1px solid black;">
Extrai os arquivos sem instalá-los. Se o caminho /T: path não é especificado, o usuário será solicitado a fornecer uma pasta de destino.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/c:**&lt;Cmd&gt;
</td>
<td style="border:1px solid black;">
Substitui o comando Instalar definido pelo autor. Especifica o caminho e o nome do arquivo .inf ou .exe da instalação.
</td>
</tr>
</table>
 
**Observação** Essas opções não funcionam necessariamente com todas as atualizações. Se uma opção não estiver disponível, essa funcionalidade será necessária para a instalação apropriada da atualização. Se a instalação não foi bem-sucedida, consulte o profissional de suporte.

Para obter informações adicionais sobre as opções de instalação com suporte, consulte o [artigo 197147 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/197147).

**Informações de implantação**

Para instalar a atualização de segurança sem nenhuma intervenção do usuário, use o seguinte comando em um prompt de comando:

**CAPICOM-KB931906-v2102 /q:a**

Para obter informações sobre como implantar esta atualização de segurança com os serviços de atualização de software, visite o [site Software Update Services](http://www.microsoft.com/brasil/technet/seguranca/sus/). Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx). Esta atualização de segurança também está disponível no [site Microsoft Update](http://update.microsoft.com/microsoftupdate).

**Necessidade de Reinicialização**

Essa atualização não requer reinicialização.

**Informações sobre remoção**

Para remover esta atualização, use a ferramenta Adicionar ou Remover Programas no Painel de Controle.

**Informações do Arquivo**

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

| Nome do arquivo | Versão  | Data                    | Hora  | Tamanho |
|-----------------|---------|-------------------------|-------|---------|
| License.mht     | ND      | 26 de fevereiro de 2007 | 23:16 | 142.534 |
| License.rtf     | ND      | 26 de fevereiro de 2007 | 23:16 | 134.577 |
| CAPICOM.dll     | 2.1.0.2 | 11 de abril de 2007     | 18:11 | 511.328 |

**Verificando a aplicação da atualização**

-   **Verificação de Versão do Arquivo**

    **Observação** Como existem diversas versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu computador. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.  
        **Observação:** dependendo da versão do sistema operacional ou dos programas instalados, alguns dos arquivos listados na tabela de informações de arquivos talvez não estejam instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no computador comparando-o com a versão documentada na tabela de informações de arquivos correta.  
        **Observação** Atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Também é possível verificar os arquivos instalados por esta atualização de segurança analisando a seguinte chave do Registro:

    HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Classes\\CAPICOM.Certificates.4\\CLSID

### Outras informações

**Agradecimentos**

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) à pessoa citada abaixo por trabalhar conosco para ajudar a proteger os clientes:

-   Chris Ries, da [VigilantMinds Inc.](http://www.vigilantminds.com/), por reportar a vulnerabilidade do CAPICOM.Certificates (CVE-2007-0940)

**Obtendo Outras Atualizações de Segurança:**

As atualizações para outros problemas de segurança estão disponíveis nos seguintes locais:

-   As atualizações de segurança estão disponíveis no [Centro de Download da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). você poderá encontrá-las com mais facilidade, executando uma pesquisa com a palavra-chave "patch\_de\_segurança".
-   Atualizações para plataformas do cliente estão disponíveis no [site Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747).

**Suporte:**

-   Os clientes nos EUA e Canadá podem receber suporte técnico dos [Serviços de suporte ao produto Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) pelo telefone 1-866-PCSAFETY. As ligações para obter suporte associado a atualizações de segurança são gratuitas.
-   Os clientes de outros países podem obter suporte nas subsidiárias locais da Microsoft. O suporte associado a atualizações de segurança é gratuito. Para obter mais informações sobre como entrar em contato com a Microsoft a fim de obter suporte a problemas, visite o [site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

**Recursos de segurança:**

-   O site [Microsoft TechNet Security](http://www.microsoft.com/brasil/technet/seguranca) fornece informações adicionais sobre segurança em produtos da Microsoft.
-   [TechNet Update Management Center](http://go.microsoft.com/fwlink/?linkid=69903)
-   [Microsoft Software Update Services](http://www.microsoft.com/brasil/technet/seguranca/sus/)
-   [Microsoft Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx)
-   [Microsoft Baseline Security Analyzer](http://www.microsoft.com/brasil/technet/seguranca/mbsa/) (MBSA)
-   [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130)
-   [Microsoft Update](http://update.microsoft.com/microsoftupdate)
-   Catálogo do Windows Update: Para obter mais informações sobre o Catálogo do Windows Update, consulte o [artigo 323166 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/323166).
-   [Atualização do Office](http://go.microsoft.com/fwlink/?linkid=21135)

**Serviços de Atualização de Software:**

Usando o Microsoft Software Update Services (SUS), os administradores podem implantar de maneira rápida e confiável as últimas atualizações críticas e de segurança em servidores que executem o Windows 2000 e o Windows Server 2003 e em sistemas desktop que executem o Windows 2000 Professional ou o Windows XP Professional.

Para obter mais informações sobre como implantar atualizações de segurança usando os serviços de atualização de software, visite o [site Software Update Services](http://www.microsoft.com/brasil/technet/seguranca/sus/).

**Windows Server Update Services**

Usando o WSUS (Windows Server Update Services), os administradores podem implantar de forma rápida e confiável as mais recentes atualizações críticas e de segurança dos sistemas operacionais Windows 2000 e posterior, Office XP e posterior, Exchange Server 2003, e SQL Server 2000 nos sistemas operacionais Windows 2000 e posteriores.

Para obter mais informações sobre como implantar atualizações de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx).

**Systems Management Server:**

O SMS (Microsoft Systems Management Server) fornece uma solução corporativa altamente configurável para gerenciar atualizações. Ao usar o SMS, os administradores podem identificar os sistemas baseados no Windows que precisam de atualizações de segurança, bem como executar uma implantação controlada dessas atualizações em toda a empresa com o mínimo de interrupção para os usuários finais. Para obter mais informações sobre como os administradores podem usar o SMS 2003 para implantar atualizações de segurança, visite o [site Gerenciamento de Patches de Segurança do SMS 2003](http://go.microsoft.com/fwlink/?linkid=22939). Os usuários do SMS 2.0 também podem usar o [Software Updates Service Feature Pack](http://go.microsoft.com/fwlink/?linkid=33340) (site em inglês) para ajudar a implantar atualizações de segurança. Para obter mais informações sobre o SMS, visite o [site do SMS](http://www.microsoft.com/brasil/sms).

**Observação** O SMS usa o Microsoft Baseline Security Analyzer, a Microsoft Office Detection Tool e a Enterprise Update Scanning Tool para oferecer amplo suporte à detecção e à implantação da atualização do boletim de segurança. Algumas atualizações de software podem não ser detectadas por essas ferramentas. Os administradores podem usar os recursos de inventário do SMS nesses casos para apontar as atualizações de sistemas específicos. Para obter mais informações sobre as classificações de gravidade, visite este [site](http://go.microsoft.com/fwlink/?linkid=33341) (em inglês). Algumas atualizações de segurança exigirão direitos administrativos quando o sistema for reiniciado. Os administradores podem usar a Elevated Rights Deployment Tool (disponível no [SMS 2003 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=33387) e no [SMS 2.0 Administration Feature Pack](http://go.microsoft.com/fwlink/?linkid=21161)) (sites em inglês) para instalar essas atualizações.

**Aviso de isenção de responsabilidade:**

As informações fornecidas na Base de Conhecimento Microsoft são apresentadas "no estado em que se encontram", sem garantia de qualquer tipo. A Microsoft se isenta de todas as garantias, expressas ou implícitas, inclusive as garantias de comercialização e adequação a um propósito específico. Em hipótese alguma a Microsoft Corporation ou seus fornecedores serão responsáveis por quaisquer danos, inclusive danos diretos, indiretos, incidentais, conseqüenciais, danos por lucros cessantes ou danos especiais, mesmo que a Microsoft Corporation ou seus fornecedores tenham sido alertados da possibilidade dos referidos danos. Como alguns estados não permitem a exclusão ou limitação de responsabilidade por danos conseqüenciais ou indiretos, a limitação acima pode não ser aplicável a você.

**Revisões:**

-   V1.0 (08 de maio de 2007): Boletim publicado.

*Built at 2014-04-18T01:50:00Z-07:00*
