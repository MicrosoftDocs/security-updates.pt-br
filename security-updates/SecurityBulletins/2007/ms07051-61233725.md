---
TOCTitle: 'MS07-051'
Title: 'Microsoft Security Bulletin MS07-051 - Crítica'
ms:assetid: 'ms07-051'
ms:contentKeyID: 61233725
ms:mtpsurl: 'https://technet.microsoft.com/pt-BR/library/ms07-051(v=Security.10)'
---


Microsoft Security Bulletin MS07-051 - Crítica
==============================================

Vulnerabilidade no Microsoft Agent pode permitir a execução remota de código (938827)
-------------------------------------------------------------------------------------

Publicado: terça-feira, 12 de junho de 2007

**Versão:** 1.0

### Informações Gerais

#### Sinopse

Esta atualização de segurança crítica elimina uma vulnerabilidade reportada em particular. Existe uma vulnerabilidade de execução remota de código no Microsoft Agent na forma como ele trata determinadas URLs especialmente criadas. A vulnerabilidade pode permitir que um invasor execute código remotamente no sistema afetado. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.

Esta é uma atualização de segurança crítica para o Microsoft Windows 2000 Service Pack 4. Para obter mais informações, consulte a subseção **Softwares afetados e não afetados**, nesta seção.

A atualização de segurança elimina a vulnerabilidade mudando o modo como o Microsoft Agent administra URLs especialmente criadas. Para obter mais informações sobre a vulnerabilidade, consulte a subseção Perguntas freqüentes relacionada à entrada da vulnerabilidade específica na próxima seção **Informações sobre a vulnerabilidade**.

**Recomendação.** A Microsoft recomenda que os clientes apliquem a atualização imediatamente.

**Problemas conhecidos.** Nenhuma

#### Software afetado e não afetado

O software relacionado aqui foi testado para determinar se as versões ou edições são afetadas. O ciclo de vida do suporte das outras versões ou edições já terminou ou elas não são afetadas. Para determinar o ciclo de vida do suporte para sua versão ou edição de software, visite o site [Ciclo de Vida do Suporte Microsoft.](http://go.microsoft.com/fwlink/?linkid=21742)

**Softwares afetados**

| Sistema operacional                                                                                                                    | Impacto máximo à segurança | Avaliação de gravidade agregada | Boletins substituídos por esta atualização                                           |
|----------------------------------------------------------------------------------------------------------------------------------------|----------------------------|---------------------------------|--------------------------------------------------------------------------------------|
| [Microsoft Windows 2000 Service Pack 4](http://www.microsoft.com/downloads/details.aspx?familyid=7cd248ed-d154-4dce-89ef-ceefd2700965) | Execução Remota de Código  | Crítica                         | [MS07-020](http://www.microsoft.com/brasil/technet/seguranca/bulletin/ms07-020.mspx) |

**Softwares não afetados**

| Sistema operacional                                                                                                           |
|-------------------------------------------------------------------------------------------------------------------------------|
| Windows XP Service Pack 2                                                                                                     |
| Windows XP Professional x64 Edition e Windows XP Professional x64 Edition Service Pack 2                                      |
| Windows Server 2003 Service Pack 1 e Server 2003 Service Pack 2                                                               |
| Windows Server 2003 x64 Edition e Windows Server 2003 x64 Edition Service Pack 2                                              |
| Windows Server 2003 com SP1 para sistemas baseados no Itanium e Windows Server 2003 com SP2 para sistemas baseados no Itanium |
| Windows Vista                                                                                                                 |
| Windows Vista x64 Edition                                                                                                     |

Perguntas mais freqüentes relacionadas a esta atualização de segurança
----------------------------------------------------------------------


**Uso uma versão mais antiga do software discutido neste boletim de segurança. O que devo fazer?**  
Os softwares afetados listados neste boletim foram testados para determinar que versões são afetadas. Outras versões passaram seu ciclo de vida de suporte. Para determinar o ciclo de vida do suporte para sua versão de software, visite o site [Ciclo de Vida do Suporte Microsoft](http://go.microsoft.com/fwlink/?linkid=21742).

Os clientes que possuem versões anteriores do software devem priorizar a migração para as versões com suporte, a fim de evitar uma possível exposição a vulnerabilidades. Para obter mais informações sobre o ciclo de vida do produto Windows, visite o site [Ciclo de Vida do Suporte Microsoft](http://go.microsoft.com/fwlink/?linkid=21742). Para obter mais informações sobre o período de suporte estendido da atualização de segurança dessas versões de software, visite o site [Microsoft Product Support Services](http://go.microsoft.com/fwlink/?linkid=33328).

Os clientes que precisarem de suporte adicional para software mais antigo deverão entrar em contato com o representante da equipe de contas da Microsoft, o gerente técnico da conta ou o representante do parceiro Microsoft apropriado para obter opções de suporte personalizadas. Os clientes sem um contrato Alliance, Premier ou Authorized podem entrar em contato com o escritório de vendas local da Microsoft. Para obter informações de contato, visite o site de [Informações internacionais da Microsoft](http://go.microsoft.com/fwlink/?linkid=33329), selecione o país e clique em **Go** para ver uma lista de telefones. Ao ligar, peça para falar com o gerente de vendas local de Suporte Premier. Para obter mais informações, consulte a seção [Perguntas mais freqüentes sobre o ciclo de vida do suporte ao produto sistema operacional Windows](http://go.microsoft.com/fwlink/?linkid=33330).

### Informações da vulnerabilidade

Classificação de gravidade e Identificadores de vulnerabilidade
---------------------------------------------------------------


 
<p></p>
<table style="border:1px solid black;">
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th style="border:1px solid black;" >Softwares afetados</th>
<th style="border:1px solid black;" >Vulnerabilidade de execução remota de código no Agent – CVE-2007-3040</th>
<th style="border:1px solid black;" >Avaliação de gravidade agregada</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="border:1px solid black;">Microsoft Windows 2000 Service Pack 4</td>
<td style="border:1px solid black;"><strong>Crítica</strong>
Execução Remota de Código</td>
<td style="border:1px solid black;"><strong>Crítica</strong></td>
</tr>
</tbody>
</table>
  
Vulnerabilidade de execução remota de código no Agent – CVE-2007-3040  
---------------------------------------------------------------------
  

Existe uma vulnerabilidade de execução remota de código no Microsoft Agent na forma como ele trata determinadas URLs especialmente criadas. A vulnerabilidade pode permitir que um invasor execute código remotamente no sistema afetado. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.
  
Para exibir esta vulnerabilidade como uma entrada padrão na lista Common Vulnerabilities and Exposures, consulte [CVE-2007-3040](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-3040).
  
#### Fatores atenuantes da vulnerabilidade de execução remota de código no Agent – CVE-2007-3040
  
A atenuação refere-se a uma configuração, configuração comum ou prática recomendada geral, existindo num estado padrão, que possa reduzir a gravidade de exploração de uma vulnerabilidade. Os fatores de atenuação a seguir podem ser úteis em sua situação:
  
-   Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Não há como um invasor forçar usuários a visitar o site mal-intencionado. Em vez disso, o invasor terá que atraí-los para lá, normalmente fazendo com que cliquem em um link para esse site.  
-   O invasor que explorar com êxito a vulnerabilidade poderá obter os mesmos direitos que o usuário local. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.  
-   A zona Sites restritos ajuda a reduzir os ataques que podem tentar explorar essa vulnerabilidade, ao evitar que os controles ActiveX sejam usados durante a leitura de mensagens de email em HTML. No entanto, se um usuário clicar em um link em uma mensagem de email, ele ainda pode estar vulnerável a este problema, de acordo com o cenário de ataque baseado na Web.  
-   Por padrão, todas as versões compatíveis do Microsoft Outlook e do Microsoft Outlook Express abrem mensagens de email em HTML na zona de sites restritos. A zona Sites restritos ajuda a reduzir os ataques que podem tentar explorar essa vulnerabilidade, ao evitar que os controles ActiveX e de Script Ativos sejam usados durante a leitura de email em HTML. Entretanto, se um usuário clicar em um link dentro de um email, ele ainda estará vulnerável a este problema, de acordo com o cenário de ataque baseado na Web.
  
#### Soluções alternativas para a vulnerabilidade de execução remota de código no Agent – CVE-2007-3040
  
A solução alternativa refere-se a uma configuração ou alteração de configuração que não corrige a vulnerabilidade subjacente mas que ajudaria a bloquear vetores de ataque conhecidos antes de aplicar a atualização. A Microsoft testou as soluções alternativas e estados a seguir como parte do cenário que implica se uma solução alternativa reduziria funcionalidade:
  
-   **Impeça temporariamente que o controle ActiveX do Agent seja executado no Internet Explorer**
  
    Você pode ajudar a impedir as tentativas de instanciar esse controle ActiveX no Internet Explorer definindo o kill bit do controle no Registro.
  
    **Aviso** O uso incorreto do Editor do Registro pode causar problemas graves e exigir a reinstalação do sistema operacional. A Microsoft não garante a solução de problemas resultantes do uso incorreto do Editor do Registro. Você é responsável pelo uso do Editor do Registro.
  
    Para obter etapas detalhadas para evitar que um controle seja executado no Internet Explorer, consulte o [artigo 240797 (em inglês) da Base de Conhecimento Microsoft.](http://support.microsoft.com/kb/240797) Siga as etapas no artigo para criar um valor de Compatibility Flags no Registro e evitar que um objeto COM seja instanciado no Internet Explorer.
  
    Para definir o kill bit para um CLSID como {D45FD31B-5C6E-11D1-9EC1-00C04FD7081F}, cole o texto a seguir em um editor de texto como o Bloco de Notas. Em seguida, salve o arquivo usando a extensão de nome de arquivo .reg.
  
    Windows Registry Editor Versão 5.00  
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{D45FD31B-5C6E-11D1-9EC1-00C04FD7081F}\]
  
    "Compatibility Flags"=dword:00000400
  
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{F5BE8BD2-7DE6-11D0-91FE-00C04FD701A5}\]
  
    "Compatibility Flags"=dword:00000400
  
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{4BAC124B-78C8-11D1-B9A8-00C04FD97575}\]
  
    "Compatibility Flags"=dword:00000400
  
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{D45FD31D-5C6E-11D1-9EC1-00C04FD7081F}\]
  
    "Compatibility Flags"=dword:00000400
  
    \[HKEY\_LOCAL\_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{D45FD31E-5C6E-11D1-9EC1-00C04FD7081F}\]
  
    "Compatibility Flags"=dword:00000400
  
    Você pode aplicar este arquivo .reg em sistemas individuais clicando duas vezes nele. Você também pode aplicá-lo entre domínios usando a Diretiva de Grupo. Para obter mais informações sobre a Diretiva de Grupo, visite estes sites da Microsoft:
  
    -   [Conjunto de Diretivas de Grupo](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/6d7cb788-b31d-4d17-9f1e-b5ddaa6deecd.mspx)  
    -   [O que é o Editor de Objeto de Diretiva de Grupo?](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/47ba1311-6cca-414f-98c9-2d7f99fca8a3.mspx)  
    -   [Ferramentas e configurações principais da Diretiva de Grupo](http://www.microsoft.com/technet/prodtechnol/windowsserver2003/library/techref/e926577a-5619-4912-b5d9-e73d4bdc9491.mspx)
  
    **Observação** Você deve reiniciar o Internet Explorer para que as alterações tenham efeito.
  
    **Impacto da solução alternativa:** Os sites que usam o controle ActiveX do Microsoft Agent não funcionarão mais corretamente pelo Internet Explorer.
  
-   **Remover o registro de AgentSvr.exe**
  
    Digite o seguinte em uma linha de comando ou em um script de inicialização de logon/máquina:
  
    ```
    %windir%\msagent\agentsvr.exe /unregserver
    ```
  
    **Impacto da solução alternativa:** O Microsoft Agent não funcionará mais.
  
-   **Configure o Internet Explorer para notificá-lo antes da execução de controles ActiveX ou desative os controles ActiveX na zona de segurança da Internet e da intranet local.**
  
    Você pode se proteger contra essa vulnerabilidade, alterando as configurações do Internet Explorer para avisá-lo antes de executar os controles ActiveX. Para isso, siga estas etapas:
  
    1.  No Internet Explorer, clique em **Opções da Internet** no menu **Ferramentas**.  
    2.  Clique na guia **Segurança**.  
    3.  Clique em **Internet** e, em seguida, clique em **Nível Personalizado**.  
    4.  Em **Configurações**, na seção **Plug-ins e controles ActiveX**, em **Executar controles ActiveX e plug-ins**, clique em **Avisar** ou em **Desativar** e, em seguida, clique em **OK**.  
    5.  Clique em **Intranet local** e, em seguida, clique em **Nível Personalizado**.  
    6.  Em **Configurações**, na seção **Plug-ins e controles ActiveX**, em **Executar controles ActiveX e plug-ins**, clique em **Avisar** ou em **Desativar** e, em seguida, clique em **OK**.  
    7.  Clique em **OK** duas vezes para retornar ao Internet Explorer.
  
    **Impacto da solução alternativa:** A notificação antes da execução de controles ActiveX apresenta efeitos colaterais. Muitos sites que não estão na Internet ou na intranet usam o ActiveX para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou um banco online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução dos controles ActiveX é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Para cada notificação, se você sentir que confia no site que está visitando, clique em **Sim** para executar os controles ActiveX. Se não quiser ser avisado para todos esses sites, use os passos descritos em “Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer”.
  
    **Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer**
  
    Depois de definir o Internet Explorer para solicitar confirmação antes de executar controles ActiveX e scripts ativos na zona da Internet e da Intranet local, você pode adicionar sites confiáveis à zona de Sites confiáveis do Internet Explorer. Isso permitirá que você continue usando os sites confiáveis exatamente como faz atualmente, enquanto ajuda a proteger-se de ataques em sites não confiáveis. É recomendável adicionar somente sites nos quais você confia à zona de Sites confiáveis.
  
    Para isso, siga estas etapas:
  
    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique na guia **Segurança**.  
    2.  Na caixa **Selecione uma zona de conteúdo da Web para especificar suas configurações de segurança**, clique em **Sites Confiáveis** e, em seguida, clique em **Sites**.  
    3.  Se desejar adicionar sites que não requerem um canal criptografado, clique para desmarcar a caixa de seleção **Exigir verificação do servidor (https:) para todos os sites desta zona**.  
    4.  Na caixa **Adicionar este site à zona,** digite a URL de um site em que confia e, em seguida, clique em **Adicionar**.  
    5.  Repita essas etapas para cada site que você deseja adicionar à zona.  
    6.  Clique em **OK** duas vezes para aceitar as alterações e retornar ao Internet Explorer.
  
    **Observação** Adicione os sites que você tem certeza de que não realizarão ações mal-intencionadas em seu computador. Para continuar a receber atualizações de segurança da Microsoft, adicione **\*.windowsupdate.microsoft.com** e **\*.update.microsoft.com**. Estes são os sites que hospedam as atualizações, e você precisa ter um Controle ActiveX para instalá-las.
  
-   **Defina as configurações de zona de segurança da Internet e da intranet local como "Alto" para ser notificado antes da execução de controles ActiveX e scripts ativos nessas zonas**
  
    Você pode se proteger contra essa vulnerabilidade alterando suas configurações para que a zona de segurança da Internet solicite uma confirmação antes de executar os componentes ActiveX. É possível fazer isso configurando a segurança do navegador como **Alta**.
  
    Para aumentar o nível de segurança da navegação no Microsoft Internet Explorer, faça o seguinte:
  
    1.  No menu **Ferramentas** do Internet Explorer, clique em **Opções da Internet**.  
    2.  Na caixa de diálogo **Opções da Internet**, clique na guia **Segurança** e, em seguida, no ícone **Internet**.  
    3.  Em **Nível de segurança para esta zona**, mova o controle deslizante para **Alto**. Isso define o nível de segurança para todos os sites visitados como Alto.
  
    **Observação** Se o controle deslizante não estiver visível, clique em **Nível padrão** e então mova o controle deslizante para **Alto**.
  
    **Observação** A configuração do nível como **Alto** pode fazer com que alguns sites não funcionem corretamente. Se você encontrar dificuldades ao usar um site após alterar a configuração, mas tiver certeza de que o site é seguro, é possível adicionar esse site à lista de sites confiáveis. Isso permite que o site funcione corretamente, mesmo com a configuração de segurança definida como **Alta**.
  
    **Impacto da solução alternativa:** A notificação antes da execução de controles ActiveX apresenta efeitos colaterais. Muitos sites que não estão na Internet ou na intranet usam o ActiveX para fornecer funcionalidade adicional. Por exemplo, um site de comércio eletrônico ou um banco online pode usar controles ActiveX para fornecer menus, formulários de pedidos ou até mesmo extratos de contas. A notificação antes da execução dos controles ActiveX é uma configuração global que afeta todos os sites da Internet e da intranet. Você será notificado freqüentemente quando ativar essa solução alternativa. Para cada notificação, se você sentir que confia no site que está visitando, clique em **Sim** para executar os controles ActiveX. Se não quiser ser avisado para todos esses sites, use os passos descritos em “Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer”.
  
    **Adicione sites confiáveis à zona Sites confiáveis do Internet Explorer**
  
    Depois de definir o Internet Explorer para solicitar confirmação antes de executar controles ActiveX e scripts ativos na zona da Internet e da Intranet local, você pode adicionar sites confiáveis à zona de Sites confiáveis do Internet Explorer. Isso permitirá que você continue usando os sites confiáveis exatamente como faz atualmente, enquanto ajuda a proteger-se de ataques em sites não confiáveis. É recomendável adicionar somente sites nos quais você confia à zona de Sites confiáveis.
  
    Para isso, siga estas etapas:
  
    1.  No Internet Explorer, clique em **Ferramentas**, clique em **Opções da Internet** e, em seguida, clique na guia **Segurança**.  
    2.  Na caixa **Selecione uma zona de conteúdo da Web para especificar suas configurações de segurança**, clique em **Sites Confiáveis** e, em seguida, clique em **Sites**.  
    3.  Se desejar adicionar sites que não requerem um canal criptografado, clique para desmarcar a caixa de seleção **Exigir verificação do servidor (https:) para todos os sites desta zona**.  
    4.  Na caixa **Adicionar este site à zona,** digite a URL de um site em que confia e, em seguida, clique em **Adicionar**.  
    5.  Repita essas etapas para cada site que você deseja adicionar à zona.  
    6.  Clique em **OK** duas vezes para aceitar as alterações e retornar ao Internet Explorer.
  
    **Observação** Adicione os sites que você tem certeza de que não realizarão ações mal-intencionadas em seu computador. Para continuar a receber atualizações de segurança da Microsoft, adicione **\*.windowsupdate.microsoft.com** e **\*.update.microsoft.com**. Estes são os sites que hospedam as atualizações, e você precisa ter um Controle ActiveX para instalá-las.
  
#### Perguntas mais freqüentes sobre a vulnerabilidade de execução remota de código no Agent – CVE-2007-3040
  
**Qual é o escopo da vulnerabilidade?**  
Existe uma vulnerabilidade de execução remota de código no Microsoft Agent na forma como ele trata determinadas URLs especialmente criadas. O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total de um sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário.
  
**O que provoca a vulnerabilidade?**  
O fornecimento de uma URL especialmente criada ao controle ActiveX do Microsoft Agent pode corromper a memória do sistema de tal forma que um invasor pode executar um código arbitrário.
  
**O que é o Microsoft Agent?**  
O Microsoft Agent é um componente do sistema operacional Microsoft Windows que usa caracteres animados interativos para guiar os usuários a fazer uso e aprender a usar um computador com mais facilidade. Para obter mais informações, visite o [site do Microsoft Agent](http://www.microsoft.com/msagent/default.asp).
  
**Para que um invasor pode usar a vulnerabilidade?**  
O invasor que explorar com êxito essa vulnerabilidade poderá assumir o controle total do sistema afetado. O invasor poderá instalar programas; exibir, alterar ou excluir dados; ou criar novas contas com direitos totais de usuário. Os usuários cujas contas são configuradas com poucos direitos de usuário no sistema correm menos riscos do que aqueles que possuem direitos administrativos.
  
**Quem pode explorar a vulnerabilidade?**  
Em um cenário de ataque com base na Web, um invasor terá que hospedar um site que contenha uma página da Web usada para tentar explorar essa vulnerabilidade. Não há como um invasor forçar usuários a visitar o site especialmente criado. Em vez disso, o invasor terá que convencê-los a visitar o site, normalmente fazendo com que cliquem em um link que leve para esse site.
  
**Quais são os principais sistemas que correm riscos com a vulnerabilidade?**  
Esta vulnerabilidade requer que um usuário esteja conectado e visite um site para que uma ação mal-intencionada ocorra. Qualquer sistema em que o Internet Explorer é usado com freqüência, como estações de trabalho ou servidores de terminal, está mais exposto a essa vulnerabilidade.
  
**O que a atualização faz?**  
A atualização elimina a vulnerabilidade mudando o modo como o Microsoft Agent administra URLs especialmente criadas.
  
**Quando este boletim de segurança foi lançado, essa vulnerabilidade já tinha sido divulgada publicamente?**  
Não. A Microsoft recebeu informações sobre essa vulnerabilidade por meio de divulgação responsável.
  
**Quando este boletim de segurança foi lançado, a Microsoft tinha recebido algum relatório informando que essa vulnerabilidade estava sendo explorada?**  
Não. A Microsoft não recebeu nenhuma informação indicando que essa vulnerabilidade tenha sido usada publicamente para atacar clientes e não testemunhou nenhum exemplo de publicação de código de verificação de conceito, quando este boletim de segurança foi lançado pela primeira vez.
  
### Informações da atualização
  
Orientação e ferramentas de detecção e implantação  
--------------------------------------------------
  

Gerencie as atualizações de software e segurança que você precisa instalar em servidores, computadores desktop e notebooks em sua organização. Para obter mais informações, consulte o [Centro de Gerenciamento de Atualização do Technet](http://go.microsoft.com/fwlink/?linkid=69903). O site [Microsoft TechNet Security](http://www.microsoft.com/brasil/technet/seguranca) fornece informações adicionais sobre segurança em produtos da Microsoft.
  
As atualizações de segurança estão disponíveis no [Microsoft Update](http://go.microsoft.com/fwlink/?linkid=40747), [Windows Update](http://go.microsoft.com/fwlink/?linkid=21130) e [Office Update](http://go.microsoft.com/fwlink/?linkid=21135). As atualizações de segurança também estão disponíveis no [Centro de Download da Microsoft](http://go.microsoft.com/fwlink/?linkid=21129). você poderá encontrá-las com mais facilidade, executando uma pesquisa com a palavra-chave "patch\_de\_segurança". Por fim, as atualizações de segurança podem ser baixadas do Catálogo do Windows Update. Para obter mais informações sobre o Catálogo do Windows Update, consulte o [artigo 323166 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/323166).
  
**Orientação para detecção e implantação**
  
A Microsoft está oferecendo uma orientação de detecção e implantação para as atualizações de segurança deste mês. Esta orientação também ajudará aos profissionais de TI a entender como eles podem usar as várias ferramentas para ajudar a implantar a atualização de segurança, tal como o Windows Update, Microsoft Update, Atualização do Office, as ferramentas MBSA (Microsoft Baseline Security Analyzer), Office Detection Tool, Microsoft Systems Management Server (SMS), Extended Security Update Inventory Tool e a EST (Enterprise Update Scan Tool). Para obter mais informações, consulte o [artigo 910723 da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/910723).
  
**Microsoft Baseline Security Analyzer**
  
O MBSA (Microsoft Baseline Security Analyzer) permite aos administradores pesquisar, em sistemas locais e remotos, atualizações de segurança ausentes e problemas de configuração de segurança comuns. Para obter mais informações sobre o MBSA, visite o site do [Microsoft Baseline Security Analyzer](http://www.microsoft.com/brasil/technet/seguranca/mbsa/). A tabela a seguir fornece o resumo de detecção do MBSA para esta atualização de segurança.
  
| Software                              | MBSA 1.2.1 | MBSA 2.0.1 |  
|---------------------------------------|------------|------------|  
| Microsoft Windows 2000 Service Pack 4 | Sim        | Sim        |
  
Para obter mais informações sobre o MBSA, visite o [site do MBSA](http://www.microsoft.com/brasil/technet/seguranca/mbsa/). Para obter mais informações sobre os softwares não detectados no momento pelo Microsoft Update e o MBSA 2.0, consulte [o artigo 895660 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/895660).
  
**Windows Server Update Services**
  
Usando o WSUS (Windows Server Update Services), os administradores podem implantar de forma rápida e confiável as mais recentes atualizações críticas e de segurança dos sistemas operacionais Microsoft Windows 2000 e posteriores, Office XP e posteriores, Exchange Server 2003 e SQL Server 2000 nos sistemas operacionais Windows 2000 e posteriores. Para obter mais informações sobre como implantar esta atualização de segurança usando o recurso Windows Server Update Services, visite o [site do Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx).
  
**Systems Management Server**
  
A tabela a seguir fornece o resumo de detecção de SMS para esta atualização de segurança.
  
| Software                              | SMS 2.0 | SMS 2003 |  
|---------------------------------------|---------|----------|  
| Microsoft Windows 2000 Service Pack 4 | Sim     | Sim      |
  
SMS 2.0 e SMS 2003 Software Update Services (SUS) Feature Pack podem usar MBSA 1.2.1 para detecção e assim têm a mesma limitação listada anteriormente neste boletim relacionada a programas que o MBSA 1.2.1 não detecta.
  
Para o SMS 2.0, o SMS SUS Feature Pack, que inclui a ferramenta Inventário da Atualização de Segurança (SUIT), pode ser usado pelo SMS para detectar atualizações de segurança. O SMS SUIT usa o mecanismo do MBSA 1.2.1 para detecção. Para obter mais informações sobre SUIT, visite o seguinte [site da Microsoft](http://support.microsoft.com/kb/894154/). Para obter mais informações sobre as limitações da SUIT, consulte o [artigo 306460 da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/306460/). O SMS SUS Feature Pack também inclui a ferramenta Office Inventory da Microsoft para detectar atualizações necessárias para aplicativos do Microsoft Office.
  
Para o SMS 2003, a ferramenta Inventário do SMS 2003 para Microsoft Updates pode ser usada pelo SMS para detectar as atualizações de segurança oferecidas pelo [Microsoft Update](http://update.microsoft.com/microsoftupdate) e que tenham suporte do [Windows Server Update Services](http://www.microsoft.com/brasil/technet/seguranca/wsus/default.mspx). Para obter mais informações a ferramenta ITMU do SMS 2003, visite o seguinte [site da Microsoft](http://go.microsoft.com/fwlink/?linkid=72181). O SMS 2003 também pode usar a ferramenta Office Inventory da Microsoft para detectar as atualizações necessárias dos aplicativos do Microsoft Office.
  
Para obter mais informações sobre o SMS, visite o [site do SMS](http://www.microsoft.com/brasil/sms).
  
Implantação de atualização de segurança  
---------------------------------------
  

**Softwares afetados**
  
Para obter informações sobre uma atualização de segurança específica para seu software afetado, clique no link apropriado:
  
#### Microsoft Windows 2000 (todas as edições)
  
**Tabela de referência**
  
A tabela a seguir contém as informações de atualização de segurança desse software. Você pode encontrar informações adicionais na subseção **Informações de implantação**, nesta seção.

 
<p></p>
<table style="border:1px solid black;">
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td style="border:1px solid black;"><strong>Inclusão em Service Packs futuros</strong></td>
<td style="border:1px solid black;">A atualização para esse problema poderá ser incluída em um pacote cumulativo de atualizações futuro.</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Implantação</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Instalar sem intervenção do usuário</td>
<td style="border:1px solid black;">Microsoft Windows 2000 Service Pack 4:
Windows2000-kb938827-x86-enu /quiet</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Instalar sem reinicializar</td>
<td style="border:1px solid black;">Microsoft Windows 2000 Service Pack 4:
Windows2000-kb938827-Windows2000sp4-x86-enu /norestart</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Arquivo de log de atualização</td>
<td style="border:1px solid black;">Microsoft Windows 2000 Service Pack 4:
KB938827.log</td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Mais informações</td>
<td style="border:1px solid black;">Consulte a subseção <strong>Orientação e ferramentas de detecção e implantação</strong></td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Necessidade de Reinicialização</strong></td>
<td style="border:1px solid black;"></td>
</tr>
<tr class="even">
<td style="border:1px solid black;">Reinicialização necessária</td>
<td style="border:1px solid black;">Sim, é necessário reinicializar o sistema depois de aplicar essa atualização de segurança.</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;">Hotpatching</td>
<td style="border:1px solid black;">Não Aplicável</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Informações sobre remoção</strong></td>
<td style="border:1px solid black;">Use a ferramenta Adicionar ou Remover Programas no Painel de Controle ou o utilitário Spuninst.exe localizado na pasta %Windir%\$NTUninstallKB938827$\Spuninst</td>
</tr>
<tr class="odd">
<td style="border:1px solid black;"><strong>Informações sobre o arquivo</strong></td>
<td style="border:1px solid black;">Consulte a subseção <strong>Informações sobre o arquivo</strong>, a seguir, para obter o manifesto de arquivo completo</td>
</tr>
<tr class="even">
<td style="border:1px solid black;"><strong>Verificação da Chave do Registro</strong></td>
<td style="border:1px solid black;">Para Microsoft Windows 2000 Service Pack 4:
HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Updates\Windows 2000\SP5\KB938827\Filelist</td>
</tr>
</tbody>
</table>
 

#### Informações sobre o arquivo

A versão em inglês desta atualização de segurança tem os atributos de arquivo relacionados na tabela abaixo. As datas e as horas destes arquivos estão de acordo com a hora universal coordenada (UTC). Quando você exibe as informações do arquivo, ele é convertido para a hora local. Para saber a diferença entre o UTC e o horário local, use a guia **Fuso Horário** na ferramenta Data e Hora, no Painel de Controle.

Para todas as edições com suporte do Microsoft Windows 2000:

| Nome do arquivo | Versão        | Data                | Hora  | Tamanho   |
|-----------------|---------------|---------------------|-------|-----------|
| agentdpv.dll    | 2.0.0.3426    | 24 de junho de 2007 | 17:55 | 53.008    |
| sp3res.dll      | 5.0.2195.7136 | 27 de maio de 2007  | 19:26 | 6.258.688 |

**Observação** Para obter uma lista completa de versões e edições com suporte, consulte o Índice de Ciclo de Vida de Suporte. Para obter uma lista completa de service packs, consulte [Ciclo de vida de service packs com suporte](http://support.microsoft.com/gp/lifesupsps). Para obter mais informações sobre a diretiva de ciclo de vida de suporte, consulte [Ciclo de Vida do Suporte Microsoft.](http://support.microsoft.com/lifecycle/)

#### Informações de implantação

**Instalando a atualização**

Quando você instala esta atualização de segurança, o instalador verifica se alguns dos arquivos que estão sendo atualizados no sistema foram anteriormente atualizados por um hotfix da Microsoft.

Se você já tiver instalado um hotfix para atualizar um desses arquivos, o instalador copiará os arquivos RTMQFE, SP1QFE ou SP2QFE para o sistema. Do contrário, o instalador copiará os arquivos RTMGDR, SP1GDR ou SP2GDR para o sistema. As atualizações de segurança podem não conter todas as variações desses arquivos. Para obter mais informações sobre esse comportamento, consulte o [artigo 824994 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/824994).

Para obter mais informações sobre o instalador, visite o [site Microsoft TechNet](http://www.microsoft.com/brasil/technet).

Para obter mais informações sobre a terminologia que aparece neste boletim, como *hotfix*, consulte o [artigo 824684 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/824684).

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções de instalação da atualização de segurança para as quais há suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/overwriteoem**
</td>
<td style="border:1px solid black;">
Sobrescreve arquivos OEM sem notificação
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/nobackup**
</td>
<td style="border:1px solid black;">
Não faz backup de arquivos necessários à desinstalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/extract\[:caminho\]**
</td>
<td style="border:1px solid black;">
Extrai os arquivos sem iniciar o programa de instalação
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/ER**
</td>
<td style="border:1px solid black;">
Habilita o relatório de erros estendido
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/verbose**
</td>
<td style="border:1px solid black;">
Habilita o registro extenso. Durante a instalação, cria %Windir%\\CabBuild.log. Esse log detalha os arquivos copiados. Se você usar esta opção, a instalação será bem mais lenta.
</td>
</tr>
</table>
 
**Observação** É possível combinar essas opções em uma única linha de comando. Para obter compatibilidade com versões anteriores, a atualização de segurança também oferece suporte às opções de instalação utilizadas por versões anteriores do programa de instalação. Para obter mais informações sobre as opções de instalação suportadas, consulte o [Artigo 262841 (em inglês) da Base de Conhecimento Microsoft](http://support.microsoft.com/kb/262841).

**Removendo a atualização**

Esta atualização de segurança oferece suporte às seguintes opções de instalação:

<p></p>
<table class="dataTable">
<caption>
Opções do Spuninst.exe para as quais existe suporte
</caption>
<tr class="thead">
<th style="border:1px solid black;" >
Opção
</th>
<th style="border:1px solid black;" >
Descrição
</th>
</tr>
<tr>
<td style="border:1px solid black;">
**/help**
</td>
<td style="border:1px solid black;">
Exibe as opções de linha de comando
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Modos de instalação
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/passive**
</td>
<td style="border:1px solid black;">
Modo de instalação autônomo. Não é necessária a interação do usuário, mas o status da instalação é exibido. Se a reinicialização for necessária no fim da instalação, uma caixa de diálogo será apresentada para o usuário com um timer avisando que o computador será reiniciado em 30 segundos.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/quiet**
</td>
<td style="border:1px solid black;">
Modo silencioso. O mesmo que modo autônomo, mas nenhuma mensagem de status ou de erro é exibida.
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Opções de reinicialização
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/norestart**
</td>
<td style="border:1px solid black;">
Não reinicia quando a instalação é concluída
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/forcerestart**
</td>
<td style="border:1px solid black;">
Reinicia o computador após a instalação e força o fechamento de outros aplicativos no desligamento sem antes salvar os arquivos abertos.
</td>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/warnrestart\[:x\]**
</td>
<td style="border:1px solid black;">
Apresenta uma caixa de diálogo com um timer avisando ao usuário que o computador será reiniciado em *x* segundos. (A configuração padrão é 30 segundos.) Destina-se ao uso com as opções **/quiet** ou **/passive**.
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/promptrestart**
</td>
<td style="border:1px solid black;">
Exibe uma caixa de diálogo solicitando que o usuário local permita a reinicialização
</td>
</tr>
<tr>
<th colspan="2" style="border:1px solid black;">
Opções especiais
</th>
</tr>
<tr class="alternateRow">
<td style="border:1px solid black;">
**/forceappsclose**
</td>
<td style="border:1px solid black;">
Força o encerramento de outros programas quando o computador é desligado
</td>
</tr>
<tr>
<td style="border:1px solid black;">
**/log:caminho**
</td>
<td style="border:1px solid black;">
Permite o redirecionamento dos arquivos de log da instalação
</td>
</tr>
</table>
 
**Verificando a aplicação da atualização**

-   **Microsoft Baseline Security Analyzer**

    Para verificar se uma atualização de segurança foi aplicada em um sistema afetado, é possível utilizar a ferramenta MBSA (Microsoft Baseline Security Analyzer). Consulte a seção Orientação e ferramentas de detecção e implantação neste boletim para obter mais informações.

-   **Verificação de Versão do Arquivo**

    Como existem várias versões do Microsoft Windows, as etapas a seguir podem ser diferentes no seu sistema. Se isso acontecer, consulte a documentação do produto para completar estas etapas.

    1.  Clique em **Iniciar** e, em seguida, clique em **Pesquisar**.
    2.  No painel **Resultados da Pesquisa**, clique em **Todos os arquivos e pastas**, em **Search Companion**.
    3.  Na caixa **Todo ou parte do nome do arquivo**, digite um nome de arquivo da tabela de informações de arquivo correta e clique em **Pesquisar**.
    4.  Na lista de arquivos, clique com o botão direito do mouse em um nome de arquivo da tabela de informações de arquivo correta e clique em **Propriedades**.  
        **Observação** Dependendo da edição do sistema operacional, ou dos programas que são instalados em seu sistema, alguns arquivos que estão listados na tabela de informações de arquivo podem não estar instalados.
    5.  Na guia **Versão**, determine a versão do arquivo instalado no sistema, comparando-o com a versão documentada na tabela de informações de arquivos correta.  
        **Observação** Atributos que não sejam a versão do arquivo podem ser alterados durante a instalação. A comparação de outros atributos de arquivo com as informações na tabela não é um método suportado para verificar se a atualização foi aplicada. Além disso, em alguns casos, arquivos podem ser renomeados durante a instalação. Se as informações sobre o arquivo ou a versão não estiverem presentes, use um dos outros métodos disponíveis para verificar a instalação da atualização.

-   **Verificação da Chave do Registro**

    Você também pode ser capaz de verificar os arquivos que esta atualização de segurança instalou examinando as chaves do Registro na **Tabela de referência** nesta seção.

    Essas chaves do Registro podem não conter uma lista completa dos arquivos instalados. Além disso, talvez essas chaves do Registro não sejam criadas corretamente se um administrador ou um OEM integrar ou adicionar a atualização de segurança aos arquivos fonte da instalação do Windows.

### Outras informações

#### Agradecimentos

A Microsoft [agradece](http://go.microsoft.com/fwlink/?linkid=21127) à pessoa citada abaixo por trabalhar conosco para ajudar a proteger os clientes:

-   A equipe de Pesquisa de Vulnerabilidade da [Assurent Secure Technologies](http://www.assurent.com/), por relatar a vulnerabilidade de execução remota de código no Agent – [CVE-2007-3040](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-3040)
-   Yamata Li, da [Palo Alto Networks](http://www.paloaltonetworks.com/), por relatar a vulnerabilidade de execução remota de código no Agent – [CVE-2007-3040](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-3040)
-   Um pesquisador anônimo trabalhando com a VeriSign [iDefense VCP](http://labs.idefense.com/), por relatar a vulnerabilidade de execução remota de código no Agent – [CVE-2007-3040](http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2007-3040)

#### Suporte

-   Os clientes nos EUA e Canadá podem receber suporte técnico dos [Serviços de suporte ao produto Microsoft](http://go.microsoft.com/fwlink/?linkid=21131) pelo telefone 1-866-PCSAFETY. As ligações para obter suporte associado a atualizações de segurança são gratuitas.
-   Os clientes de outros países podem obter suporte nas subsidiárias locais da Microsoft. O suporte associado a atualizações de segurança é gratuito. Para obter mais informações sobre como entrar em contato com a Microsoft a fim de obter suporte a problemas, visite o [site de Suporte Internacional](http://go.microsoft.com/fwlink/?linkid=21155).

#### Aviso de isenção de responsabilidade

As informações fornecidas na Base de Conhecimento Microsoft são apresentadas "no estado em que se encontram", sem garantia de qualquer tipo. A Microsoft se isenta de todas as garantias, expressas ou implícitas, inclusive as garantias de comercialização e adequação a um propósito específico. Em hipótese alguma a Microsoft Corporation ou seus fornecedores serão responsáveis por quaisquer danos, inclusive danos diretos, indiretos, incidentais, conseqüenciais, danos por lucros cessantes ou danos especiais, mesmo que a Microsoft Corporation ou seus fornecedores tenham sido alertados da possibilidade dos referidos danos. Como alguns estados não permitem a exclusão ou limitação de responsabilidade por danos conseqüenciais ou indiretos, a limitação acima pode não ser aplicável a você.

#### Revisões

-   V1.0 (14 de agosto de 2007): Boletim publicado.

*Built at 2014-04-18T01:50:00Z-07:00*
